(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[5093],{411985:e=>{e.exports={pills:"pills-PVWoXu5j",primary:"primary-PVWoXu5j",gray:"gray-PVWoXu5j",selected:"selected-PVWoXu5j",grouped:"grouped-PVWoXu5j",active:"active-PVWoXu5j",disableActiveOnTouch:"disableActiveOnTouch-PVWoXu5j",disableActiveStateStyles:"disableActiveStateStyles-PVWoXu5j",withGrouped:"withGrouped-PVWoXu5j","quiet-primary":"quiet-primary-PVWoXu5j",green:"green-PVWoXu5j",red:"red-PVWoXu5j",blue:"blue-PVWoXu5j",secondary:"secondary-PVWoXu5j",ghost:"ghost-PVWoXu5j"}},778457:e=>{e.exports={lightButton:"lightButton-bYDQcOkp",link:"link-bYDQcOkp",ltr:"ltr-bYDQcOkp",rtl:"rtl-bYDQcOkp","typography-regular16px":"typography-regular16px-bYDQcOkp","typography-medium16px":"typography-medium16px-bYDQcOkp","typography-regular14px":"typography-regular14px-bYDQcOkp","typography-semibold14px":"typography-semibold14px-bYDQcOkp","typography-semibold16px":"typography-semibold16px-bYDQcOkp",content:"content-bYDQcOkp",visuallyHidden:"visuallyHidden-bYDQcOkp",nowrap:"nowrap-bYDQcOkp",ellipsisContainer:"ellipsisContainer-bYDQcOkp",textWrapContainer:"textWrapContainer-bYDQcOkp",textWrapWithEllipsis:"textWrapWithEllipsis-bYDQcOkp",slot:"slot-bYDQcOkp",caret:"caret-bYDQcOkp",activeCaret:"activeCaret-bYDQcOkp",xsmall:"xsmall-bYDQcOkp",withStartSlot:"withStartSlot-bYDQcOkp",withEndSlot:"withEndSlot-bYDQcOkp",noContent:"noContent-bYDQcOkp",wrap:"wrap-bYDQcOkp",small:"small-bYDQcOkp",medium:"medium-bYDQcOkp"}},370168:e=>{e.exports={button:"button-D4RPB3ZC",iconOnly:"iconOnly-D4RPB3ZC",withStartSlot:"withStartSlot-D4RPB3ZC",withEndSlot:"withEndSlot-D4RPB3ZC",startSlotWrap:"startSlotWrap-D4RPB3ZC",endSlotWrap:"endSlotWrap-D4RPB3ZC",xsmall:"xsmall-D4RPB3ZC",small:"small-D4RPB3ZC",medium:"medium-D4RPB3ZC",large:"large-D4RPB3ZC",xlarge:"xlarge-D4RPB3ZC",content:"content-D4RPB3ZC",link:"link-D4RPB3ZC",blue:"blue-D4RPB3ZC",primary:"primary-D4RPB3ZC",secondary:"secondary-D4RPB3ZC",gray:"gray-D4RPB3ZC",green:"green-D4RPB3ZC",red:"red-D4RPB3ZC",black:"black-D4RPB3ZC",slot:"slot-D4RPB3ZC",stretch:"stretch-D4RPB3ZC",grouped:"grouped-D4RPB3ZC",adjustPosition:"adjustPosition-D4RPB3ZC",firstRow:"firstRow-D4RPB3ZC",firstCol:"firstCol-D4RPB3ZC","no-corner-top-left":"no-corner-top-left-D4RPB3ZC","no-corner-top-right":"no-corner-top-right-D4RPB3ZC","no-corner-bottom-right":"no-corner-bottom-right-D4RPB3ZC","no-corner-bottom-left":"no-corner-bottom-left-D4RPB3ZC",textWrap:"textWrap-D4RPB3ZC",multilineContent:"multilineContent-D4RPB3ZC",primaryText:"primaryText-D4RPB3ZC",secondaryText:"secondaryText-D4RPB3ZC"}},737643:e=>{e.exports={pair:"pair-ocURKVwI",xxceptionallysmalldonotusebrv1023:"xxceptionallysmalldonotusebrv1023-ocURKVwI",xxxxsmall:"xxxxsmall-ocURKVwI",xxxsmall:"xxxsmall-ocURKVwI",xxsmall:"xxsmall-ocURKVwI",xsmall:"xsmall-ocURKVwI",small:"small-ocURKVwI",medium:"medium-ocURKVwI",large:"large-ocURKVwI",xlarge:"xlarge-ocURKVwI",xxlarge:"xxlarge-ocURKVwI",xxxlarge:"xxxlarge-ocURKVwI",logo:"logo-ocURKVwI",skeleton:"skeleton-ocURKVwI",empty:"empty-ocURKVwI"}},757554:e=>{
e.exports={logo:"logo-PsAlMQQF",hidden:"hidden-PsAlMQQF",xxceptionallysmalldonotusebrv1023:"xxceptionallysmalldonotusebrv1023-PsAlMQQF",xxxsmall:"xxxsmall-PsAlMQQF",xxsmall:"xxsmall-PsAlMQQF",xsmall:"xsmall-PsAlMQQF",small:"small-PsAlMQQF",medium:"medium-PsAlMQQF",large:"large-PsAlMQQF",xlarge:"xlarge-PsAlMQQF",xxlarge:"xxlarge-PsAlMQQF",xxxlarge:"xxxlarge-PsAlMQQF",skeleton:"skeleton-PsAlMQQF",letter:"letter-PsAlMQQF"}},649107:e=>{e.exports={loader:"loader-UL6iwcBa",static:"static-UL6iwcBa",item:"item-UL6iwcBa","tv-button-loader":"tv-button-loader-UL6iwcBa",medium:"medium-UL6iwcBa",small:"small-UL6iwcBa",black:"black-UL6iwcBa",white:"white-UL6iwcBa",gray:"gray-UL6iwcBa",primary:"primary-UL6iwcBa"}},116313:e=>{e.exports={wrapper:"wrapper-TJ9ObuLF",animated:"animated-TJ9ObuLF",pulsation:"pulsation-TJ9ObuLF"}},959189:(e,t,i)=>{"use strict";function s(e,t){return t||null==e||("string"==typeof e||Array.isArray(e))&&0===e.length}i.d(t,{isIconOnly:()=>s})},418920:(e,t,i)=>{"use strict";i.d(t,{useLightButtonClasses:()=>u});var s=i(50959),l=i(497754),a=i.n(l),o=i(234539),n=i(959189),r=i(380327);const d=s.createContext({isInButtonGroup:!1,isGroupPrimary:!1}),u=(e,t,i)=>{const l=(0,s.useContext)(o.CustomBehaviourContext),{className:u,isSelected:h,children:c,showCaret:p,forceDirection:_,iconOnly:m,color:g="gray",variant:b="primary",size:v="medium",enableActiveStateStyles:w=l.enableActiveStateStyles,typography:S,isLink:y=!1,textWrap:f,isPills:M,isActive:C,startSlot:E,endSlot:V}=t,x=e[`typography-${((e,t,i)=>{if(i){const e=i.replace(/^\D+/g,"");return t?`semibold${e}`:i}switch(e){case"xsmall":return t?"semibold14px":"regular14px";case"small":case"medium":return t?"semibold16px":"regular16px";default:return""}})(v,h||M,S||void 0)}`],W=(0,s.useContext)(r.ControlGroupContext),{isInButtonGroup:L,isGroupPrimary:k}=(0,s.useContext)(d);return a()(u,e.lightButton,y&&e.link,C&&e.active,h&&e.selected,(0,n.isIconOnly)(c,m)&&e.noContent,!!E&&e.withStartSlot,(p||!!V)&&e.withEndSlot,i&&e.withGrouped,_&&e[_],e[k?"primary":b],e[k?"gray":g],e[v],x,!w&&e.disableActiveStateStyles,W.isGrouped&&e.grouped,f&&e.wrap,L&&e.disableActiveOnTouch,M&&e.pills)}},854797:(e,t,i)=>{"use strict";i.d(t,{LightButtonContent:()=>_});var s=i(50959),l=i(497754),a=i.n(l),o=i(601198),n=i(959189),r=i(878112),d=i(602948),u=i.n(d),h=i(778457),c=i.n(h);const p=e=>s.createElement(r.Icon,{className:a()(c().caret,e&&c().activeCaret),icon:u()});function _(e){const{showCaret:t,iconOnly:i,ellipsis:l=!0,textWrap:r,tooltipText:d,children:u,endSlot:h,startSlot:_,isActiveCaret:m}=e;[h,t].filter((e=>!!e));return s.createElement(s.Fragment,null,_&&s.createElement("span",{className:a()(c().slot,c().startSlot)},_),!(0,n.isIconOnly)(u,i)&&s.createElement("span",{className:a()(c().content,!r&&c().nowrap,"apply-overflow-tooltip","apply-overflow-tooltip--check-children-recursively","apply-overflow-tooltip--allow-text"),"data-overflow-tooltip-text":d??(0,o.getTextForTooltip)(u)},r||l?s.createElement(s.Fragment,null,s.createElement("span",{
className:a()(!r&&l&&c().ellipsisContainer,r&&c().textWrapContainer,r&&l&&c().textWrapWithEllipsis)},u),s.createElement("span",{className:c().visuallyHidden,"aria-hidden":!0},u)):s.createElement(s.Fragment,null,u,s.createElement("span",{className:c().visuallyHidden,"aria-hidden":!0},u))),h&&s.createElement("span",{className:a()(c().slot,c().endSlot)},h),t&&p(m))}},943158:(e,t,i)=>{"use strict";i.d(t,{LightButton:()=>h});var s=i(50959),l=i(380327),a=i(418920),o=i(854797),n=i(778457),r=i.n(n),d=i(411985),u=i.n(d);function h(e){const{isGrouped:t}=s.useContext(l.ControlGroupContext),{reference:i,className:n,isSelected:d,children:h,iconOnly:c,ellipsis:p,showCaret:_,forceDirection:m,endSlot:g,startSlot:b,color:v,variant:w,size:S,enableActiveStateStyles:y,typography:f,textWrap:M=!1,maxLines:C,style:E={},isPills:V,isActive:x,tooltipText:W,role:L,...k}=e,A=M?C??2:1,T=A>0?{...E,"--ui-lib-light-button-content-max-lines":A}:E;return s.createElement("button",{...k,className:(0,a.useLightButtonClasses)({...u(),...r()},{className:n,isSelected:d,children:h,iconOnly:c,showCaret:_,forceDirection:m,endSlot:g,startSlot:b,color:v,variant:w,size:S,enableActiveStateStyles:y,typography:f,textWrap:M,isPills:V,isActive:x},t),ref:i,style:T,role:L},s.createElement(o.LightButtonContent,{showCaret:_,isActiveCaret:_&&(V||x||d),iconOnly:c,ellipsis:p,textWrap:M,tooltipText:W,endSlot:g,startSlot:b},h))}},228837:(e,t,i)=>{"use strict";i.d(t,{SquareButton:()=>b});var s=i(50959),l=i(497754),a=i.n(l),o=i(331774),n=i(370168),r=i.n(n);const d="apply-overflow-tooltip apply-overflow-tooltip--check-children-recursively apply-overflow-tooltip--allow-text apply-common-tooltip";function u(e){const{size:t="medium",variant:i="primary",color:s="brand",stretch:l=!1,startSlot:n,endSlot:u,iconOnly:h=!1,className:c,isGrouped:p,cellState:_,disablePositionAdjustment:m=!1,primaryText:g,secondaryText:b,isAnchor:v=!1}=e,w="brand"===s?"black":s,S=function(e){let t="";return 0!==e&&(1&e&&(t=a()(t,r()["no-corner-top-left"])),2&e&&(t=a()(t,r()["no-corner-top-right"])),4&e&&(t=a()(t,r()["no-corner-bottom-right"])),8&e&&(t=a()(t,r()["no-corner-bottom-left"]))),t}((0,o.getGroupCellRemoveRoundBorders)(_)),y=h&&(n||u);return a()(c,r().button,r()[t],r()[w],r()[i],l&&r().stretch,n&&r().withStartIcon,u&&r().withEndIcon,y&&r().iconOnly,S,p&&r().grouped,p&&!m&&r().adjustPosition,p&&_.isTop&&r().firstRow,p&&_.isLeft&&r().firstCol,g&&b&&r().multilineContent,v&&r().link,d)}function h(e){const{startSlot:t,iconOnly:i,children:l,endSlot:o,primaryText:n,secondaryText:u}=e;if(t&&o&&i)return s.createElement("span",{className:a()(r().slot,r().startSlotWrap)},t);const h=i&&(t??o),c=!t&&!o&&!i&&!l&&n&&u;return s.createElement(s.Fragment,null,t&&s.createElement("span",{className:a()(r().slot,r().startSlotWrap)},t),l&&!h&&s.createElement("span",{className:r().content},l),o&&s.createElement("span",{className:a()(r().slot,r().endSlotWrap)},o),c&&!h&&function(e){return e.primaryText&&e.secondaryText&&s.createElement("div",{className:a()(r().textWrap,d)},s.createElement("span",{className:r().primaryText
}," ",e.primaryText," "),"string"==typeof e.secondaryText?s.createElement("span",{className:r().secondaryText}," ",e.secondaryText," "):s.createElement("span",{className:r().secondaryText},s.createElement("span",null,e.secondaryText.firstLine),s.createElement("span",null,e.secondaryText.secondLine)))}(e))}var c=i(601198),p=i(380327),_=i(800417);function m(e,t){return i=>{if(t)return i.preventDefault(),void i.stopPropagation();e?.(i)}}function g(e){const{className:t,color:i,variant:s,size:l,stretch:a,iconOnly:o,startSlot:n,endSlot:r,primaryText:d,secondaryText:u,...h}=e;return{...h,...(0,_.filterDataProps)(e),...(0,_.filterAriaProps)(e)}}function b(e){const{reference:t,tooltipText:i,disabled:l,onClick:a,onMouseOver:o,onMouseOut:n,onMouseDown:r,onMouseEnter:d,"aria-disabled":_,...b}=e,{isGrouped:v,cellState:w,disablePositionAdjustment:S}=(0,s.useContext)(p.ControlGroupContext),y=u({...b,isGrouped:v,cellState:w,disablePositionAdjustment:S}),f=i??(e.primaryText?[e.primaryText,e.secondaryText].join(" "):(0,c.getTextForTooltip)(e.children));return s.createElement("button",{...g(b),"aria-disabled":l||_,tabIndex:e.tabIndex??(l?-1:0),className:y,ref:t,onClick:m(a,l),onMouseDown:m(r,l),onMouseOver:m(o,l),onMouseOut:m(n,l),onMouseEnter:m(d,l),"data-overflow-tooltip-text":f},s.createElement(h,{...b}))}i(15378)},108937:(e,t,i)=>{"use strict";i.d(t,{getBlockStyleClasses:()=>r,getLogoStyleClasses:()=>d});var s=i(497754),l=i.n(s),a=i(92318),o=i(737643),n=i.n(o);function r(e,t){return l()(n().pair,n()[e],t)}function d(e,t=2,i=!0){return l()(n().logo,n()[e],n().skeleton,a.skeletonTheme.wrapper,!i&&n().empty,1===t&&l()(a.skeletonTheme.animated))}},185934:(e,t,i)=>{"use strict";i.d(t,{getStyleClasses:()=>r,isCircleLogoWithUrlProps:()=>d});var s=i(497754),l=i.n(s),a=i(92318),o=i(757554),n=i.n(o);function r(e,t=2,i){return l()(n().logo,n()[e],i,0===t||1===t?l()(a.skeletonTheme.wrapper,n().skeleton):n().letter,1===t&&a.skeletonTheme.animated)}function d(e){return"logoUrl"in e&&null!==e.logoUrl&&void 0!==e.logoUrl&&0!==e.logoUrl.length}},380327:(e,t,i)=>{"use strict";i.d(t,{ControlGroupContext:()=>s});const s=i(50959).createContext({isGrouped:!1,cellState:{isTop:!0,isRight:!0,isBottom:!0,isLeft:!0}})},331774:(e,t,i)=>{"use strict";function s(e){let t=0;return e.isTop&&e.isLeft||(t+=1),e.isTop&&e.isRight||(t+=2),e.isBottom&&e.isLeft||(t+=8),e.isBottom&&e.isRight||(t+=4),t}i.d(t,{getGroupCellRemoveRoundBorders:()=>s})},718736:(e,t,i)=>{"use strict";i.d(t,{useFunctionalRefObject:()=>a});var s=i(50959),l=i(855393);function a(e){const t=(0,s.useMemo)((()=>function(e){const t=i=>{e(i),t.current=i};return t.current=null,t}((e=>{n.current(e)}))),[]),i=(0,s.useRef)(null),a=t=>{if(null===t)return o(i.current,t),void(i.current=null);i.current!==e&&(i.current=e,o(i.current,t))},n=(0,s.useRef)(a);return n.current=a,(0,l.useIsomorphicLayoutEffect)((()=>{if(null!==t.current)return n.current(t.current),()=>n.current(null)}),[e]),t}function o(e,t){null!==e&&("function"==typeof e?e(t):e.current=t)}},671129:(e,t,i)=>{"use strict";i.d(t,{useMatchMedia:()=>a,
useSafeMatchMedia:()=>l});var s=i(50959);function l(e,t=!1){const[i,l]=(0,s.useState)(t);return(0,s.useEffect)((()=>{const t=window.matchMedia(e);function i(){l(t.matches)}return i(),t.addEventListener("change",i),()=>{t.removeEventListener("change",i)}}),[e]),i}function a(e){const t=(0,s.useMemo)((()=>window.matchMedia(e).matches),[]);return l(e,t)}},525388:(e,t,i)=>{"use strict";i.d(t,{useMergedRefs:()=>a});var s=i(50959),l=i(273388);function a(e){return(0,s.useCallback)((0,l.mergeRefs)(e),e)}},664332:(e,t,i)=>{"use strict";i.d(t,{useResizeObserver:()=>o});var s=i(50959),l=i(855393),a=i(718736);function o(e,t=[]){const{callback:i,ref:o=null}=function(e){return"function"==typeof e?{callback:e}:e}(e),n=(0,s.useRef)(null),r=(0,s.useRef)(i);r.current=i;const d=(0,a.useFunctionalRefObject)(o),u=(0,s.useCallback)((e=>{d(e),null!==n.current&&(n.current.disconnect(),null!==e&&n.current.observe(e))}),[d,n]);return(0,l.useIsomorphicLayoutEffect)((()=>(n.current=new ResizeObserver(((e,t)=>{r.current(e,t)})),d.current&&u(d.current),()=>{n.current?.disconnect()})),[d,...t]),u}},234404:(e,t,i)=>{"use strict";i.d(t,{Loader:()=>d});var s,l=i(50959),a=i(497754),o=i.n(a),n=i(649107),r=i.n(n);function d(e){const{className:t,size:i="medium",staticPosition:s,color:a="black"}=e,n=o()(r().item,r()[a],r()[i]);return l.createElement("span",{className:o()(r().loader,s&&r().static,t)},l.createElement("span",{className:n}),l.createElement("span",{className:n}),l.createElement("span",{className:n}))}!function(e){e.Medium="medium",e.Small="small"}(s||(s={}))},92318:(e,t,i)=>{"use strict";i.d(t,{skeletonTheme:()=>l});var s=i(116313);const l=i.n(s)()},601198:(e,t,i)=>{"use strict";i.d(t,{getTextForTooltip:()=>o});var s=i(50959);const l=e=>(0,s.isValidElement)(e)&&Boolean(e.props.children),a=(e,t=!0)=>null==e||"boolean"==typeof e||"{}"===JSON.stringify(e)?"":e.toString()+(t?" ":""),o=e=>Array.isArray(e)||(0,s.isValidElement)(e)?s.Children.toArray(e).reduce(((e,t)=>{let i="";return i=(0,s.isValidElement)(t)&&l(t)?o(t.props.children):(0,s.isValidElement)(t)&&!l(t)?"":a(t),e.concat(i)}),"").trim():a(e,!1)},650733:(e,t,i)=>{"use strict";i.d(t,{batsToRealtimeCrucialHtml:()=>f,batsToRealtimeHtml1:()=>w,batsToRealtimeHtml2WithExchange:()=>y,batsToRealtimeHtml2WithoutExchange:()=>S,delayHtml:()=>u,delayNoRealtimeHtml:()=>p,delayToRealtimeHtml:()=>c,delayTooltip:()=>a,delayWithoutMarketAgreement:()=>v,eodHtml:()=>_,eodTooltip:()=>o,exchangeByOriginalExchangeTooltip:()=>d,notAccurate1PerSecondTooltip:()=>n,notAccurateCboeTooltip:()=>r,overnightQuotesText:()=>C,overnightQuotesTitle:()=>M,rtFreeForRegisteredUsersHtml:()=>h,tickByTickHtml1:()=>g,tickByTickHtml1FullInfo:()=>m,tickByTickHtml2:()=>b});var s=i(609838),l=i(871645);const a=s.t(null,void 0,i(543348)),o=s.t(null,void 0,i(705805)),n=s.t(null,void 0,i(991006)),r=s.t(null,void 0,i(58796)),d=s.t(null,void 0,i(655154)),u=(s.t(null,void 0,i(944138)),s.t(null,void 0,i(994972)),s.t(null,void 0,i(295246)),s.t(null,void 0,i(50035)),s.t(null,void 0,i(619481)),s.t(null,void 0,i(675119)),
s.t(null,void 0,i(667607)),s.t(null,void 0,i(484484)),(e,t)=>(0,l.htmlEscape)(s.t(null,{plural:"{symbolName} data is delayed by {time} minutes because of exchange requirements.",count:t,replace:{symbolName:e,time:t.toString()}},i(881227)))),h=(0,l.htmlEscape)(s.t(null,void 0,i(651211))),c=(0,l.htmlEscape)(s.t(null,void 0,i(807281))),p=(0,l.htmlEscape)(s.t(null,void 0,i(920987))),_=(0,l.htmlEscape)(s.t(null,void 0,i(932925))),m=(0,l.htmlEscape)(s.t(null,void 0,i(138368))),g=(0,l.htmlEscape)(s.t(null,void 0,i(833039))),b=(0,l.htmlEscape)(s.t(null,void 0,i(23998))),v=(0,l.htmlEscape)(s.t(null,void 0,i(195400))),w=s.t(null,void 0,i(131539)),S=(s.t(null,{context:'Part of: "Real-time data for {symbolName} is provided by {exchange} exchange."'},i(348473)),s.t(null,{context:'Part of: "Real-time data for {symbolName} is provided by {exchange} exchange."'},i(684455)),s.t(null,void 0,i(624669))),y=s.t(null,void 0,i(352668)),f=s.t(null,void 0,i(344492)),M=(s.t(null,void 0,i(840225)),s.t(null,void 0,i(871847)),s.t(null,void 0,i(439664)),s.t(null,void 0,i(172723)),s.t(null,void 0,i(925608)),s.t(null,void 0,i(733161)),s.t(null,void 0,i(199452)),s.t(null,void 0,i(90589)),s.t(null,void 0,i(443383)),s.t(null,void 0,i(414181)),s.t(null,void 0,i(419679)),s.t(null,void 0,i(284937)),s.t(null,void 0,i(934987)),s.t(null,void 0,i(759269)),s.t(null,void 0,i(801356)),s.t(null,void 0,i(396341)),s.t(null,void 0,i(342457))),C=s.t(null,void 0,i(50277));s.t(null,void 0,i(105888))},190787:(e,t,i)=>{"use strict";function s(e,t){null===e.firstChild?e.textContent=t:e.firstChild.nodeValue=t}i.d(t,{updateTextNode:()=>s})},325004:(e,t,i)=>{"use strict";i.d(t,{usePromise:()=>a});var s=i(50959),l=i(298670);function a(e,t,i){const[a,o]=(0,s.useState)(null);return(0,s.useEffect)((()=>{const i=new AbortController;let s=null;return(0,l.respectAbort)(i.signal,e()).then((e=>o(s=e))).catch(l.skipAbortError),()=>{i.abort(),s&&t&&t(s)}}),i?[...i]:void 0),a}},844836:(e,t,i)=>{"use strict";i.d(t,{useWatchedValueReadonly:()=>s.useWatchedValueReadonly});var s=i(297265)},306858:(e,t,i)=>{"use strict";i.d(t,{removeUsdFromCryptoPairLogos:()=>o,resolveLogoUrls:()=>a});var s=i(868333);const l=(0,s.getLogoUrlResolver)();function a(e,t=s.LogoSize.Medium){const i=e.logoid,a=e["base-currency-logoid"],o=e["currency-logoid"],n=i&&l.getSymbolLogoUrl(i,t);if(n)return[n];const r=a&&l.getSymbolLogoUrl(a,t),d=o&&l.getSymbolLogoUrl(o,t);return r&&d?[r,d]:r?[r]:d?[d]:[]}function o(e){return 2!==e.length?e:function(e){return e.some((e=>n(e)))}(e)&&!function(e){return e.some((e=>e.includes("country")&&!n(e)))}(e)?e.filter((e=>!n(e))):e}function n(e){return!1}},41192:(e,t,i)=>{"use strict";i.d(t,{getBlockStyleClasses:()=>s.getBlockStyleClasses,getLogoStyleClasses:()=>s.getLogoStyleClasses});var s=i(108937)},361701:(e,t,i)=>{"use strict";i.d(t,{CircleLogo:()=>n,hiddenCircleLogoClass:()=>o});var s=i(50959),l=i(185934),a=i(757554);const o=i.n(a)().hidden;function n(e){const t=(0,l.isCircleLogoWithUrlProps)(e),[i,a]=(0,s.useState)(0),o=(0,s.useRef)(null),n=(0,
l.getStyleClasses)(e.size,i,e.className),r=e.alt??e.title??"",d=t?r[0]:e.placeholderLetter;return(0,s.useEffect)((()=>a(o.current?.complete??!t?2:1)),[t]),t&&3!==i?s.createElement("img",{ref:o,className:n,crossOrigin:"",src:e.logoUrl,alt:r,title:e.title,loading:e.loading,onLoad:()=>a(2),onError:()=>a(3),"aria-label":e["aria-label"],"aria-hidden":e["aria-hidden"]}):s.createElement("span",{className:n,title:e.title,"aria-label":e["aria-label"],"aria-hidden":e["aria-hidden"]},d)}},439067:(e,t,i)=>{"use strict";i.d(t,{getStyleClasses:()=>s.getStyleClasses});var s=i(185934)},493173:(e,t,i)=>{"use strict";function s(e,t,i={}){return Object.assign({},e,function(e,t,i={}){const s=Object.assign({},t);for(const l of Object.keys(t)){const a=i[l]||l;a in e&&(s[l]=[e[a],t[l]].join(" "))}return s}(e,t,i))}i.d(t,{mergeThemes:()=>s})},934359:e=>{e.exports={}},872206:e=>{e.exports={marginlegendhoriz:"4px",legend:"legend-l31H9iuA",legend_withHiddenActions:"legend_withHiddenActions-l31H9iuA",item:"item-l31H9iuA",hideInvisibleHover:"hideInvisibleHover-l31H9iuA",button:"button-l31H9iuA",buttons:"buttons-l31H9iuA",withAction:"withAction-l31H9iuA",selected:"selected-l31H9iuA",last:"last-l31H9iuA",statusesWrapper:"statusesWrapper-l31H9iuA",statusesWrapper__statuses:"statusesWrapper__statuses-l31H9iuA",text:"text-l31H9iuA",noWrapWrapper:"noWrapWrapper-l31H9iuA",noWrap:"noWrap-l31H9iuA",series:"series-l31H9iuA",valuesAdditionalWrapper:"valuesAdditionalWrapper-l31H9iuA",valueItem:"valueItem-l31H9iuA",valueTitle:"valueTitle-l31H9iuA",valueValue:"valueValue-l31H9iuA",hideUniportantValueItems:"hideUniportantValueItems-l31H9iuA",unimportant:"unimportant-l31H9iuA",valuesWrapper:"valuesWrapper-l31H9iuA",wrappable:"wrappable-l31H9iuA",directionColumn:"directionColumn-l31H9iuA",titlesWrapper:"titlesWrapper-l31H9iuA",logoWrapper:"logoWrapper-l31H9iuA",buttonsWrapper:"buttonsWrapper-l31H9iuA",pairContainer:"pairContainer-l31H9iuA",logo:"logo-l31H9iuA",hidden:"hidden-l31H9iuA",noActions:"noActions-l31H9iuA",titlesGroupWrapper:"titlesGroupWrapper-l31H9iuA",titleWrapper:"titleWrapper-l31H9iuA",title:"title-l31H9iuA",withDot:"withDot-l31H9iuA",accessible:"accessible-l31H9iuA",disabled:"disabled-l31H9iuA",disabledOnInterval:"disabledOnInterval-l31H9iuA",withCustomTextColor:"withCustomTextColor-l31H9iuA",study:"study-l31H9iuA",mainTitle:"mainTitle-l31H9iuA",inputTitle:"inputTitle-l31H9iuA",hideValues:"hideValues-l31H9iuA",has5Buttons:"has5Buttons-l31H9iuA",stayInHoveredMode:"stayInHoveredMode-l31H9iuA",withTail:"withTail-l31H9iuA",loader:"loader-l31H9iuA",descTitle:"descTitle-l31H9iuA",intervalTitle:"intervalTitle-l31H9iuA",providerTitle:"providerTitle-l31H9iuA",exchangeTitle:"exchangeTitle-l31H9iuA",styleTitle:"styleTitle-l31H9iuA",priceSourceTitle:"priceSourceTitle-l31H9iuA",flagged:"flagged-l31H9iuA",medium:"medium-l31H9iuA",minimized:"minimized-l31H9iuA",micro:"micro-l31H9iuA",linked:"linked-l31H9iuA",onlyOneButtonCanBeStick:"onlyOneButtonCanBeStick-l31H9iuA",touchMode:"touchMode-l31H9iuA",buttonIcon:"buttonIcon-l31H9iuA",flag:"flag-l31H9iuA",
eye:"eye-l31H9iuA",eyeLoading:"eyeLoading-l31H9iuA","eye-animation":"eye-animation-l31H9iuA",linking:"linking-l31H9iuA",intervalEye:"intervalEye-l31H9iuA",markerContainer:"markerContainer-l31H9iuA",flagWrapper:"flagWrapper-l31H9iuA",sourcesWrapper:"sourcesWrapper-l31H9iuA",legendMainSourceWrapper:"legendMainSourceWrapper-l31H9iuA",sources:"sources-l31H9iuA",togglerWrapper:"togglerWrapper-l31H9iuA",toggler:"toggler-l31H9iuA pane-button-e6PF69Df",onlyOneSourceShown:"onlyOneSourceShown-l31H9iuA",counter:"counter-l31H9iuA",iconArrow:"iconArrow-l31H9iuA",objectTree:"objectTree-l31H9iuA",closed:"closed-l31H9iuA",saveArrowWidth:"saveArrowWidth-l31H9iuA",objectsTreeCanBeShown:"objectsTreeCanBeShown-l31H9iuA"}},244784:e=>{e.exports={"css-value-pane-controls-padding":"4px",css_value_pane_controls_margin_top:"4",css_value_pane_controls_button_size:"22",css_value_pane_controls_button_touch_size:"22",paneControls:"paneControls-JQv8nO8e",paneControls_hidden:"paneControls_hidden-JQv8nO8e",paneControls_forceHidden:"paneControls_forceHidden-JQv8nO8e",buttons:"buttons-JQv8nO8e",button:"button-JQv8nO8e",button_activated:"button_activated-JQv8nO8e",touchMode:"touchMode-JQv8nO8e",maximize:"maximize-JQv8nO8e",collapse:"collapse-JQv8nO8e","maximize-animation-up-bracket":"maximize-animation-up-bracket-JQv8nO8e","maximize-animation-down-bracket":"maximize-animation-down-bracket-JQv8nO8e",minimize:"minimize-JQv8nO8e",restore:"restore-JQv8nO8e","minimize-animation-up-bracket":"minimize-animation-up-bracket-JQv8nO8e","minimize-animation-down-bracket":"minimize-animation-down-bracket-JQv8nO8e",up:"up-JQv8nO8e",buttonIcon:"buttonIcon-JQv8nO8e","up-animation":"up-animation-JQv8nO8e",down:"down-JQv8nO8e","down-animation":"down-animation-JQv8nO8e"}},233465:e=>{e.exports={blockHidden:"blockHidden-e6PF69Df","pane-button":"pane-button-e6PF69Df"}},404254:e=>{e.exports={"css-value-small-size":"18px","css-value-medium-size":"22px","css-value-large-size":"28px","css-value-border-radius-small-size":"9px","css-value-border-radius-medium-size":"11px","css-value-border-radius-large-size":"8px","css-value-vertical-padding-size":"16px","css-value-horizontal-padding-size":"16px","css-value-vertical-padding-size-first":"11px","css-value-vertical-padding-size-last":"10px",popupWidgetWrapper:"popupWidgetWrapper-Wu2pIo3E",popupWidgetWidth:"popupWidgetWidth-Wu2pIo3E",popupWidget:"popupWidget-Wu2pIo3E",large:"large-Wu2pIo3E",mobile:"mobile-Wu2pIo3E",desc:"desc-Wu2pIo3E",icon:"icon-Wu2pIo3E",small:"small-Wu2pIo3E",medium:"medium-Wu2pIo3E",title:"title-Wu2pIo3E",text:"text-Wu2pIo3E",item:"item-Wu2pIo3E",boldItem:"boldItem-Wu2pIo3E",action:"action-Wu2pIo3E",actionBtn:"actionBtn-Wu2pIo3E",additionalWidget:"additionalWidget-Wu2pIo3E"}},199241:e=>{e.exports={"css-value-small-size":"18px","css-value-medium-size":"22px","css-value-large-size":"28px","css-value-border-radius-small-size":"9px","css-value-border-radius-medium-size":"11px","css-value-border-radius-large-size":"8px",statusesWrap:"statusesWrap-Lgtz1OtS",statuses:"statuses-Lgtz1OtS",statusItem:"statusItem-Lgtz1OtS",
statuses_hidden:"statuses_hidden-Lgtz1OtS",small:"small-Lgtz1OtS",medium:"medium-Lgtz1OtS",large:"large-Lgtz1OtS",blinking:"blinking-Lgtz1OtS","blinking-animation":"blinking-animation-Lgtz1OtS",marketStatusOpen:"marketStatusOpen-Lgtz1OtS",marketStatusClose:"marketStatusClose-Lgtz1OtS",marketStatusPre:"marketStatusPre-Lgtz1OtS",marketStatusPost:"marketStatusPost-Lgtz1OtS",marketStatusHoliday:"marketStatusHoliday-Lgtz1OtS",marketStatusDelisted:"marketStatusDelisted-Lgtz1OtS",marketStatusExpired:"marketStatusExpired-Lgtz1OtS",marketStatusCustom:"marketStatusCustom-Lgtz1OtS",invalidSymbol:"invalidSymbol-Lgtz1OtS",activeStrategy:"activeStrategy-Lgtz1OtS",alert:"alert-Lgtz1OtS",alertItemsContainer:"alertItemsContainer-Lgtz1OtS",alertItem:"alertItem-Lgtz1OtS",replayModeAutoPlay:"replayModeAutoPlay-Lgtz1OtS",replayModePause:"replayModePause-Lgtz1OtS",replayModePointSelect:"replayModePointSelect-Lgtz1OtS","blinking-animation-custom":"blinking-animation-custom-Lgtz1OtS",notAccurate:"notAccurate-Lgtz1OtS",openedInPineEditor:"openedInPineEditor-Lgtz1OtS",openedInDetachedPineEditor:"openedInDetachedPineEditor-Lgtz1OtS",delay:"delay-Lgtz1OtS",eod:"eod-Lgtz1OtS",dataProblemHigh:"dataProblemHigh-Lgtz1OtS",dataProblemLow:"dataProblemLow-Lgtz1OtS",hasError:"hasError-Lgtz1OtS",updateAvailable:"updateAvailable-Lgtz1OtS"}},738152:(e,t,i)=>{"use strict";var s;function l(e){e.dispatchEvent(new CustomEvent("roving-tabindex:main-element"))}function a(e){e.dispatchEvent(new CustomEvent("roving-tabindex:secondary-element"))}i.d(t,{becomeMainElement:()=>l,becomeSecondaryElement:()=>a}),function(e){e.MainElement="roving-tabindex:main-element",e.SecondaryElement="roving-tabindex:secondary-element"}(s||(s={}))},53618:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ControlBarNavigation:()=>J});var s=i(650151),l=i(609838),a=i(972535),o=i(534934),n=i(780284),r=i(38184),d=i(229144),u=i(142928),h=i(50115),c=i(725784),p=i(601227),_=i(180185),m=i(241075),g=(i(32133),i(958198)),b=i(23317),v=i(689612),w=i(577576),S=i(593724),y=i(691986),f=i(776996),M=i(678529),C=i(50119),E=i(362884),V=i(250662),x=i(542205);i(934359);const W=(0,_.humanReadableModifiers)(_.Modifiers.Alt,!1),L=(0,_.humanReadableModifiers)(_.Modifiers.Shift,!1),k=(0,_.humanReadableModifiers)(_.Modifiers.Mod,!1),A=(0,c.hotKeySerialize)({keys:[W,"R"],text:"{0} + {1}"}),T=(0,c.hotKeySerialize)({keys:[W,"Click",W,"Enter"],text:"{0} + {1}, {2} + {3}"}),B=(0,c.hotKeySerialize)({keys:[C],text:"{0}"}),H=(0,c.hotKeySerialize)({keys:[E],text:"{0}"}),D=(0,c.hotKeySerialize)({keys:[k,V],text:"{0} + {1}"}),P=(0,c.hotKeySerialize)({keys:[k,x],text:"{0} + {1}"}),I=(0,c.hotKeySerialize)({keys:[W,L,E],text:"{0} + {1} + {2}"}),R=l.t(null,void 0,i(188710)),z=l.t(null,void 0,i(297038)),N=l.t(null,void 0,i(461206)),O=l.t(null,void 0,i(631142)),F=l.t(null,void 0,i(590761)),U=l.t(null,void 0,i(825131)),G=l.t(null,void 0,i(575246)),Z=l.t(null,void 0,i(983040));var Q,j;!function(e){e[e.BarVisibleDistance=100]="BarVisibleDistance",e[e.BackButtonRightMargin=14]="BackButtonRightMargin",e[e.SingleButtonWidth=36]="SingleButtonWidth",
e[e.GroupMargins=14]="GroupMargins",e[e.GoToRealtimeButtonWidth=50]="GoToRealtimeButtonWidth",e[e.LeftMargin=50]="LeftMargin",e[e.TimeAxisMainPaneMargin=27]="TimeAxisMainPaneMargin",e[e.PaneControlsHeight=28]="PaneControlsHeight"}(Q||(Q={})),function(e){e.ScrollLeftRight="js-btn-group-scroll",e.ZoomInZoomOut="js-btn-group-zoom",e.Maximize="js-btn-group-maximize",e.ResetScale="js-btn-group-reset-scale"}(j||(j={}));const $=`<div class="control-bar-wrapper">\n\t<div class="control-bar control-bar--hidden">\n\t\t<div class="control-bar__group js-btn-group js-btn-group-zoom">\n\t\t\t<div class="control-bar__btn control-bar__btn--zoom-out apply-common-tooltip" title="${R}" data-tooltip-hotkey="${P}">\n\t\t\t\t${b}\n\t\t\t</div>\n\t\t\t<div class="control-bar__btn control-bar__btn--zoom-in apply-common-tooltip" title="${z}" data-tooltip-hotkey="${D}">\n\t\t\t\t${w}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="control-bar__group js-btn-group js-btn-group-maximize">\n\t\t\t<div class="control-bar__btn control-bar__btn--maximize apply-common-tooltip" title="${N}" data-tooltip-hotkey="${T}">\n\t\t\t\t${y}\n\t\t\t</div>\n\t\t\t<div class="control-bar__btn control-bar__btn--minimize js-hidden apply-common-tooltip" title="${O}" data-tooltip-hotkey="${T}">\n\t\t\t\t${f}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="control-bar__group js-btn-group js-btn-group-scroll">\n\t\t\t<div class="control-bar__btn control-bar__btn--move-left apply-common-tooltip" title="${F}" data-tooltip-hotkey="${B}">\n\t\t\t\t${v}\n\t\t\t</div>\n\t\t\t<div class="control-bar__btn control-bar__btn--move-right apply-common-tooltip" title="${U}" data-tooltip-hotkey="${H}">\n\t\t\t\t${v}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="control-bar__group js-btn-group js-btn-group-reset-scale">\n\t\t\t<div class="control-bar__btn control-bar__btn--turn-button control-bar__btn--btn-hidden apply-common-tooltip js-btn-reset" title="${G}" data-tooltip-hotkey="${A}">\n\t\t\t\t${S}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>`,K=`<div class="control-bar-wrapper control-bar-wrapper--back-present">\n\t<div class="control-bar control-bar__btn control-bar__btn--btn-hidden apply-common-tooltip" title="${Z}" data-tooltip-hotkey="${I}">\n\t\t${M}\n\t</div>\n</div>`,q=p.CheckMobile.any(),X="control-bar__btn--btn-hidden",Y={zoomInOut:!0,maximize:!0,scrollLeftRight:!0,resetScale:!0,goToRealtime:!0};class J{constructor(e,t,i){this._widget=(0,s.ensureNotNull)((0,u.parseHtml)($).querySelector(".control-bar-wrapper")),this._controlBar=(0,s.ensureNotNull)(this._widget.querySelector(".control-bar")),this._back=(0,s.ensureNotNull)((0,u.parseHtml)(K).querySelector(".control-bar-wrapper")),this._btnGroups=Array.from(this._controlBar.querySelectorAll(".js-btn-group")),this._targetPaneWidget=null,this._backButtonVisible=!1,this._backButtonCanBeVisible=!1,this._boundMouseHandler=null,this._chartModel=null,this._controlBarVisible=!1,this._priceAxisChanged=null,this._resetScalesAvailable=null,this._priceAxisName="right",this._rafId=null,this._visibilityTypeProperty=null,
this._boundUpdateMaximizeButtonsVisibility=this._updateMaximizeButtonsVisibility.bind(this),this._boundToggleFullscreenButtons=this._toggleFullscreenButtons.bind(this),this._paneWidth=0,this._leftPriceScaleWidth=0,this._rightPriceScaleWidth=0,this._onVisibilityTypeChange=e=>{"alwaysOn"===e||"alwaysOff"===e?(this._controlBarVisible="alwaysOn"===e,this._parent.removeEventListener("mousemove",this._controlsBarVisibilityHandler,!1),this._parent.removeEventListener("mouseleave",this._controlsBarVisibilityHandler,!1)):(this._controlBarVisible=!1,this._parent.addEventListener("mousemove",this._controlsBarVisibilityHandler),this._parent.addEventListener("mouseleave",this._controlsBarVisibilityHandler)),this._configureBackButtonVisibility(e),this._updateControlBarVisibility()},this._visibilityBackButtonHandler=e=>{const t=this._checkIsPointerNearBox(e,this._back.getBoundingClientRect());void 0!==t&&this._backButtonCanBeVisible!==t&&(this._backButtonCanBeVisible=t,this._setRAF())},this._controlsBarVisibilityHandler=e=>{const t=this._checkIsPointerNearBox(e,this._controlBar.getBoundingClientRect());void 0!==t&&this._controlBarVisible!==t&&(this._controlBarVisible=t,this._setRAF())},this._updateControlBarVisibility=()=>{this._controlBar.classList.toggle("control-bar--hidden",!this._controlBarVisible)},this._chart=e,this._parent=t,this._options=Object.assign({},Y,i),this._visibilityPrioritizedGroups=this._initGroupDescriptions(),this._init(),this._initHandlers(),this.updatePosition()}destroy(){null!==this._visibilityTypeProperty&&(this._visibilityTypeProperty.destroy(),this._visibilityTypeProperty=null),null!==this._boundMouseHandler&&(this._parent.removeEventListener("mousemove",this._boundMouseHandler,!1),this._parent.removeEventListener("mouseleave",this._boundMouseHandler,!1),this._boundMouseHandler=null),null!==this._priceAxisChanged&&(this._priceAxisChanged.unsubscribe(this,this._updateBackBtnPosition),this._priceAxisChanged=null),clearInterval(this._checkIntervalId),this._resetScalesAvailable?.destroy();const e=this._chart.getResizerDetacher();e.fullscreenable.unsubscribe(this._boundUpdateMaximizeButtonsVisibility),e.fullscreen.unsubscribe(this._boundToggleFullscreenButtons),this._chart=null}updatePosition(){const e=this._targetPaneWidget=this._getTargetPaneWidget();if(null===e)return;const t=e.getElement().querySelector(".chart-markup-table .pane");if(null===t)return;this._paneWidth=e.width(),this._leftPriceScaleWidth=this._chart.getPriceAxisMaxWidthByName("left"),this._rightPriceScaleWidth=this._chart.getPriceAxisMaxWidthByName("right");const i=this._parent.getBoundingClientRect().bottom-t.getBoundingClientRect().bottom+this._bottomMargin(e);this._widget.style.bottom=`${i}px`,this._back.style.bottom=`${i}px`,this._updateBtnGroupVisibility()}_getTargetPaneWidget(){const e=this._chart.maximizedPaneWidget();if(e)return e;const t=[...this._chart.paneWidgets()].reverse();for(const e of t)if(e.height()>=this._widget.clientHeight+28+this._bottomMargin(e))return e;return null}_bottomMargin(e){return e.containsMainSeries()?27:0}
_init(){if(p.CheckMobile.any())for(const e of this._btnGroups)e.classList.add("js-hidden");this._buttons={zoomIn:this._widget.querySelector(".control-bar__btn--zoom-in"),zoomOut:this._widget.querySelector(".control-bar__btn--zoom-out"),moveLeft:this._widget.querySelector(".control-bar__btn--move-left"),moveRight:this._widget.querySelector(".control-bar__btn--move-right"),turn:this._widget.querySelector(".control-bar__btn--turn-button"),maximize:this._widget.querySelector(".control-bar__btn--maximize"),minimize:this._widget.querySelector(".control-bar__btn--minimize")},this._parent.appendChild(this._widget),this._parent.appendChild(this._back),this._priceAxisName=(0,d.isRtl)()?"left":"right",this._chart.withModel(this,(()=>{this._chartModel=this._chart.model(),this._initVisibility(),this._priceAxisChanged=this._chart.getPriceAxisWidthChangedByName(this._priceAxisName),this._priceAxisChanged.subscribe(this,this._updateBackBtnPosition),this._resetScalesAvailable=this._chartModel.model().resetScalesAvailable().spawn(),this._resetScalesAvailable.subscribe(this._updateResetScalesButtonVisibility.bind(this),{callWithLast:!0});const e=this._chart.getResizerDetacher();e.fullscreenable.subscribe(this._boundUpdateMaximizeButtonsVisibility),e.fullscreen.subscribe(this._boundToggleFullscreenButtons),this._updateMaximizeButtonsVisibility(),this._updateBackBtnPosition(),this._back.querySelector(".control-bar__btn")?.addEventListener("click",(()=>{this._chart.scrollHelper().scrollToRealtime(!0,(()=>this._checkBackButtonVisibility()))}))}))}_initHandlers(){const e=a.mobiletouch?"touchstart":"mousedown",t=a.mobiletouch?["touchend"]:["mouseup","mouseout"];this._buttons.moveLeft.addEventListener(e,(e=>{e.preventDefault(),this._chart.scrollHelper().moveByBar(1),this._trackEvent("Move Left")})),this._buttons.moveRight.addEventListener(e,(e=>{e.preventDefault(),this._chart.scrollHelper().moveByBar(-1),this._trackEvent("Move Right")}));for(const e of t)this._buttons.moveLeft.addEventListener(e,(()=>this._chart.scrollHelper().stopMove())),this._buttons.moveRight.addEventListener(e,(()=>this._chart.scrollHelper().stopMove()));this._buttons.turn.addEventListener("click",(e=>{e.preventDefault(),this._chart.GUIResetScales(),this._trackEvent("Reset to Default Settings")})),this._buttons.zoomOut.addEventListener("click",(e=>{e.preventDefault(),null!==this._chartModel&&this._chartModel.zoomOut(),this._trackEvent("Zoom Out")})),this._buttons.zoomIn.addEventListener("click",(e=>{e.preventDefault(),null!==this._chartModel&&this._chartModel.zoomIn(),this._trackEvent("Zoom In")})),this._buttons.maximize.addEventListener("click",(e=>{e.preventDefault(),this._chart.setActive(!0),this._chart.getResizerDetacher().requestFullscreen(),this._trackEvent(" Maximize Chart")})),this._buttons.minimize.addEventListener("click",(e=>{e.preventDefault(),this._chart.getResizerDetacher().exitFullscreen(),this._trackEvent(" Restore Chart")}));const i=e=>e.addEventListener("contextmenu",(e=>e.preventDefault()));i(this._buttons.moveLeft),i(this._buttons.moveRight),
i(this._buttons.turn),i(this._buttons.zoomOut),i(this._buttons.zoomIn),i(this._buttons.minimize),i(this._buttons.maximize)}_initGroupDescriptions(){return[{shouldBeHiddenOnMobile:!1,available:this._isMaximizeButtonAvailable.bind(this),className:"js-btn-group-maximize",element:this._getBtnGroup("js-btn-group-maximize"),totalWidth:50},{shouldBeHiddenOnMobile:!1,available:()=>this._options.resetScale,className:"js-btn-group-reset-scale",element:this._getBtnGroup("js-btn-group-reset-scale"),totalWidth:50},{shouldBeHiddenOnMobile:!o.enabled("show_zoom_and_move_buttons_on_touch"),available:()=>this._options.zoomInOut,className:"js-btn-group-zoom",element:this._getBtnGroup("js-btn-group-zoom"),totalWidth:86},{shouldBeHiddenOnMobile:!o.enabled("show_zoom_and_move_buttons_on_touch"),available:()=>this._options.scrollLeftRight,className:"js-btn-group-scroll",element:this._getBtnGroup("js-btn-group-scroll"),totalWidth:86}]}_checkBackButtonVisibility(){if(null===this._chartModel||!this._options.goToRealtime)return;const e=this._backButtonCanBeVisible&&this._chartModel.timeScale().rightOffset()<0;e!==this._backButtonVisible&&(this._backButtonVisible=e,this._back.querySelector(".control-bar__btn")?.classList.toggle(X,!this._backButtonVisible))}_initVisibility(){this._visibilityTypeProperty=(0,n.combine)(((e,t)=>null!==t?"alwaysOff":e),(0,h.convertPropertyToWatchedValue)((0,r.actualBehavior)()).ownership(),(0,m.getSeriesDisplayErrorWV)((0,s.ensureNotNull)(this._chartModel).mainSeries()).ownership()),this._visibilityTypeProperty.subscribe(this._onVisibilityTypeChange,{callWithLast:!0})}_configureBackButtonVisibility(e){"alwaysOff"===e?(clearInterval(this._checkIntervalId),this._checkIntervalId=void 0):this._checkIntervalId=this._checkIntervalId??setInterval((()=>this._checkBackButtonVisibility()),1e3),p.CheckMobile.any()?this._backButtonCanBeVisible="alwaysOff"!==e:"alwaysOn"===e||"alwaysOff"===e?(this._backButtonCanBeVisible="alwaysOn"===e,this._parent.removeEventListener("mousemove",this._visibilityBackButtonHandler,!1),this._parent.removeEventListener("mouseleave",this._visibilityBackButtonHandler,!1)):(this._backButtonCanBeVisible=!1,this._parent.addEventListener("mousemove",this._visibilityBackButtonHandler),this._parent.addEventListener("mouseleave",this._visibilityBackButtonHandler)),this._checkBackButtonVisibility()}_checkIsPointerNearBox(e,t){if(!(e.buttons||null!==this._chartModel&&this._chartModel.lineBeingCreated())){if("mousemove"===e.type){const i=100-(this._targetPaneWidget?this._bottomMargin(this._targetPaneWidget):0);return e.clientX>=t.left-100&&e.clientX<=t.right+100&&e.clientY>=t.top-i&&e.clientY<=t.bottom+100}return!1}}_setRAF(){null===this._rafId&&(this._rafId=this._widget.ownerDocument.defaultView.requestAnimationFrame((()=>{this._checkBackButtonVisibility(),this._updateControlBarVisibility(),this._rafId=null})))}_updateBackBtnPosition(){if("left"===this._priceAxisName||"right"===this._priceAxisName){const e=this._chart.getPriceAxisMaxWidthByName(this._priceAxisName)+14
;e&&(this._back.style.marginRight=`${e}px`)}}_updateBtnGroupVisibility(){const e=this._leftPriceScaleWidth+this._paneWidth,t=(e+this._rightPriceScaleWidth)/2;let i=2*Math.min(e-t,t-this._leftPriceScaleWidth)-50-50,s=!1;for(const e of this._visibilityPrioritizedGroups){e.enoughSpaceForGroup=!1;e.available()&&(!q||!e.shouldBeHiddenOnMobile)&&(i-=e.totalWidth,e.enoughSpaceForGroup=i>=0&&!s,s=s||!e.enoughSpaceForGroup),!e.enoughSpaceForGroup!==e.element.classList.contains("js-hidden")&&e.element.classList.toggle("js-hidden",!e.enoughSpaceForGroup)}this._updateControlBarPosition()}_getBtnGroup(e){return(0,s.ensureDefined)(this._btnGroups.find((t=>t.classList.contains(e))))}_updateControlBarPosition(){const e=this._visibilityPrioritizedGroups.reduce(((e,t)=>e+(t.enoughSpaceForGroup?t.totalWidth:0)),0),t=(this._paneWidth+this._leftPriceScaleWidth+this._rightPriceScaleWidth)/2-Math.ceil(e/2);this._widget.style.left=`${t}px`}_updateResetScalesButtonVisibility(){if(null===this._chartModel)return;const e=this._chartModel.model().resetScalesAvailable().value();this._buttons.turn.classList.toggle(X,!e)}_updateMaximizeButtonsVisibility(){this._updateBtnGroupVisibility()}_toggleFullscreenButtons(){const e=this._chart.inFullscreen();this._buttons.maximize.classList.toggle("js-hidden",e),this._buttons.minimize.classList.toggle("js-hidden",!e)}_isMaximizeButtonAvailable(){return!!this._options.maximize&&(!!this._chart.getResizerDetacher().fullscreenable.value()&&!g.mediaState.isPhoneSizeDevice())}_trackEvent(e){0}}},109180:(e,t,i)=>{"use strict";i.r(t),i.d(t,{LegendWidget:()=>ga});var s=i(327714),l=i(920057),a=i(650151),o=i(780284),n=i(627692),r=i(963632),d=i(144421),u=i(724377),h=i(930202),c=i(778199),p=i(534934),_=i(601227),m=i(190787),g=i(738152),b=i(947278),v=i(175472),w=i(744471),S=i(50959),y=i(632227),f=i(497754),M=i.n(f),C=i(844836),E=i(32133),V=i(284170),x=i(493173),W=i(878112),L=i(297265),k=i(199241);function A(e){const{visible:t,icon:i,className:s,size:l="small",isBlinking:a,turnOffBlinking:o,customColor:n,datasetName:r,datasetEntityId:d}=e,u=(0,L.useWatchedValueReadonly)({watchedValue:t}),h=(0,L.useWatchedValueReadonly)({watchedValue:i}),c=(0,L.useWatchedValueReadonly)({watchedValue:s}),p=(0,L.useWatchedValueReadonly)({watchedValue:n}),_=!!a&&(0,L.useWatchedValueReadonly)({watchedValue:a}),m=d?(0,L.useWatchedValueReadonly)({watchedValue:d}):void 0;if(!u||!h)return null;const g={...r?{"data-name":r}:{},...m?{"data-entity-id":m}:{}};return S.createElement(W.Icon,{className:M()(k.statusItem,k[l],c,{[k.blinking]:_}),onClick:o,style:p?{"--custom-status-color":p}:void 0,...g,icon:h})}var T=i(671129),B=i(798990),H=i(71851),D=i(19952),P=i(468595),I=i(228837),R=i(943158),z=i(325004),N=i(404254);const O=new WeakMap,F=new WeakMap;function U(e){const t=(0,L.useWatchedValueReadonly)({watchedValue:e.info}),i=(0,z.usePromise)((()=>e.preliminaryJob??Promise.resolve()));if(null===t||null===i)return null;const s=t.map((t=>{
const{title:i,titleColor:s,icon:l,iconClassName:o,html:n,action:r,size:u,solutionId:h}=t,c=r?.color||"gray",p=["gray","green","red","blue"].includes(c)?R.LightButton:I.SquareButton;O.has(t)||O.set(t,(0,V.randomHash)());let _=[];return void 0!==e.additionalWidgets&&(_=e.additionalWidgets.map((t=>(F.has(t)||F.set(t,(0,V.randomHash)()),t.renderer((0,a.ensureDefined)(F.get(t)),N.additionalWidget,e.onClose))))),S.createElement("div",{key:O.get(t),className:f(N.popupWidget,N[u],e.isMobile&&N.mobile),"data-qa-id":t.dataQaId,tabIndex:0,ref:e=>{e?.focus()}},S.createElement(W.Icon,{className:f(N.icon,o,k[u],N[u]),style:{"--custom-status-color":s||void 0},icon:l||void 0}),S.createElement("div",{className:N.desc},S.createElement("span",{style:{color:s||void 0},className:f(N.title,N[u])},S.createElement("span",null,i),!1),n&&S.createElement("p",{className:f(N.text,N[u])},n.map(((e,t)=>{let i,s;return(0,d.isObject)(e)?(i=e.text,s=e.bold):i=e,S.createElement("span",{key:`html_item_${t}`,className:f(N.item,s&&N.boldItem),dangerouslySetInnerHTML:{__html:i}})}))),r&&S.createElement(p,{className:f(N.actionBtn,r.className),onClick:()=>{e.onClose(),r?.onClick()},color:c,size:"xsmall",tooltipText:r.tooltip},r.text),_))}));return S.createElement(S.Fragment,null,s)}function G(e){const{anchored:t,offsetPosition:i,statuses:s,isOpen:l,onClose:a,ifNonePlacementRuleMatched:o,mobileBreakpoint:n="all and (max-width: 440px)"}=e,r=(0,C.useWatchedValueReadonly)({watchedValue:s}),d=(0,S.useRef)(null),u=(0,P.usePopoverCloseBehavior)({isOpen:l,onClose:a,excludeArea:t.at,closeOnEscape:!0,closeOnClickAway:!0,closeOnScrollOutside:!0,closeOnResizeWindow:!0,closeOnTab:!0,refToContentWrapperElement:d}),h=(0,T.useMatchMedia)(n);return S.createElement(B.Popover,{isOpen:l,onClose:a,anchored:t,width:{by:"content"},height:{by:"content"},placementRules:[{...D.PLACEMENT_BOTTOM_ALIGN_LEFT,offset:i}],ifNonePlacementRuleMatched:o??{pickRule:{by:"smallest-overlap",criteria:"area"},vertical:"cropSlideToFit",horizontal:"slideToFit"},mobileBreakpoint:n,mobilePositionerStretch:!1,anchorPositionerCardAppearanceClassname:N.popupWidgetWrapper,mobilePositionerCardAppearanceClassname:N.popupWidgetWrapper,"data-qa-id":"chart-statuses-popup",...u},S.createElement(H.PopoverContentVertical,null,r.map(((e,t)=>S.createElement(U,{key:`FullTooltipWidget${t}`,info:e.model.fullInfo(),additionalWidgets:e.additionalWidgets,preliminaryJob:e.preliminaryJob,onClose:()=>a(!1),isMobile:h})))))}const Z=k,Q=new WeakMap,j=v.trackingModeIsAvailable?"medium":"small";function $(e){const{statuses:t,tooltip:i,theme:s=k}=e,[l,a]=(0,S.useState)(!1),o=(0,C.useWatchedValueReadonly)({watchedValue:t}),n=(0,C.useWatchedValueReadonly)({watchedValue:i}),r=(0,S.useMemo)((()=>(0,x.mergeThemes)(Z,s)),[s]),d=(0,S.useRef)(null);return 0===o.length?null:S.createElement("div",{className:r.statusesWrap},S.createElement("div",{ref:d,className:M()(r.statuses,"apply-common-tooltip","common-tooltip-wide",r[j]),onClick:function(e){e.preventDefault(),o.forEach((e=>{e.model.turnOffBlinkingMode?.()})),u(),l&&(t=n,(0,
E.trackEvent)("GUI","Statuses widget's action",t));var t},title:n,"data-name":"legend-source-item-status"},o.map((e=>(Q.has(e)||Q.set(e,(0,V.randomHash)()),S.createElement(A,{key:Q.get(e),visible:e.visible,icon:e.model.icon(),className:e.model.className(),size:e.model.size()??"small",isBlinking:e.model.isBlinkingMode,turnOffBlinking:e.model.turnOffBlinkingMode,customColor:e.model.customColor(),datasetName:e.iconDatasetName,datasetEntityId:e.iconDatasetEntityId}))))),S.createElement(G,{statuses:t,anchored:{type:"element",at:d},isOpen:l,onClose:function(){a(!1)},offsetPosition:{x:-15,y:4}}));function u(){a((e=>!e))}}function K(e){const{container:t,...i}=e;return y.render(S.createElement($,{...i}),t),()=>{y.unmountComponentAtNode(t)}}var q=i(930650);const X=v.trackingModeIsAvailable?44:28;var Y=i(611882),J=i(314913),ee=i(796966),te=i(707051),ie=i(111706),se=i(130551),le=i(613113),ae=i(609838),oe=i(754617);function ne(e){(0,E.trackEvent)("GUI","Legend action",e)}var re,de,ue=i(229144),he=i(204162);function ce(e){return(0,se.isObject)(e)&&"items"in e}function pe(e){return void 0!==e?le.resetTransparency(e):e}function _e(e){return e.hasOwnProperty("touches")}!function(e){e[e.SeriesTitle=0]="SeriesTitle",e[e.SeriesDescription=1]="SeriesDescription",e[e.SeriesInterval=2]="SeriesInterval",e[e.SeriesProvider=3]="SeriesProvider",e[e.SeriesExchange=4]="SeriesExchange",e[e.SeriesStyle=5]="SeriesStyle",e[e.SeriesPriceSource=6]="SeriesPriceSource",e[e.DataSourceTitle=7]="DataSourceTitle",e[e.DataSourceSymbolTitle=8]="DataSourceSymbolTitle",e[e.DataSourceInput=9]="DataSourceInput"}(re||(re={})),function(e){e.Small="small",e.Large="large"}(de||(de={}));const me=new oe.TranslatedString("show {title}",ae.t(null,void 0,i(351382))),ge=new oe.TranslatedString("hide {title}",ae.t(null,void 0,i(713017))),be=ae.t(null,void 0,i(698334)),ve=ae.t(null,void 0,i(327298));class we{constructor(e,t,i,s,l){this._titles=new te.WatchedObject([]),this._values=new r.WatchedValue([]),this._actions=[],this._loading=new r.WatchedValue(!1),this._symbolLogoViewModel=new r.WatchedValue(null),this._destroyed=!1,this._moreActionCM=null,this._updateLoadingStatus=()=>{this._loading.setValue(this._source.isLoading())},this._model=e,this._source=t,this._options=i,this._callbacks=s,this._contextMenuOptions=l,this._disabled=new r.WatchedValue(this._getDisabledState()),this._disabledOnInterval=new r.WatchedValue(this._getDisabledOnIntervalState()),this._selected=new r.WatchedValue(!1),this._isTitleHidden=new r.WatchedValue(this._getTitleHiddenValue()),this._isValuesHidden=new r.WatchedValue(this._getValuesHiddenValue()),this._isRowHidden=new r.WatchedValue(this._getRowHiddenValue()),this._isEditable=new r.WatchedValue(this._getIsEditable()),(0,o.combine)(((e,t,i)=>({})),this._isTitleHidden.weakReference(),this._isValuesHidden.weakReference(),this._disabled.weakReference()).subscribe(this._updateRowVisibilities.bind(this)),this._values.subscribe((()=>{this._isValuesHidden.setValue(this._getValuesHiddenValue())}))}destroy(){this._symbolLogoViewModel.value()?.destroy(),
this._destroyed=!0}titles(){return this._titles.readonly()}values(){return this._values.readonly()}actions(){return this._actions}disabled(){return this._disabled.readonly()}disabledOnInterval(){return this._disabledOnInterval.readonly()}selected(){return this._selected.readonly()}loading(){return this._loading.readonly()}isTitleHidden(){return this._isTitleHidden.readonly()}isRowHidden(){return this._isRowHidden.readonly()}isEditable(){return this._isEditable.readonly()}symbolLogoViewModel(){return this._symbolLogoViewModel}update(){this._updateTitles(),this._updateValues(),this._updateStates(),this.symbolLogoViewModel()?.value()?.update()}onToggleDisabled(){const e=this._source.properties().childs().visible,t=!e.value();this._model.setProperty(e,t,(t?me:ge).format({title:new oe.TranslatedString(this._source.name(),this._source.title(he.TitleDisplayTarget.StatusLine))})),ne((t?"Show":"Hide")+" source")}onShowSettings(e){this._source.userEditEnabled()&&(this.setSourceSelected(),this._callbacks.showChartPropertiesForSource(this._source,e),ne("Settings for source"))}onShowMoreActions(e){return this._options.readOnlyMode?Promise.resolve(null):(ne("Show source context menu"),this._callbacks.showContextMenuForSources([this._source],this._calcNewPosition(e),{...this._contextMenuOptions,isKeyboardEvent:!_e(e)&&(0,ie.isKeyboardClick)(e)},{origin:"LegendPropertiesContextMenu"}))}setSourceSelected(){this._model.selectionMacro((e=>{e.clearSelection(),e.addSourceToSelection(this._source)}))}_moreActionHandler(e){e.preventDefault(),null!==this._moreActionCM&&this._moreActionCM.isShown()?this._moreActionCM=null:(this.setSourceSelected(),this.onShowMoreActions(e).then((e=>{this._moreActionCM=e})))}_updateStates(){this._disabled.setValue(this._getDisabledState()),this._disabledOnInterval.setValue(this._getDisabledOnIntervalState()),this._selected.setValue(this._model.selection().isSelected(this._source)),this._isEditable.setValue(this._getIsEditable()),this._updateLoadingStatus()}_hasValues(){return this._values.value().length>0}_getEyeTitle(){return this._disabled.value()?be:ve}_getIsEditable(){return this._source.userEditEnabled()}_getDisabledState(){return!this._source.properties().visible.value()}_updateRowVisibilities(){this._isRowHidden.setValue(this._getRowHiddenValue())}_getRowHiddenValue(){return this._options.readOnlyMode&&this._disabled.value()||this._isTitleHidden.value()&&(this._isValuesHidden.value()||this._disabled.value())}_calcNewPosition(e){let t={};if(_e(e)&&e.touches.length>0)t={clientX:e.touches[0].clientX,clientY:e.touches[0].clientY};else if(null!==e.target){const i=e.target.getBoundingClientRect();t={clientX:(0,ue.isRtl)()?i.right:i.left,clientY:i.top+i.height+3}}else{const i=e;t={clientX:i.clientX,clientY:i.clientY}}return t}}var Se=i(903963),ye=i(650279),fe=i(41192),Me=i(439067),Ce=i(626800),Ee=i(879844),Ve=i(361701),xe=i(872206);class We{constructor(e){this._lastDrawnLogos=[],this._logoWrapper=null,this._pairContainer=null,this._primaryLogo=null,this._secondaryLogo=null,this._logoContainer=null,
this._symbolLetterContainer=null,this._updateLogoVisibility=e=>{this._logoWrapper&&this._logoWrapper.classList.toggle(xe.hidden,!e)},this._updateSymbolLogo=async e=>{if(null===this._logoWrapper&&this._renderSymbolLogo(),0!==this._lastDrawnLogos.length&&0!==e.length&&(0,ye.default)(this._lastDrawnLogos,e))return;const t=await(i=e,Promise.all(i.map((e=>(0,Ee.getImage)(`symbol_logo_${e}`,e,ke).then((e=>e.cloneNode())))))).catch((()=>[]));var i;switch(t.length){case 0:this._pairContainer?.classList.add(xe.hidden),this._logoContainer?.classList.add(Ve.hiddenCircleLogoClass),this._updateSymbolLetter(),this._symbolLetterContainer?.classList.remove(Ve.hiddenCircleLogoClass),this._lastDrawnLogos=e;break;case 1:Le(this._logoContainer,t[0]),this._pairContainer?.classList.add(xe.hidden),this._logoContainer?.classList.remove(Ve.hiddenCircleLogoClass),this._symbolLetterContainer?.classList.add(Ve.hiddenCircleLogoClass),this._lastDrawnLogos=e;break;case 2:Le(this._primaryLogo,t[0]),Le(this._secondaryLogo,t[1]),this._pairContainer?.classList.remove(xe.hidden),this._logoContainer?.classList.add(Ve.hiddenCircleLogoClass),this._symbolLetterContainer?.classList.add(Ve.hiddenCircleLogoClass),this._lastDrawnLogos=e}},this._model=e,this._renderSymbolLogo(),this._logoUrls=e.symbolLogoUrls().spawn(),this._logoUrls.subscribe(this._updateSymbolLogo,{callWithLast:!0}),this._isLogoVisible=e.isSymbolLogoVisible().spawn(),this._isLogoVisible.subscribe(this._updateLogoVisibility,{callWithLast:!0})}destroy(){this._logoWrapper?.remove(),this._logoWrapper=null,this._pairContainer=null,this._primaryLogo=null,this._secondaryLogo=null,this._logoContainer=null,this._symbolLetterContainer=null,this._logoUrls.destroy(),this._isLogoVisible.destroy()}getElement(){return this._logoWrapper}_renderSymbolLogo(){if(!this._logoWrapper){const e=this._logoWrapper=document.createElement("div");e.classList.add(xe.logoWrapper);const t=this._pairContainer=e.appendChild(document.createElement("span"));t.classList.add(xe.pairContainer,xe.hidden);const i=t.appendChild(document.createElement("span"));i.className=(0,fe.getBlockStyleClasses)("xxxsmall");(this._secondaryLogo=i.appendChild(document.createElement("span"))).className=M()((0,fe.getLogoStyleClasses)("xxxsmall"),xe.logo);(this._primaryLogo=i.appendChild(document.createElement("span"))).className=M()((0,fe.getLogoStyleClasses)("xxxsmall"),xe.logo);(this._logoContainer=e.appendChild(document.createElement("span"))).className=M()((0,Me.getStyleClasses)("xxxsmall"),xe.logo,Ve.hiddenCircleLogoClass);(this._symbolLetterContainer=e.appendChild(document.createElement("span"))).className=M()((0,Me.getStyleClasses)("xxxsmall"),xe.logo),this._updateSymbolLetter()}}_updateSymbolLetter(){if(this._symbolLetterContainer){const e=(0,Ce.safeShortName)(this._model.symbol()??"")[0];(0,m.updateTextNode)(this._symbolLetterContainer,e)}}}function Le(e,t){e&&e.replaceChildren(t)}function ke(e){e.crossOrigin="",e.decoding="async"}var Ae=i(233465);const Te=_.CheckMobile.any();var Be,He;!function(e){e[e.Tiny=1]="Tiny",e[e.Small=2]="Small",
e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(Be||(Be={})),function(e){e[e.NoIntervalForMultiChart=1]="NoIntervalForMultiChart",e[e.NoExchangeProviderAndInterval=2]="NoExchangeProviderAndInterval",e[e.AllVisible=3]="AllVisible"}(He||(He={}));function De(e,t){e.dataset.status=t?"loading":void 0}const Pe=(0,x.mergeThemes)(Z,{statusesWrap:xe.statusesWrapper__statuses});class Ie{constructor(e,t,i){this._el=null,this._firstBlockWrapper=null,this._titlesWrapperEl=null,this._titleContainers=[],this._titleElements=[],this._valuesElements=[],this._actionsParentEl=null,this._actionAdditionalWrapperEl=null,this._actionElements=[],this._accessibleTitleButtons=[],this._accessibleActionButtons=[],this._rowMode=4,this._titlesMode=3,this._statusesWrapper=null,this._statusesWidgetState=null,this._loader=null,this._valuesParentEl=null,this._valuesAdditionalWrapperEl=null,this._symbolLogoRenderer=null,this._resizeObserver=null,this._hideInvisibleHover=null,this._hideValues=null,this._allButtonsWidth=null,this._lastStatusesWrapperWidth=null,this._lastActionsWrapperWidth=null,this._showActionsHandler=null,this._hideActionsHandler=null,this._selectedSourceHandler=null,this._mouseEventHandlers=[],this._disableTimeout=null,this._toggleHiddenActions=null,this._updateDisabledState=(e=this._disabled.value())=>{null!==this._el&&(this._el.classList.toggle(xe.disabled,e),this._updateLoadingState(),this._updateStatusWidgetVisibility(e),this._updateTitleMaxWidth())},this._updateLoadingState=(e=this._loading.value())=>{if(null!==this._el){this._el.classList.toggle(xe.eyeLoading,e&&!this._disabled.value()),De(this._el,e)}null!==this._loader&&this._loader.toggleVisibility(e),this._updateShowValues()},this._updateSymbolLogoRenderer=e=>{if(this._symbolLogoRenderer?.destroy(),e){this._symbolLogoRenderer=new We(e);const t=this._titlesStatesSpawn.value().findIndex((e=>this._isTitleWithSymbolLogo(e)));if(-1!==t){const e=this._titleContainers[t];if(e){const t=this._symbolLogoRenderer.getElement();t&&e.insertBefore(t,e.firstChild)}}}else this._symbolLogoRenderer=null},this._model=e,this._parentEl=t,this._disabled=this._model.disabled().spawn(),this._disabled.subscribe(this._updateDisabledState),this._disabledOnInterval=this._model.disabledOnInterval().spawn(),this._disabledOnInterval.subscribe(this._updateDisabledOnIntervalState.bind(this)),this._selected=this._model.selected().spawn(),this._selected.subscribe(this._updateSelectedState.bind(this)),this._loading=this._model.loading().spawn(),this._loading.subscribe(function(e,t){let i=0;return s=>{clearTimeout(i),s?e():i=setTimeout(e,t)}}(this._updateLoadingState,700)),this._isTitleHidden=this._model.isTitleHidden().spawn(),this._isRowHidden=this._model.isRowHidden().spawn(),this._isTitleHidden.subscribe(this._updateShowTitles.bind(this)),this._isRowHidden.subscribe(this._updateShowLine.bind(this)),this._titlesStatesSpawn=this._model.titles().spawn(),this._titlesStatesSpawn.subscribe(this._titlesCollectionChanged.bind(this)),this._values=this._model.values().spawn(),
this._values.subscribe(this._updateValues.bind(this)),this._createValuesSpawns(),this._addValuesSpawnsSubscriptions(),e.symbolLogoViewModel().subscribe(this._updateSymbolLogoRenderer),this._updateSymbolLogoRenderer(e.symbolLogoViewModel().value()),this._actionsSpawnArray=this._model.actions().map((e=>({visible:e.visible.spawn(),title:void 0===e.title?null:e.title.spawn()})));for(let e=0;e<this._actionsSpawnArray.length;e++){this._actionsSpawnArray[e].visible.subscribe(this._updateActionVisibilities.bind(this,e));const t=this._actionsSpawnArray[e].title;null!==t&&t.subscribe(this._updateActionTitle.bind(this,e))}this._withActions=i.withActions,this._isMultipleLayout=i.isMultipleLayout.spawn(),this._customTextColor=i.customTextColor.spawn(),this._customTextColor.subscribe(this._updateCustomTextColor.bind(this)),this._render(),this._updateStates(),this._updateShowTitles(),this._updateShowValues(),this._updateShowLine(),this._loader=(0,Se.createPointsLoaderRenderer)((0,a.ensureNotNull)(this._valuesParentEl),{className:xe.loader}),this._withActions&&(this._toggleHiddenActions=i.toggleHiddenActions,this._showActionsHandler=(0,ee.wrapHandlerWithPreventEvent)(this._showActions.bind(this)),this._hideActionsHandler=(0,ee.wrapHandlerWithPreventEvent)(this._hideActions.bind(this)),this._selectedSourceHandler=(0,q.defaultPreventedHandler)(this._model.setSourceSelected.bind(this._model)),null!==this._titlesWrapperEl&&(Te||(this._titlesWrapperEl.addEventListener("mouseenter",this._showActionsHandler),this._titlesWrapperEl.addEventListener("mouseleave",this._hideActionsHandler)),this._mouseEventHandlers.push(new q.MouseEventHandler(this._titlesWrapperEl,{mouseDoubleClickEvent:this._model.onShowSettings.bind(this._model),doubleTapEvent:this._model.onShowSettings.bind(this._model),mouseClickEvent:this._selectedSourceHandler,tapEvent:this._selectedSourceHandler}))),null===this._actionAdditionalWrapperEl||null===this._actionsParentEl||Te||(this._actionAdditionalWrapperEl.addEventListener("mouseenter",this._showActionsHandler),this._actionAdditionalWrapperEl.addEventListener("mouseleave",this._hideActionsHandler),this._actionsParentEl.addEventListener("contextmenu",(e=>{e.preventDefault(),e.stopPropagation()}))))}destroy(){if(this._toggleHiddenActions=null,this._disabled.destroy(),this._disabledOnInterval.destroy(),this._selected.destroy(),this._loading.destroy(),this._isTitleHidden.destroy(),this._isRowHidden.destroy(),this._customTextColor.destroy(),this._loader?.destroy(),this._isMultipleLayout.destroy(),this._model.symbolLogoViewModel().unsubscribe(this._updateSymbolLogoRenderer),this._symbolLogoRenderer?.destroy(),null!==this._disableTimeout&&clearTimeout(this._disableTimeout),this._accessibleTitleButtons=[],this._accessibleActionButtons=[],this._statusesWidgetDestroy?.(),this._titlesStatesSpawn.destroy(),null!==this._titlesWrapperEl){for(const e of this._mouseEventHandlers)e.destroy();this._titleContainers=[],this._titleElements=[],
this._withActions&&null!==this._selectedSourceHandler&&null!==this._showActionsHandler&&null!==this._hideActionsHandler&&(Te||(this._titlesWrapperEl.removeEventListener("mouseenter",this._showActionsHandler),this._titlesWrapperEl.removeEventListener("mouseleave",this._hideActionsHandler))),this._titlesWrapperEl=null}for(const e of this._actionsSpawnArray){e.visible.destroy();const t=e.title;null!==t&&t.destroy()}if(this._actionElements=[],null!==this._actionAdditionalWrapperEl&&(this._withActions&&null!==this._showActionsHandler&&null!==this._hideActionsHandler&&!Te&&(this._actionAdditionalWrapperEl.removeEventListener("mouseenter",this._showActionsHandler),this._actionAdditionalWrapperEl.removeEventListener("mouseleave",this._hideActionsHandler)),this._actionAdditionalWrapperEl=null),this._actionsParentEl=null,this._removeValuesSpawnsSubscriptions(),this._values.destroy(),null!==this._valuesParentEl&&(this._valuesElements=[],this._valuesParentEl=null),this._hideInvisibleHover?.destroy(),this._hideValues?.destroy(),null!==this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null),null!==this._el){const e=this._el.parentNode;e?.removeChild(this._el),this._el=null}}getElement(){return this._el}getHeight(){return null===this._el?null:24}updateMode(e,t){this._rowMode===e&&this._titlesMode===t&&null!==this._allButtonsWidth||(this._rowMode!==e&&(this._rowMode=e,this._updateActionsVisibilitiesByMode()),this._titlesMode!==t&&(this._titlesMode=t,this._updateTitlesVisibilitiesByMode()),this._updateAllButtonsWidth())}accessibleButtons(){return this._isRowHidden.value()?[]:[...this._accessibleTitleButtons,...this._accessibleActionButtons].filter((e=>!e.classList.contains(Ae.blockHidden)))}showActions(){null===this._el||this._el.classList.contains(xe.withAction)||this._showActions()}hideActions(){null!==this._el&&this._el.classList.contains(xe.withAction)&&this._hideActions()}_updateActionsVisibilitiesByMode(){}_updateTitlesVisibilitiesByMode(){}_render(){this._renderTitles(),this._renderActions(),this._renderValues();const e=this._customTextColor.value()||"";this._el=document.createElement("div"),this._el.classList.toggle(xe.withCustomTextColor,Boolean(e)),De(this._el,this._loading.value()),this._firstBlockWrapper=document.createElement("div"),this._firstBlockWrapper.classList.add(xe.noWrapWrapper),this._firstBlockWrapper.appendChild((0,a.ensureNotNull)(this._titlesWrapperEl)),null!==this._actionsParentEl&&this._firstBlockWrapper.appendChild(this._actionsParentEl),this._el.appendChild(this._firstBlockWrapper),this._el.appendChild((0,a.ensureNotNull)(this._valuesParentEl)),this._parentEl.append(this._el)}_renderTitles(){null===this._titlesWrapperEl&&(this._titlesWrapperEl=document.createElement("div"),this._titlesWrapperEl.classList.add(xe.titlesWrapper));for(const e of this._titlesStatesSpawn.value())ce(e)?this._renderTitlesGroup(e):this._renderSimpleTitle(e)}_renderTitlesGroup(e){const t=document.createElement("div");t.classList.add(xe.titlesGroupWrapper),
e.items.forEach((e=>this._renderSimpleTitle(e,t))),(0,a.ensureNotNull)(this._titlesWrapperEl).appendChild(t)}_renderSimpleTitle(e,t){const{title:i,tooltip:s,onClick:l}=e,o=l,n=this._getAttributesForTitleState(e),r=i??"",d=this._customTextColor.value()||"",u=document.createElement("div");u.classList.add(xe.titleWrapper,xe.withDot),u.style.color=d,n?.className&&u.classList.add(n.className),n?.titleId&&(u.dataset.name=n.titleId),void 0!==s&&(u.classList.add("apply-common-tooltip"),u.setAttribute("title",s));const h=document.createElement(o?"button":"div");if(h.classList.add(xe.title),void 0!==l){u.classList.add(xe.withAction);const e=e=>{this._selectedSourceHandler?.(e),l(),o&&h.blur()};this._mouseEventHandlers.push(new q.MouseEventHandler(u,{mouseClickEvent:e,tapEvent:_.CheckMobile.any()?void 0:e},{ignoreClickAndTapOnDblClickOrDblTap:!0}))}if(o){const e=h;this._makeItemAccessible(e,l,s??""),this._accessibleTitleButtons.push(e)}if(r.length>0?h.appendChild(document.createTextNode(r)):(u.classList.add(Ae.blockHidden),h.classList.add(Ae.blockHidden)),u.appendChild(h),this._isTitleWithSymbolLogo(e)){const e=this._symbolLogoRenderer?.getElement();e&&u.insertBefore(e,u.firstChild)}(t??(0,a.ensureNotNull)(this._titlesWrapperEl)).appendChild(u),this._titleContainers.push(u),this._titleElements.push(h)}_makeItemAccessible(e,t,i){""!==i&&e.setAttribute("aria-label",i),e.type="button",e.classList.add(xe.accessible),e.tabIndex=-1;const s=t=>{switch(t.type){case"roving-tabindex:main-element":e.tabIndex=0;break;case"roving-tabindex:secondary-element":e.tabIndex=-1}};e.addEventListener("roving-tabindex:main-element",s),e.addEventListener("roving-tabindex:secondary-element",s),e.addEventListener("keydown",(e=>{const i=(0,h.hashFromEvent)(e);13!==i&&32!==i||(e.preventDefault(),t(e))}))}_renderActions(){if(!this._withActions)return;null===this._actionsParentEl&&(this._actionsParentEl=document.createElement("div"),this._actionsParentEl.classList.add(xe.buttonsWrapper),this._actionsParentEl.dataset.name="actions",this._parentEl.append(this._actionsParentEl),this._actionAdditionalWrapperEl=document.createElement("div"),this._actionAdditionalWrapperEl.classList.add(xe.buttons),this._actionsParentEl.appendChild(this._actionAdditionalWrapperEl));const e=(0,a.ensureNotNull)(this._actionAdditionalWrapperEl);this._model.actions().forEach((t=>{const i=void 0===t.disableAccessibility,s={iconSize:v.trackingModeIsAvailable?"large":"small",tag:i?"button":"div",buttonClassName:xe.button,wrapIconClassName:xe.buttonIcon,hiddenClassName:Ae.blockHidden,blurOnClick:!!i||void 0},l=(0,J.createActionElement)(t,s);if(i){const e=l;this._makeItemAccessible(e,(e=>{t.action(e)}),t.title?.value()??""),this._accessibleActionButtons.push(e)}this._actionElements.push(l),e.appendChild(l)}))}_initWrappersIfNotInitialized(){return null===this._valuesParentEl&&(this._valuesParentEl=document.createElement("div"),this._valuesParentEl.classList.add(xe.valuesWrapper),this._valuesAdditionalWrapperEl=document.createElement("div"),
this._valuesAdditionalWrapperEl.classList.add(xe.valuesAdditionalWrapper),this._valuesParentEl.appendChild(this._valuesAdditionalWrapperEl)),(0,a.ensureNotNull)(this._valuesAdditionalWrapperEl)}_isWidthButtonsMode(){return null!==this._el&&(this._el.classList.contains(xe.withAction)||this._disabled.value()||this._selected.value())}_isTitleHiddenByMode(e){return!1}_updateStates(e){this._updateDisabledState(),this._updateDisabledOnIntervalState(),this._updateSelectedState(),this._updateLoadingState(),e&&this._clearDisableState()}_updateValuesHTMLElHandler(e,t){const i=(0,a.ensure)(this._valuesElements[e].value);(0,m.updateTextNode)(i,t),this._updateShowValues()}_updateValueColorHandler(e,t=""){(0,a.ensure)(this._valuesElements[e].value).style.color=t}_updateValueVisibleHandler(e,t){const i=(0,a.ensure)(this._valuesElements[e].value).closest(`.${xe.valueItem}`);null!==i&&i.classList.toggle(Ae.blockHidden,!t),this._updateShowValues()}_updateShowLine(){null!==this._el&&this._el.classList.toggle(Ae.blockHidden,this._isRowHidden.value())}_titlesCollectionChanged(){null!==this._titlesWrapperEl&&(this._titlesWrapperEl.innerHTML=""),this._accessibleTitleButtons=[],this._titleContainers=[],this._titleElements=[],this._renderTitles(),this._updateTitlesVisibilitiesByMode()}_createValuesSpawns(){this._valuesSpawnArray=this._values.value().map((e=>({value:e.value.spawn(),color:e.color.spawn(),visible:e.visible.spawn(),title:e.title.spawn()})))}_removeValuesSpawnsSubscriptions(){for(const e of this._valuesSpawnArray)e.value.destroy(),e.color.destroy(),e.visible.destroy(),e.title.destroy();this._valuesSpawnArray=[]}_addValuesSpawnsSubscriptions(){for(let e=0;e<this._valuesSpawnArray.length;e++){const t=this._valuesSpawnArray[e];t.value.subscribe(this._updateValuesHTMLElHandler.bind(this,e)),t.color.subscribe(this._updateValueColorHandler.bind(this,e)),t.visible.subscribe(this._updateValueVisibleHandler.bind(this,e)),t.title.subscribe(this._updateValuesTitleHTMLElHandler.bind(this,e))}}_updateShowValues(){function e(e){if(!e)return;const t=Array.from(e.children).every((e=>e.classList.contains(Ae.blockHidden)));e.classList.toggle(Ae.blockHidden,t)}e(this._valuesAdditionalWrapperEl),e(this._valuesParentEl)}_addStatusesWidget(e){this._hideInvisibleHover=e.visibility().spawn(),this._hideInvisibleHover.subscribe(this._updateHideInvisibleHoverMode.bind(this),{callWithLast:!0}),this._hideValues=(0,o.combine)(((e,t)=>e||t),e.dataSourceErrorStatusShown.weakReference(),e.isSymbolInvalidStatusShown.weakReference()),this._hideValues.subscribe(this._updateHideValuesMode.bind(this),{callWithLast:!0}),this._statusesWrapper=document.createElement("div"),this._statusesWrapper.classList.add(xe.statusesWrapper),this._statusesWidgetState=e,this._disabled.value()?this._statusesWidgetDestroy=K({container:this._statusesWrapper,statuses:e.visibleModels(),tooltip:e.tooltip(),theme:Pe}):(this._statusesWidgetDestroy?.(),this._statusesWidgetDestroy=void 0),(0,a.ensureNotNull)(this._firstBlockWrapper).appendChild(this._statusesWrapper),
this._updateStatusWidgetVisibility(this._disabled.value()),this._resizeObserver=new ResizeObserver(this._handlerRestrictTitleWidth.bind(this)),null!==this._actionsParentEl&&this._resizeObserver.observe(this._actionsParentEl),this._resizeObserver.observe(this._statusesWrapper)}_updateTitleMaxWidth(){if(null===this._firstBlockWrapper)return;const e=this._allButtonsWidth||0,t=(this._lastActionsWrapperWidth||0)+(this._lastStatusesWrapperWidth||0);this._isWidthButtonsMode()?this._firstBlockWrapper.style.maxWidth=`calc(100% - ${Math.max(e,t)}px)`:this._firstBlockWrapper.style.maxWidth=t>0?`calc(100% - ${t}px)`:""}_updateAllButtonsWidth(){this._allButtonsWidth=this._getButtonsCount()*X+1,this._updateTitleMaxWidth()}_updateHideInvisibleHoverMode(e){null!==this._el&&this._el.classList.toggle(xe.hideInvisibleHover,e)}_updateHideValuesMode(e){null!==this._el&&this._el.classList.toggle(xe.hideValues,e)}_showActions(){if(null===this._el||!this._withActions)return;this._el.classList.add(xe.withAction),this._toggleHiddenActions?.(!0);const e=this._valuesParentEl?.offsetTop===this._titlesWrapperEl?.offsetTop;this._el.classList.toggle(xe.withTail,e),this._updateTitleMaxWidth()}_hideActions(){null!==this._el&&this._withActions&&(this._el.classList.remove(xe.withAction),this._toggleHiddenActions?.(!1),null!==this._valuesParentEl&&this._valuesParentEl.classList.remove(xe.withTail),this._updateTitleMaxWidth())}_handlerRestrictTitleWidth(e){if(null===this._actionsParentEl||null===this._firstBlockWrapper)return;let t=null,i=null;for(const s of e)s.target===this._statusesWrapper&&(t=s.contentRect.width),s.target===this._actionsParentEl&&(i=s.contentRect.width);t===this._lastStatusesWrapperWidth&&i===this._lastActionsWrapperWidth||(null!==t&&(this._lastStatusesWrapperWidth=t),null!==i&&(this._lastActionsWrapperWidth=i),this._updateTitleMaxWidth())}_clearDisableState(){null!==this._el&&(this._el.classList.remove(xe.eyeLoading),this._el.classList.remove(xe.disabled),this._updateStatusWidgetVisibility(this._disabled.value()),this._updateTitleMaxWidth())}_updateDisabledOnIntervalState(){this._el?.classList.toggle(xe.disabledOnInterval,this._disabledOnInterval.value())}_updateSelectedState(){null!==this._el&&this._withActions&&this._el.classList.toggle(xe.selected,this._selected.value())}_updateShowTitles(){null!==this._titlesWrapperEl&&(this._titlesWrapperEl.classList.toggle(Ae.blockHidden,this._isTitleHidden.value()),null!==this._actionsParentEl&&this._actionsParentEl.classList.toggle(Ae.blockHidden,this._isTitleHidden.value()))}_updateValues(){this._removeValuesSpawnsSubscriptions(),this._createValuesSpawns(),null!==this._valuesParentEl&&null!==this._valuesAdditionalWrapperEl&&(this._valuesElements=[],this._valuesAdditionalWrapperEl.innerHTML=""),this._renderValues(),this._addValuesSpawnsSubscriptions(),this._updateShowValues()}_updateActionVisibilities(e){null!==this._actionsParentEl&&this._actionsParentEl.querySelectorAll(`.${xe.button}`)[e].classList.toggle(Ae.blockHidden,!this._actionsSpawnArray[e].visible.value())}_updateActionTitle(e){
const t=this._actionsSpawnArray[e].title;if(null===this._actionsParentEl||null===t)return;const i=this._actionsParentEl.querySelectorAll(`.${xe.button}`)[e];i.setAttribute("title",t.value()),i.hasAttribute("aria-label")&&i.setAttribute("aria-label",t.value()),i.dispatchEvent(new CustomEvent("common-tooltip-update"))}_updateCustomTextColor(){const e=this._customTextColor.value()||"";for(const t of this._titleContainers)null!==t&&(t.style.color=e);const t=(0,a.ensureNotNull)(this._valuesParentEl).querySelectorAll(`.${xe.valueTitle}`);for(let i=0;i<t.length;i++)t[i].style.color=e;(0,a.ensureNotNull)(this._el).classList.toggle(xe.withCustomTextColor,Boolean(e))}_updateStatusWidgetVisibility(e){null!==this._statusesWrapper&&(e?(this._statusesWidgetDestroy?.(),this._statusesWidgetDestroy=void 0):this._statusesWidgetDestroy=K({container:this._statusesWrapper,statuses:this._statusesWidgetState?.visibleModels()??new Y.WatchedValue([]).readonly(),tooltip:this._statusesWidgetState?.tooltip()??new Y.WatchedValue("").readonly(),theme:Pe}))}_isTitleWithSymbolLogo(e){return 8===e.id||0===e.id}}const Re=_.isSafari?"click":"auxclick";class ze extends Ie{constructor(e,t,i){super(e,t,i),this._wheelClickHandler=null,this._canUpdateRowVisibility=!0,this._globalRowVisibility=this._model.globalVisibility().spawn(),this._globalRowVisibility.subscribe(this._updateShowLine.bind(this),{callWithLast:!0}),this._has5Buttons=this._model.isAbleShowSourceCode().spawn(),this._has5Buttons.subscribe(this._update5ButtonsStyles.bind(this),{callWithLast:!0}),this._updateStates(!this._disabled.value()),i.statusesWidgetState&&this._addStatusesWidget(i.statusesWidgetState),this._selected.subscribe(this._updateTitleMaxWidth.bind(this)),i.withActions&&(this._wheelClickHandler=this._onWheelClicked.bind(this),null!==this._titlesWrapperEl&&this._titlesWrapperEl.addEventListener(Re,this._wheelClickHandler))}destroy(){this._has5Buttons.destroy(),this._globalRowVisibility&&this._globalRowVisibility.destroy(),null!==this._wheelClickHandler&&null!==this._titlesWrapperEl&&this._titlesWrapperEl.removeEventListener(Re,this._wheelClickHandler),super.destroy()}accessibleButtons(){return this._globalRowVisibility.value()?super.accessibleButtons():[]}_updateActionsVisibilitiesByMode(){if(!this._withActions)return;const e=this._model.actions(),t=[];let i=[];if(2===this._rowMode||1===this._rowMode)e[0].visible.value()&&t.push(this._actionElements[0]),e[this._actionElements.length-1].visible.value()&&t.push(this._actionElements[this._actionElements.length-1]),i=this._actionElements.slice(1,this._actionElements.length-1);else for(let i=0;i<this._actionElements.length-1;i++)e[i].visible.value()&&t.push(this._actionElements[i]);i.forEach((e=>e.classList.toggle(Ae.blockHidden,!0))),t.forEach((e=>e.classList.toggle(Ae.blockHidden,!1)))}_updateShowLine(){if(null===this._el||!this._canUpdateRowVisibility)return;const e=!this._globalRowVisibility.value();e?this._el.classList.toggle(Ae.blockHidden,e):super._updateShowLine()}_getButtonsCount(){switch(this._rowMode){case 4:
return this._has5Buttons.value()?5:4;case 3:return 3;default:return 2}}_render(){super._render();const e=(0,a.ensureNotNull)(this._el);e.classList.add(xe.item,xe.study),e.dataset.name="legend-source-item",e.dataset.entityId=this._model.getSource().id(),e.setAttribute("role","toolbar")}_getAttributesForTitleState(e){return 7===e.id||8===e.id?{titleId:"legend-source-title",className:xe.mainTitle}:9===e.id?{titleId:"legend-source-description",className:xe.inputTitle}:null}_renderValues(){const e=this._initWrappersIfNotInitialized(),t=this._values.value();for(const i of t){const t=document.createElement("div");t.dataset.testIdValueTitle=i.title.value(),t.classList.add(xe.valueItem),t.classList.toggle(Ae.blockHidden,!i.visible.value());const s=document.createElement("div");s.classList.add(xe.valueValue),s.style.color=i.color.value()||"",s.appendChild(document.createTextNode(i.value.value()));const l=i.title.value();void 0!==l&&(s.classList.add("apply-common-tooltip"),s.title=l),t.appendChild(s),this._valuesElements.push({value:s}),e.appendChild(t)}}_updateValuesTitleHTMLElHandler(e,t=""){const i=(0,a.ensure)(this._valuesElements[e].value);i.classList.toggle("apply-common-tooltip",0!==t.length),i.title=t}_update5ButtonsStyles(e){null!==this._el&&(this._el.classList.toggle(xe.has5Buttons,e),this._updateAllButtonsWidth())}_onWheelClicked(e){1===e.button&&this._model.onRemoveSource()}}class Ne extends Ie{constructor(e,t,i){super(e,t,i),this._clientHeight=null,this._updateLinkedState=void 0,this._flagged=this._model.flagged().spawn(),this._flagged.subscribe(this._updateFlaggedState.bind(this)),this._updateStates(),i.statusesWidgetState&&this._addStatusesWidget(i.statusesWidgetState),this._selected.subscribe(this._updateTitleMaxWidth.bind(this))}destroy(){super.destroy(),this._flagged?.destroy()}getHeight(){return null===this._el?null:(null===this._clientHeight&&(this._clientHeight=this._el.clientHeight,0===this._clientHeight&&(this._clientHeight=null)),this._clientHeight)}_updateActionsVisibilitiesByMode(){if(!this._withActions)return;const e=[];let t=[];const i=this._model.actions();if(1===this._rowMode)i[this._actionElements.length-1].visible.value()&&e.push(this._actionElements[this._actionElements.length-1]),t=this._actionElements.slice(0,this._actionElements.length-1);else for(let t=0;t<this._actionElements.length;t++)i[t].visible.value()&&e.push(this._actionElements[t]);t.forEach((e=>e.classList.toggle(Ae.blockHidden,!0))),e.forEach((e=>e.classList.toggle(Ae.blockHidden,!1)))}_updateTitlesVisibilitiesByMode(){}_isTitleHiddenByMode(e){const t=e.id;return 2!==t&&3!==t&&4!==t?super._isTitleHiddenByMode(e):2===t&&this._isMultipleLayout.value()?1===this._titlesMode:3!==this._titlesMode}_hideTitleAndItsContainerIfRequired(e){const t=this._getTitleIndexByDataName(e);if(-1===t)return;const i=this._titlesStatesSpawn.value()[t],s=this._titleContainers[t],l=this._titleElements[t],a=this._isTitleHiddenByMode(i);s?.classList.toggle(Ae.blockHidden,a),l?.classList.toggle(Ae.blockHidden,a)}_getButtonsCount(){return 1===this._rowMode?1:3
}_render(){super._render();const e=(0,a.ensureNotNull)(this._el);e.classList.add(xe.item,xe.series),e.classList.toggle(xe.onlyOneButtonCanBeStick,this._model.isOneButtonCanBeStick()),e.dataset.name="legend-series-item",e.setAttribute("role","toolbar")}_updateStates(){super._updateStates(),this._updateFlaggedState()}_renderValues(){const e=this._initWrappersIfNotInitialized(),t=this._values.value();for(const i of t){const t=document.createElement("div");t.dataset.testIdValueTitle=i.title.value(),t.classList.add(xe.valueItem),t.classList.toggle(Ae.blockHidden,!i.visible.value()),t.classList.toggle(xe.unimportant,i.unimportant.value());const s=document.createElement("div"),l=i.title.value()||"",a=this._customTextColor.value()||"";s.classList.add(xe.valueTitle),s.classList.toggle(Ae.blockHidden,0===l.length),s.appendChild(document.createTextNode(l)),s.style.color=a,t.appendChild(s);const o=document.createElement("div");o.classList.add(xe.valueValue),o.style.color=i.color.value()||"",o.appendChild(document.createTextNode(i.value.value())),t.appendChild(o),this._valuesElements.push({title:s,value:o}),e.appendChild(t)}}_getAttributesForTitleState(e){switch(e.id){case 0:return{titleId:"legend-source-title",className:xe.mainTitle};case 1:return{titleId:"legend-source-description",className:xe.descTitle};case 2:return{titleId:"legend-source-interval",className:xe.intervalTitle};case 3:return{titleId:"legend-source-provider",className:xe.providerTitle};case 4:return{titleId:"legend-source-exchange",className:xe.exchangeTitle};case 5:return{titleId:"legend-source-style",className:xe.styleTitle};case 6:return{titleId:"legend-source-price-source",className:xe.priceSourceTitle}}return null}_updateValuesTitleHTMLElHandler(e,t=""){const i=(0,a.ensure)(this._valuesElements[e].title);(0,m.updateTextNode)(i,t),i.classList.toggle(Ae.blockHidden,0===t.length),this._updateShowValues()}_isWidthButtonsMode(){return null!==this._el&&(void 0!==this._flagged&&Boolean(this._flagged.value())||this._linked?.value()||super._isWidthButtonsMode())}_updateFlaggedState(){if(void 0===this._flagged)return;(0,a.ensureNotNull)(this._el).classList.toggle(xe.flagged,Boolean(this._flagged.value())),this._updateTitleMaxWidth()}_getTitleIndexByDataName(e){return this._titlesStatesSpawn.value().findIndex((t=>t.id===e))}}var Oe,Fe=i(947036),Ue=i(662920),Ge=i(65300),Ze=i(736885);!function(e){e[e.Default=0]="Default",e[e.Micro=1]="Micro"}(Oe||(Oe={}));const Qe=(0,x.mergeThemes)(Z,{statusesWrap:xe.statusesWrapper__statuses});class je{constructor(e,t,i){this._wrapperTogger=null,this._el=null,this._counterEl=null,this._arrowIconEL=null,this._objectTreeEl=null,this._loader=(0,Se.createPointsLoaderRenderer)(null),this._mode=0,this._accessibleButtons=[],this._parentEl=e,this._themedColor=t.spawn(),this._themedColor.subscribe(this._updateThemedColor.bind(this)),this._showCollapserWithOneIndicator=i.showCollapserWithOneIndicator.spawn(),this._showCollapserWithOneIndicator.subscribe(this._updateVisibility.bind(this)),this._sourceCount=i.visibleDataSourceCount.spawn(),
this._sourceCount.subscribe((()=>{this._updateSourceCount(),this._updateVisibility()})),this._isStateOpen=i.isDataSourcesCollapsed.spawn(),this._isStateOpen.subscribe((()=>{this._updateState(),this._updateVisibility()})),this._isMainPane=i.isMainPane.spawn(),this._isMainPane.subscribe(this._updateObjectTreeVisibility.bind(this)),this._isPaneCollapsed=i.isPaneCollapsed.spawn(),this._isPaneCollapsed.subscribe(this._updateVisibility.bind(this)),this._combinedStatusWidgetEl=document.createElement("div"),this._combinedStatusesWidgetState=i.combinedStatusesWidgetState,this._combinedStatusesWidgetVisibility=this._combinedStatusesWidgetState.visibility().spawn(),this._combinedStatusesWidgetVisibility.subscribe(this._updateVisibility.bind(this)),this._render(),this._updateState(),this._updateVisibility(),this._updateThemedColor(this._themedColor.value()),this._updateObjectTreeVisibility(this._isMainPane.value()),this._isLoaderVisible=(0,o.combine)(((e,t)=>!e&&t[0]),this._isStateOpen.weakReference(),i.hasLoadingDataSources.weakReference()),this._isLoaderVisible.subscribe(this._loader.toggleVisibility,{callWithLast:!0}),this._toggleStateHandler=e=>{null!==this._el&&(e.cancelable&&e.preventDefault(),e instanceof KeyboardEvent||this._el?.blur(),1!==this._mode?i.onCollapseDataSources():i.onShowObjectsTreeDialog())},null!==this._el&&(this._el.addEventListener("touchend",this._toggleStateHandler),this._el.addEventListener("click",this._toggleStateHandler),this._el.addEventListener("contextmenu",(e=>{e.preventDefault(),e.stopPropagation()}))),this._updateSourceCount()}destroy(){this._isLoaderVisible.destroy(),this._loader.destroy(),this._isPaneCollapsed.destroy(),this._sourceCount.destroy(),this._isStateOpen.destroy(),this._showCollapserWithOneIndicator.destroy(),this._combinedStatusesWidgetVisibility.destroy(),this._combinedStatusesWidgetDestroy?.(),null!==this._objectTreeEl&&(this._objectTreeEl=null),this._arrowIconEL=null,this._counterEl=null,null!==this._el&&(this._el.removeEventListener("touchend",this._toggleStateHandler),this._el.removeEventListener("click",this._toggleStateHandler),this._el.innerHTML="",this._el=null)}accessibleButtons(){return null===this._el||this._el.classList.contains(xe.onlyOneSourceShown)&&1!==this._mode?[]:this._accessibleButtons}setMode(e){this._mode=e?1:0,this._updateTooltip()}_render(){this._wrapperTogger=document.createElement("div"),this._wrapperTogger.classList.add(xe.togglerWrapper),this._el=document.createElement("button"),this._el.className=`${xe.toggler} apply-common-tooltip`;const e=this._el;e.type="button",e.classList.add(xe.accessible),e.tabIndex=-1;const t=t=>{if(null!==e)switch(t.type){case"roving-tabindex:main-element":e.tabIndex=0;break;case"roving-tabindex:secondary-element":e.tabIndex=-1}};e.addEventListener("roving-tabindex:main-element",t),e.addEventListener("roving-tabindex:secondary-element",t),e.addEventListener("keydown",(e=>{const t=(0,h.hashFromEvent)(e);13!==t&&32!==t||(e.preventDefault(),this._toggleStateHandler(e))})),this._accessibleButtons.push(e),
this._arrowIconEL=document.createElement("div"),this._arrowIconEL.classList.add(xe.iconArrow),this._arrowIconEL.innerHTML=v.trackingModeIsAvailable?Ue:Fe,this._el.appendChild(this._arrowIconEL),this._objectTreeEl=document.createElement("div"),this._objectTreeEl.classList.add(xe.objectTree),this._objectTreeEl.innerHTML=v.trackingModeIsAvailable?Ze:Ge,this._el.appendChild(this._objectTreeEl),this._counterEl=document.createElement("div"),this._counterEl.classList.add(xe.counter),this._counterEl.appendChild(document.createTextNode(String(this._sourceCount.value()))),this._el.appendChild(this._counterEl),this._wrapperTogger.appendChild(this._el),this._combinedStatusWidgetEl.classList.add(xe.statusesWrapper),this._wrapperTogger.appendChild(this._combinedStatusWidgetEl),!this._isStateOpen.value()&&this._combinedStatusesWidgetVisibility.value()?this._combinedStatusesWidgetDestroy=K({container:this._combinedStatusWidgetEl,statuses:this._combinedStatusesWidgetState.visibleModels(),tooltip:this._combinedStatusesWidgetState.tooltip(),theme:Qe}):(this._combinedStatusesWidgetDestroy?.(),this._combinedStatusesWidgetDestroy=void 0),this._parentEl.appendChild(this._wrapperTogger),this._loader.mountTo(this._wrapperTogger)}_updateThemedColor(e){if(null!==this._el)if(e.length>0){const[t,i,s]=(0,u.parseRgb)(e);this._el.style.backgroundColor=(0,u.rgbaToString)([t,i,s,(0,u.normalizeAlphaComponent)(.8)])}else this._el.style.removeProperty("background-color")}_updateSourceCount(){const e=this._sourceCount.value(),t=(0,a.ensureNotNull)(this._counterEl);(0,m.updateTextNode)(t,String(e)),t.classList.toggle(Ae.blockHidden,e<=1),this._parentEl.classList.toggle(xe.saveArrowWidth,e<=1)}_updateVisibility(){const e=this._sourceCount.value(),t=(0,a.ensureNotNull)(this._el),i=1===e&&!this._showCollapserWithOneIndicator.value()&&(this._isStateOpen.value()||!this._combinedStatusesWidgetVisibility.value()),s=e<1||this._isPaneCollapsed.value()&&(this._isMainPane.value()||this._isStateOpen.value());t.classList.toggle(Ae.blockHidden,!!s),t.classList.toggle(xe.onlyOneSourceShown,i),(0,a.ensureNotNull)(this._wrapperTogger).classList.toggle(Ae.blockHidden,i),!this._isStateOpen.value()&&this._combinedStatusesWidgetVisibility.value()?this._combinedStatusesWidgetDestroy=K({container:this._combinedStatusWidgetEl,statuses:this._combinedStatusesWidgetState.visibleModels(),tooltip:this._combinedStatusesWidgetState.tooltip(),theme:Qe}):(this._combinedStatusesWidgetDestroy?.(),this._combinedStatusesWidgetDestroy=void 0)}_updateState(){const e=!this._isStateOpen.value();this._parentEl.classList.toggle(xe.closed,e),this._updateTooltip(),ne((e?"Hide":"Show")+" not main sources")}_tooltip(){if(1===this._mode)return ae.t(null,void 0,i(685786));const e=this._sourceCount.value(),t=ae.t(null,{plural:"Hide indicators legend",count:e},i(946960)),s=ae.t(null,{plural:"Show indicators legend",count:e},i(436553));return this._isStateOpen.value()?t:s}_updateTooltip(){if(null!==this._el){const e=this._tooltip();this._el.setAttribute("title",e),this._el.setAttribute("aria-label",e),
this._el.dispatchEvent(new CustomEvent("common-tooltip-update"))}}_updateObjectTreeVisibility(e){(0,a.ensureNotNull)(this._el).classList.toggle(xe.objectsTreeCanBeShown,e)}}var $e;!function(e){e[e.Medium=222]="Medium",e[e.Small=205]="Small",e[e.Tiny=133]="Tiny",e[e.HideUnimportantValues=272]="HideUnimportantValues",e[e.SeriesDirectionColumn=542]="SeriesDirectionColumn",e[e.HideExchangeIntevalProvider=442]="HideExchangeIntevalProvider",e[e.HideIntervalMultiChart=192]="HideIntervalMultiChart"}($e||($e={}));const Ke=p.enabled("object_tree_legend_mode"),qe=[27,9,37,39,38,40],Xe=(0,x.mergeThemes)(Z,{statusesWrap:xe.statusesWrapper__statuses});class Ye{constructor(e,t){this._mode=4,this._renderToggler=null,this._mainDataSourceRenderer=null,this._dataSourceRenderers=[],this._parentEl=document.createElement("div"),this._mainDataSourceEl=null,this._dataSourcesEl=null,this._dataSourcesAdditionalWrapperEl=null,this._collapsedDataSourcesWrapperEl=null,this._collapsedDataSourcesEl=null,this._outsideEventForCollapsedTooltip=null,this._onKeyboardNavigationActivationBound=this._onKeyboardNavigationActivation.bind(this),this._onIsDataSourcesCollapsedBound=this._onIsDataSourcesCollapsed.bind(this),this._focusEventAbortController=null,this._toggleHiddenActionsTimoutID=null,this._loader=(0,Se.createPointsLoaderRenderer)(null),this._toggleHiddenActions=e=>{this._toggleHiddenActionsTimoutID&&(clearTimeout(this._toggleHiddenActionsTimoutID),this._toggleHiddenActionsTimoutID=null),e?this._parentEl.classList.toggle(xe.legend_withHiddenActions,e):this._toggleHiddenActionsTimoutID=setTimeout((()=>this._parentEl.classList.toggle(xe.legend_withHiddenActions,e)),100)},this._options=e,this._togglerOptions=t,this._isStudiesLegendHidden=e.isStudiesLegendHidden.spawn(),this._isStudiesLegendHidden.subscribe(this._updateLegendVisibility.bind(this)),this._isAllLegendHidden=e.isAllLegendHidden.spawn(),this._isAllLegendHidden.subscribe(this._updateLegendVisibility.bind(this)),this._updateLegendVisibility(),this._hideAllExceptFirstLine=e.hideAllExceptFirstLine.spawn(),this._hideAllExceptFirstLine.subscribe(this._updateAllHiddenExeptFirstLine.bind(this)),this._themedColor=e.themedColor.spawn(),this._themedColor.subscribe(this._setCustomBg.bind(this)),this._showBackground=e.showBackground.spawn(),this._showBackground.subscribe(this._setCustomBg.bind(this)),this._backgroundTransparency=e.backgroundTransparency.spawn(),this._backgroundTransparency.subscribe(this._setCustomBg.bind(this)),this._collapsedDataSourcesCountSpawn=e.collapsedDataSourcesCount.spawn(),this._collapsedDataSourcesCountSpawn.subscribe(this._updateCollapsedSourcesCount.bind(this)),this._collapsedDataSourcesStatusWidgetElement=document.createElement("div"),this._collapsedStatusesWidgetState=e.combinedStatusesWidgetState,this._collapsedStatusesWidgetVisibility=this._collapsedStatusesWidgetState.visibility().spawn(),this._collapsedStatusesWidgetVisibility.subscribe((()=>this._updateCollapsedSourcesCount(this._collapsedDataSourcesCountSpawn.value()))),
this._showCollapsedDataSourcesTooltipHandler=this._showCollapsedDataSourcesTooltip.bind(this),this._parentEl.classList.add(xe.legend),this._parentEl.classList.toggle(xe.noWrap,!v.trackingModeIsAvailable),this._parentEl.classList.toggle(xe.noActions,!this._options.withActions),this._parentEl.classList.toggle(xe.touchMode,v.trackingModeIsAvailable),this._parentEl.classList.toggle(xe.wrappable,!this._hideAllExceptFirstLine.value()),this._parentEl.dataset.name="legend",this._parentEl.setAttribute("data-tooltip-show-on-focus","true"),this._parentEl.style.setProperty("--legend-source-item-button-width",`${X}px`);const i=t=>{t.preventDefault(),e.showLegendWidgetContextMenu(t)};this._mouseEventHandler=new q.MouseEventHandler(this._parentEl,{contextMenuEvent:i,touchContextMenuEvent:i}),window.addEventListener("keyboard-navigation-activation",this._onKeyboardNavigationActivationBound),this._parentEl.addEventListener("keydown",this._handleKeyDown.bind(this)),this._options.onLayoutChanged.subscribe(this,this._onLayoutChanged),this._isLoaderVisible=(0,o.combine)((e=>e[1]),e.hasLoadingDataSources.weakReference()),this._isLoaderVisible.subscribe(this._loader.toggleVisibility,{callWithLast:!0})}destroy(){this._isLoaderVisible.destroy(),this._loader.destroy(),this._focusEventAbortController?.abort();const e=document.activeElement;let t=-1;if(Ye._wasKeyboardNavigationActivated&&e instanceof HTMLButtonElement){null!==this._getRowRendererByChild(e)&&(t=(0,b.queryTabbableElements)(document.body).indexOf(e))}if(this._collapsedStatusesWidgetDestroy?.(),this._isStudiesLegendHidden.destroy(),this._isAllLegendHidden.destroy(),this._hideAllExceptFirstLine.destroy(),this._themedColor.destroy(),this._showBackground.destroy(),this._backgroundTransparency.destroy(),this._collapsedDataSourcesCountSpawn.destroy(),this._collapsedStatusesWidgetVisibility.destroy(),v.trackingModeIsAvailable&&null!==this._collapsedDataSourcesWrapperEl&&this._collapsedDataSourcesWrapperEl.removeEventListener("touchend",this._showCollapsedDataSourcesTooltipHandler),this._outsideEventForCollapsedTooltip&&this._outsideEventForCollapsedTooltip(),null!==this._dataSourcesAdditionalWrapperEl&&(this._dataSourcesAdditionalWrapperEl.innerHTML="",this._dataSourcesAdditionalWrapperEl=null),null!==this._dataSourcesEl&&(this._dataSourcesEl.innerHTML="",this._dataSourcesEl=null),this._togglerOptions.isDataSourcesCollapsed.unsubscribe(this._onIsDataSourcesCollapsedBound),null!==this._renderToggler&&(this._renderToggler.destroy(),this._renderToggler=null),null!==this._mainDataSourceRenderer&&(this._mainDataSourceRenderer.destroy(),this._mainDataSourceRenderer=null),0!==this._dataSourceRenderers.length){for(const e of this._dataSourceRenderers)e.destroy();this._dataSourceRenderers=[]}if(this._mouseEventHandler.destroy(),this._parentEl.innerHTML="",delete this._parentEl,window.removeEventListener("keyboard-navigation-activation",this._onKeyboardNavigationActivationBound),-1!==t){let e;window.dispatchEvent(new CustomEvent("keyboard-navigation-activation",{bubbles:!0}));const i=(0,
b.queryTabbableElements)(document.body);e=t===i.length?i[0]:i[t],e&&e.focus()}}addCustomWidget(e,t){if(0===t.block){this._renderMainDataSourceEl();const i=(0,a.ensureNotNull)(this._mainDataSourceEl);1===t.position&&e.renderTo(i,i.firstChild),0===t.position&&e.renderTo(i)}if(1===t.block){this._renderDataSourcesEl();const i=(0,a.ensureNotNull)(this._dataSourcesAdditionalWrapperEl);1===t.position&&e.renderTo(i,i.firstChild),0===t.position&&e.renderTo(i)}}firstTitle(){return this._parentEl.firstElementChild}getElement(){return this._parentEl}updateMode(e){const t=Ke&&e<133?1:e<205?2:e<222?3:4,i=e<192?1:e<442?2:3;this._mode=t,null!==this._mainDataSourceRenderer&&this._mainDataSourceRenderer.updateMode(t,i);for(const e of this._dataSourceRenderers)e.updateMode(t,i);this._parentEl.classList.toggle(xe.medium,3===t),this._parentEl.classList.toggle(xe.minimized,2===t),this._parentEl.classList.toggle(xe.micro,1===t),null!==this._renderToggler&&this._renderToggler.setMode(1===t);const s=!this._hideAllExceptFirstLine.value()&&(v.trackingModeIsAvailable||e<542);this._parentEl.classList.toggle(xe.directionColumn,s),this._parentEl.classList.toggle(xe.hideUniportantValueItems,!_.CheckMobile.any()&&e<=272)}getMainSourceHeight(){return null===this._mainDataSourceRenderer?0:this._mainDataSourceRenderer.getHeight()}getDataSourceHeight(){return 0===this._dataSourceRenderers.length?0:this._dataSourceRenderers[0].getHeight()}_renderMainDataSourceEl(){null===this._mainDataSourceEl&&(this._mainDataSourceEl=document.createElement("div"),this._mainDataSourceEl.classList.add(xe.legendMainSourceWrapper),this._parentEl.insertBefore(this._mainDataSourceEl,this._dataSourcesEl))}_renderDataSourcesEl(){null===this._dataSourcesEl&&(this._dataSourcesEl=document.createElement("div"),this._dataSourcesEl.classList.add(xe.sourcesWrapper),this._renderToggle(this._dataSourcesEl),this._dataSourcesAdditionalWrapperEl=document.createElement("div"),this._dataSourcesAdditionalWrapperEl.classList.add(xe.sources),this._dataSourcesEl.appendChild(this._dataSourcesAdditionalWrapperEl),this._renderCollapsedCounter(this._dataSourcesAdditionalWrapperEl),this._parentEl.appendChild(this._dataSourcesEl))}_renderToggle(e){this._options.showToggleButton&&(this._renderToggler=new je(e,this._options.themedColor,this._togglerOptions))}_onIsDataSourcesCollapsed(e){if(e){const e=this._getAllAccessibleButtons();if(0===e.filter((e=>e.tabIndex>=0)).length){const t=this._getRowRendererByChild(e[0]);t&&this._makeRowElementTheMainOne(e[0],t)}return}if(0!==(this._mainDataSourceRenderer?.accessibleButtons()||[]).filter((e=>e.tabIndex>=0)).length)return;const t=[];this._dataSourceRenderers.forEach((e=>t.push(...e.accessibleButtons())));const i=t.filter((e=>e.tabIndex>=0));if(0!==i.length){this._focusEventAbortController&&this._focusEventAbortController.abort(),i.forEach((e=>(0,g.becomeSecondaryElement)(e)));let e=null,t=null;if(this._mainDataSourceRenderer){const i=this._mainDataSourceRenderer.accessibleButtons();i.length>0&&(e=i[0],t=this._mainDataSourceRenderer)}
null===e&&this._renderToggler&&(e=this._renderToggler.accessibleButtons()[0],t=this._renderToggler),e&&t&&this._makeRowElementTheMainOne(e,t)}}_renderCollapsedCounter(e){this._collapsedDataSourcesWrapperEl=document.createElement("div"),this._collapsedDataSourcesWrapperEl.className=`${xe.item} ${xe.last}`,this._collapsedDataSourcesEl=document.createElement("span"),this._collapsedDataSourcesEl.className=`${xe.text} apply-common-tooltip`,this._collapsedDataSourcesWrapperEl.append(this._collapsedDataSourcesEl),this._collapsedDataSourcesStatusWidgetElement.classList.add(xe.statusesWrapper),this._collapsedDataSourcesWrapperEl.appendChild(this._collapsedDataSourcesStatusWidgetElement),e.append(this._collapsedDataSourcesWrapperEl),v.trackingModeIsAvailable&&this._collapsedDataSourcesWrapperEl.addEventListener("touchend",this._showCollapsedDataSourcesTooltipHandler);const t=this._collapsedDataSourcesCountSpawn.value();this._updateCollapsedSourcesCount(t),this._loader.mountTo(this._collapsedDataSourcesWrapperEl)}_showCollapsedDataSourcesTooltip(){(0,w.showOnElement)(this._collapsedDataSourcesEl,{text:this._options.collapsedDataSourcesTitle.value()}),this._addOutsideEventForHideTooltip()}_addOutsideEventForHideTooltip(){null!==this._outsideEventForCollapsedTooltip&&this._outsideEventForCollapsedTooltip(),this._outsideEventForCollapsedTooltip=(0,c.addOutsideEventListener)(new CustomEvent("timestamp").timeStamp,this._collapsedDataSourcesWrapperEl,(()=>{null!==this._outsideEventForCollapsedTooltip&&this._outsideEventForCollapsedTooltip(),(0,w.hide)()}),window.document,{touchEnd:!0})}_updateCollapsedSourcesCount(e){if(null===this._collapsedDataSourcesWrapperEl||null===this._collapsedDataSourcesEl)return;const t=0===e;this._collapsedDataSourcesWrapperEl.classList.toggle(Ae.blockHidden,t),!t&&this._collapsedStatusesWidgetVisibility.value()?this._collapsedStatusesWidgetDestroy=K({container:this._collapsedDataSourcesStatusWidgetElement,statuses:this._collapsedStatusesWidgetState.visibleModels(),tooltip:this._collapsedStatusesWidgetState.tooltip(),theme:Xe}):(this._collapsedStatusesWidgetDestroy?.(),this._collapsedStatusesWidgetDestroy=void 0),t||((0,m.updateTextNode)(this._collapsedDataSourcesEl,`+${e}`),this._collapsedDataSourcesEl.setAttribute("title",this._options.collapsedDataSourcesTitle.value()))}_updateLegendVisibility(){let e;const t=Ye._wasKeyboardNavigationActivated&&(this._isAllLegendHidden.value()||this._isStudiesLegendHidden.value());if(t){e=this._getAllAccessibleButtons().filter((e=>e.tabIndex>=0))[0]}if(this._parentEl.classList.toggle(Ae.blockHidden,this._isAllLegendHidden.value()),null!==this._dataSourcesEl&&this._dataSourcesEl.classList.toggle(Ae.blockHidden,this._isStudiesLegendHidden.value()),t){const t=this._getAllAccessibleButtons();if(e&&t.includes(e))return;if(e&&(0,g.becomeSecondaryElement)(e),0!==t.length){const e=this._getRowRendererByChild(t[0]);e&&this._makeRowElementTheMainOne(t[0],e)}}}_updateAllHiddenExeptFirstLine(){this._parentEl.classList.toggle(xe.wrappable,!this._hideAllExceptFirstLine.value())}
_setCustomBg(){const e=this._showBackground.value(),t=this._themedColor.value(),i=this._backgroundTransparency.value();let s="";if(e){const[e,l,a]=(0,u.parseRgb)(t);s=(0,u.rgbaToString)([e,l,a,(0,u.normalizeAlphaComponent)(1-i/100)])}this._parentEl.style.color=s}_onLayoutChanged(e){const{newMainSource:t,removedDataSources:i,addedDataSources:s,movedDataSources:l}=e,a=document.activeElement;let o=-1,n=-1;const r=null===this._mainDataSourceRenderer&&0===this._dataSourceRenderers.length;if(Ye._wasKeyboardNavigationActivated&&a instanceof HTMLButtonElement){const e=this._getRowRenderers(),l=e.find((e=>e.accessibleButtons().includes(a)));if(void 0!==l){const r=l===this._mainDataSourceRenderer&&null===t,d=l instanceof ze&&i.includes(this._dataSourceRenderers.indexOf(l));if(r||d){o=e.indexOf(l);const r=(0,b.queryTabbableElements)(document.body).indexOf(a);n=0!==s.length||(void 0!==t||null!==this._mainDataSourceRenderer)&&null!==t||i.length!==this._dataSourceRenderers.length&&0!==this._dataSourceRenderers.length?r+1:r}}}void 0!==t&&(null!==t?this._addMainDataSource(t.model,t.statusesWidgetState):(this._mainDataSourceRenderer?.destroy(),this._mainDataSourceRenderer=null));const d=[];if(l.forEach((e=>{d.push({renderer:this._dataSourceRenderers[e.oldIndex],newIndex:e.newIndex})})),d.sort(((e,t)=>e.newIndex-t.newIndex)),i.forEach((e=>{this._dataSourceRenderers.splice(e,1)[0].destroy()})),0!==s.length&&(this._renderDataSourcesEl(),s.forEach((e=>{this._addDataSource(e.model,e.statusesWidgetState,e.index)}))),0!==d.length&&(this._renderDataSourcesEl(),d.forEach((e=>{this._moveDataSource(e.renderer,e.newIndex)}))),Ye._wasKeyboardNavigationActivated&&r&&(null!==this._mainDataSourceRenderer||this._dataSourceRenderers.length)&&window.dispatchEvent(new CustomEvent("keyboard-navigation-activation",{bubbles:!0})),-1!==o){let e,t;const i=this._getRowRenderers();for(;o<i.length;){const s=i[o],l=s.accessibleButtons();if(l.length>0){e=l[0],t=s;break}o++}if(e&&t)this._changeFocusElement(e,t);else if(-1!==n){window.dispatchEvent(new CustomEvent("keyboard-navigation-activation",{bubbles:!0}));const t=(0,b.queryTabbableElements)(document.body);e=n===t.length?t[0]:t[n],e&&(a&&(0,g.becomeSecondaryElement)(a),e.focus())}}}_addMainDataSource(e,t){this._renderMainDataSourceEl(),this._mainDataSourceRenderer=new Ne(e,(0,a.ensureNotNull)(this._mainDataSourceEl),{withActions:this._options.withActions,customTextColor:this._options.customTextColor,statusesWidgetState:t,isMultipleLayout:this._options.isMultipleLayout,toggleHiddenActions:this._toggleHiddenActions}),this._updateLegendVisibility()}_addDataSource(e,t,i){const s=(0,a.ensureNotNull)(this._dataSourcesAdditionalWrapperEl),l=new ze(e,s,{withActions:this._options.withActions,customTextColor:this._options.customTextColor,statusesWidgetState:t,isMultipleLayout:this._options.isMultipleLayout,toggleHiddenActions:this._toggleHiddenActions}),o=(0,a.ensureNotNull)(l.getElement());if(null!==o){let e=this._dataSourceRenderers[i];void 0!==e?s.insertBefore(o,e.getElement()):(e=this._dataSourceRenderers[i-1],
void 0!==e&&s.insertBefore(o,(0,a.ensureNotNull)(e.getElement()).nextSibling))}this._dataSourceRenderers.splice(i,0,l),this._updateLegendVisibility()}_moveDataSource(e,t){const i=this._dataSourceRenderers.indexOf(e);if(-1===i||t===i)return;const s=(0,a.ensureNotNull)(this._dataSourcesAdditionalWrapperEl),l=(0,a.ensureNotNull)(e.getElement());let o=this._dataSourceRenderers[t];void 0!==o?s.insertBefore(l,o.getElement()):(o=this._dataSourceRenderers[t-1],void 0!==o&&s.insertBefore(l,(0,a.ensureNotNull)(o.getElement()).nextSibling)),this._dataSourceRenderers.splice(i,1),this._dataSourceRenderers.splice(t,0,e)}_onKeyboardNavigationActivation(){Ye._wasKeyboardNavigationActivated=!0,this._togglerOptions.isDataSourcesCollapsed.unsubscribe(this._onIsDataSourcesCollapsedBound),this._togglerOptions.isDataSourcesCollapsed.subscribe(this._onIsDataSourcesCollapsedBound);const e=this._getAllAccessibleButtons(),t=e.filter((e=>e.tabIndex>=0));if(0===t.length){const[t]=e.filter((e=>e.hasAttribute("tabIndex")));if(void 0===t)return;const i=this._getRowRendererByChild(t);if(null===i)return;this._makeRowElementTheMainOne(t,i)}if(t.length>1){const[,...e]=t;for(const t of e)(0,g.becomeSecondaryElement)(t)}}_handleKeyDown(e){if(e.defaultPrevented)return;const t=(0,h.hashFromEvent)(e);if(!qe.includes(t))return;const i=document.activeElement;if(!(i instanceof HTMLButtonElement))return;const s=this._getRowRendererByChild(i);if(null===s)return;if(27===t)return void i.blur();const l=s.accessibleButtons(),a=l.indexOf(i);if(0===l.length||-1===a)return;const o=t=>{e.preventDefault();const i=this._getRowRenderers(),l=i.indexOf(s);let a,o,n="blockNext"===t?l+1:l-1;for(;n>=0&&n<i.length;){const e=i[n],s=e.accessibleButtons();if(0!==s.length){a=e,o=s;break}n="blockNext"===t?n+1:n-1}a&&o&&this._changeFocusElement(o[0],a)},n=(0,b.mapKeyCodeToDirection)(t);switch(n){case"inlinePrev":e.preventDefault(),this._changeFocusElement(0!==a?l[a-1]:l[l.length-1],s);break;case"inlineNext":e.preventDefault(),this._changeFocusElement(a!==l.length-1?l[a+1]:l[0],s);break;case"blockPrev":case"blockNext":o(n)}}_subscribeElementToFocusEvents(e,t){this._focusEventAbortController=new AbortController,e.addEventListener("focusin",(()=>{this._focusEventAbortController=new AbortController,e.addEventListener("focusout",(i=>{const s=i.relatedTarget;null!==s&&s instanceof HTMLButtonElement&&t.accessibleButtons().includes(s)||(this._subscribeElementToFocusEvents(e,t),t instanceof je||t.hideActions())}),{once:!0,signal:this._focusEventAbortController.signal}),this._options.onLegendRowFocused(),t instanceof je||t.showActions()}),{once:!0,signal:this._focusEventAbortController.signal})}_makeRowElementTheMainOne(e,t){this._subscribeElementToFocusEvents(e,t),(0,g.becomeMainElement)(e)}_changeFocusElement(e,t){document.activeElement&&(0,g.becomeSecondaryElement)(document.activeElement),this._makeRowElementTheMainOne(e,t),e.focus()}_getRowRenderers(){let e=[];return this._mainDataSourceRenderer&&e.push(this._mainDataSourceRenderer),
this._dataSourcesEl&&!this._dataSourcesEl.classList.contains(Ae.blockHidden)&&(this._togglerOptions.isDataSourcesCollapsed.value()&&1!==this._mode&&(e=e.concat(this._dataSourceRenderers)),this._renderToggler&&0!==this._dataSourceRenderers.length&&e.push(this._renderToggler)),e}_getAllAccessibleButtons(){const e=[];return this._getRowRenderers().forEach((t=>{e.push(...t.accessibleButtons())})),e}_getRowRendererByChild(e){return this._getRowRenderers().find((t=>t.accessibleButtons().includes(e)))??null}}Ye._wasKeyboardNavigationActivated=!1;var Je=i(129914),et=i(90461),tt=i(50115),it=i(824645),st=i(51946),lt=i(306858),at=i(868333),ot=i(267624),nt=i(20154);const rt=p.enabled("show_symbol_logos")&&p.enabled("show_symbol_logo_in_legend"),dt=new nt.CircularCacheBuffer(100);class ut{constructor(e,t){this._symbolLogoUrls=new r.WatchedValue([]),this._quoteDataForLogos=null,this._logoDataUpdated=()=>{const e=this.symbol(),t=this._logoData.value();t&&e&&dt.set(e,t);const i=dt.get(e);this._quoteDataForLogos=(0,d.merge)(i??{},this._logoData.value()??{}),this._symbolLogoUrls.setValue((0,lt.removeUsdFromCryptoPairLogos)((0,lt.resolveLogoUrls)(this._quoteDataForLogos,at.LogoSize.Medium)))},this._logoModel=e,this._isLogoVisible=(0,ot.createWVFromGetterAndSubscription)((()=>t.showLogo.value()),t.showLogo),this._logoData=this._logoModel.logoData().spawn(),this._logoData.subscribe(this._logoDataUpdated,{callWithLast:!0})}destroy(){this._isLogoVisible.destroy(),this._logoModel.destroy()}isSymbolLogoVisible(){return this._isLogoVisible}symbolLogoUrls(){return this._symbolLogoUrls}symbol(){return this._logoModel.symbol()}update(){this._logoModel.update()}}function ht(e,t){return rt?new ut(e,t):null}var ct=i(148565),pt=i(671945);const _t=(0,pt.getLogger)("Chart.LegendWidget");function mt(e){const t={};for(const i of["logoid","currency-logoid","base-currency-logoid"])if(i in e){const s=i;t[s]=e[s]}return t}class gt{constructor(e){this._logoData=new r.WatchedValue(null),this._prevSymbol="",this._source=e,this._source.symbolResolved().subscribe(this,this._onSourceSymbolResolved),this.update()}destroy(){this._source.symbolResolved().unsubscribeAll(this)}symbol(){return this._source.symbol()}logoData(){return this._logoData}update(){const e=this.symbol();this._prevSymbol!==e&&(this._prevSymbol=e,this._onSourceSymbolResolved())}_onQuoteSymbolDataUpdated(e,t){const i=t.values;!this._source.symbolSameAsCurrent(e.values.pro_name)||void 0===i.logoid&&void 0===i["currency-logoid"]&&void 0===i["base-currency-logoid"]||this._logoData.setValue(mt(i))}async _onSourceSymbolChange(){const e=this.symbol();let t=null;try{this._logoData.setValue(null),t=await this._source.quotesProvider().quotesSnapshot(e)}catch(e){_t.logError(`Quote snapshot error: ${e}`)}finally{this.symbol()===e&&(null===t?this._logoData.setValue(null,!0):this._logoData.setValue(mt(t)))}}_onSourceSymbolResolved(){{const e=this._source.symbolInfo(),t=e?.logo_urls||[];if(1===t.length)return void this._logoData.setValue({logoid:t[0]});if(2===t.length)return void this._logoData.setValue({
"base-currency-logoid":t[0],"currency-logoid":t[1]});this._logoData.setValue(null,!0)}}}var bt=i(754336),vt=i(841674),wt=i(387258),St=i(645534);const yt=ae.t(null,void 0,i(437117)),ft=ae.t(null,void 0,i(44454)),Mt=ae.t(null,void 0,i(13865)),Ct=ae.t(null,void 0,i(963245)),Et=ae.t(null,void 0,i(102569)),Vt=p.enabled("legend_inplace_edit"),xt=p.enabled("show_hide_button_in_legend"),Wt=p.enabled("hide_resolution_in_legend");class Lt extends we{constructor(e,t,i,s,l){super(e,t,i,s,l),this._symbolMarker=null,this._symbolMarkerIcon=null,this._flagged=new r.WatchedValue(null),this._symbolAction=null,this._symbolForMarker=null,this._isOneButtonCanBeStick=!1,this._layoutChartSyncLegendRenderer=null,this._isChartLinked=new r.WatchedValue(!1).readonly().spawn(),this._createActions(),this._updateSymbolMarker();const a=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs();this._symbolLogoViewModel.setValue(ht(new gt(t),a)),a.showSeriesTitle.subscribe(this,(()=>{this._isTitleHidden.setValue(this._getTitleHiddenValue())})),this._isPriceSourceHidden=(0,et.createWVFromGetterAndSubscription)((()=>!a.showPriceSource.value()),a.showPriceSource),this._valuesVisibleProperty=(0,et.combineProperty)(((e,t,i,s)=>`${e}:${t}:${i}:${s}`),a.showSeriesOHLC.weakReference(),a.showBarChange.weakReference(),a.showVolume.weakReference(),a.showLastDayChange.weakReference()),this._valuesVisibleProperty.subscribe(null,(()=>{this.update(),this._isValuesHidden.setValue(this._getValuesHiddenValue())})),this.update(),this._source.statusWV().subscribe(this._updateLoadingStatus)}destroy(){super.destroy(),this._model.model().properties().childs().paneProperties.childs().legendProperties.childs().showSeriesTitle.unsubscribeAll(this),this._source.statusWV().unsubscribe(this._updateLoadingStatus),this._valuesVisibleProperty.destroy(),this._isPriceSourceHidden.destroy(),this._symbolMarker?.destroy()}flagged(){return this._flagged}linked(){return this._isChartLinked}onShowSettings(){this._source.userEditEnabled()&&this._callbacks.showGeneralChartProperties(ct.TabNames.symbol)}isOneButtonCanBeStick(){return this._isOneButtonCanBeStick}_updateTitles(){const e=(0,a.ensureNotNull)(this._source.statusView()).getSplitTitle(),t=[],i=this._getChangeSymbolCallback();let s=null;""!==(0,Je.clean)(e.title,!0)&&(s={title:(0,Je.clean)(e.title,!0),id:0,tooltip:i?Ct:void 0,onClick:i},t.push(s));const l=(0,Je.clean)(e.description,!0);""!==l&&t.push({title:l,id:1,tooltip:i?Ct:void 0,onClick:i});const o=(0,Je.clean)(e.interval,!0);if(""!==o&&!Wt){const e=this._getChangeResolutionCallback();t.push({title:o,id:2,tooltip:e?Et:void 0,onClick:e})}const n=(0,Je.clean)(e.provider,!0);""!==n&&t.push({title:n,id:3});const r=(0,Je.clean)(e.listedExchange,!0);""!==r&&t.push({title:r,id:4});const d=(0,Je.clean)(e.chartStyle,!0);""!==d&&t.push({title:d,id:5});const u=this._isPriceSourceHidden.value()?"":(0,Je.clean)(e.priceSource,!0);""!==u&&t.push({title:u,id:6}),this._titles.setValue(t)}_updateValues(){
const e=this._source.legendView(),t=this._values.value(),i=e.marketTitle(),s=e.marketTitle().length>0,l=e.items();if(0===t.length||t.length!==l.length+1){const e={value:new r.WatchedValue(""),color:new r.WatchedValue(""),visible:new r.WatchedValue(s),title:new r.WatchedValue(i),unimportant:new r.WatchedValue(!1)},t=l.map((e=>({value:new r.WatchedValue(e.value()),color:new r.WatchedValue(pe(e.color())),visible:new r.WatchedValue(e.visible()),title:new r.WatchedValue(e.title()),unimportant:new r.WatchedValue(e.unimportant())})));this._values.setValue([e].concat(t))}else{t[0].title.setValue(i),t[0].visible.setValue(s);for(let e=0;e<l.length;e++){const i=l[e];t[e+1].value.setValue(i.value()),t[e+1].color.setValue(pe(i.color())),t[e+1].visible.setValue(i.visible()),t[e+1].title.setValue(i.title())}}}_updateStates(){super._updateStates(),this._updateSymbolMarker()}_getDisabledOnIntervalState(){return!1}_getTitleHiddenValue(){return!this._model.model().properties().childs().paneProperties.childs().legendProperties.childs().showSeriesTitle.value()}_getValuesHiddenValue(){return!this._hasValues()||!this._valuesVisibleProperty.value().split(":").some((e=>"true"===e))}_getChangeSymbolCallback(){if(Vt&&!p.enabled("disable_legend_inplace_symbol_change"))return void 0===this._changeSymbolCallback&&(this._changeSymbolCallback=async()=>{const e=this._model.mainSeries(),t=e.symbol(),i=e.properties().childs().shortName.value(),s="option"===e.symbolInfo()?.type,l=e.symbolInfo()?.pro_name;let a=e.isSpread()?t:i||t||"";if(p.enabled("symbol_search_option_chain_selector")&&s&&l){const e=await resolveUnderlyingSymbol(l);e&&(a={type:"option",value:l,underlying:e})}(0,st.showDialog)({defaultValue:a,enableOptionsChain:p.enabled("symbol_search_option_chain_selector")})}),this._changeSymbolCallback}_getChangeResolutionCallback(){if(Vt&&!p.enabled("disable_legend_inplace_resolution_change"))return void 0===this._changeResolutionCallback&&(this._changeResolutionCallback=()=>{(0,it.showChangeIntervalDialogAsync)({initVal:this._model.mainSeries().interval(),selectOnInit:!0})}),this._changeResolutionCallback}_createActions(){if(xt){const e=(0,tt.convertPropertyToWatchedValue)((0,et.combineProperty)((e=>!e),this._source.properties().childs().visible.weakReference())),t={icon:new Map([["large",vt],["small",bt]]),action:(0,ee.wrapHandlerWithPreventEvent)(this.onToggleDisabled.bind(this)),visible:e,className:xe.eye,title:new r.WatchedValue(this._getEyeTitle()),dataset:{name:"legend-show-hide-action"}};this._actions.push(t),this._disabled.subscribe((()=>{t.title?.setValue(this._getEyeTitle())}))}this._actions.push({icon:new Map([["large",St],["small",wt]]),action:this._moreActionHandler.bind(this),visible:new r.WatchedValue(!0),title:new r.WatchedValue(yt),dataset:{name:"legend-more-action"}})}_getMarkerTitle(){return null!==this._symbolMarker?this._symbolMarker.isMarked()?Mt:ft:""}_symbolActionHandler(e){(0,ee.preventDefault)(e),null!==this._symbolMarker&&(this._updateSymbolMarker(),e instanceof KeyboardEvent&&this._symbolMarker.toggle(e),
ne("Change flag state"))}_updateSymbolMarker(){this._isOneButtonCanBeStick=!0}}var kt=i(515822),At=i(138054),Tt=i(31015),Bt=i(219847),Ht=i(311828),Dt=i(357092),Pt=i(583637),It=i(236791),Rt=i(34882),zt=i(337073),Nt=i(30556),Ot=i(591104);(0,pt.getLogger)("Chart.LegendWidget");const Ft=ae.t(null,void 0,i(232514)),Ut=ae.t(null,void 0,i(787142)),Gt=ae.t(null,void 0,i(767410)),Zt=ae.t(null,void 0,i(437117)),Qt=ae.t(null,void 0,i(974759)),jt=ae.t(null,void 0,i(963245)),$t=(p.enabled("study_buttons_in_legend"),p.enabled("show_hide_button_in_legend")),Kt=p.enabled("property_pages"),qt=p.enabled("format_button_in_legend"),Xt=p.enabled("delete_button_in_legend"),Yt=p.enabled("legend_inplace_edit");class Jt extends we{constructor(e,t,i,s,l){super(e,t,i,s,l),this._error=new r.WatchedValue(!1),this._isAbleShowSourceCode=new r.WatchedValue(!1),this._isAbleShowSourceCodeInner=new r.WatchedValue(!1).spawn(),this._pineAction=null,this._pineActionVisible=null,this._globalVisibility=new r.WatchedValue(!0),this._updateSymbolLogoModel(),this._createActions();const a=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs(),o=[a.showSeriesTitle,a.showStudyTitles];for(const e of o)e.subscribe(this,(()=>{this._isTitleHidden.setValue(this._getTitleHiddenValue())}));const n=[a.showSeriesOHLC,a.showBarChange,a.showStudyValues,a.showLastDayChange,a.showSeriesLegendCloseOnMobile];for(const e of n)e.subscribe(this,(()=>{this._isValuesHidden.setValue(this._getValuesHiddenValue())}));this.update()}destroy(){super.destroy();const e=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs();e.showSeriesTitle.unsubscribeAll(this),e.showStudyTitles.unsubscribeAll(this),e.showSeriesOHLC.unsubscribeAll(this),e.showBarChange.unsubscribeAll(this),e.showStudyValues.unsubscribeAll(this),e.showLastDayChange.unsubscribeAll(this),e.showSeriesLegendCloseOnMobile.unsubscribeAll(this),this._isAbleShowSourceCodeInner.destroy()}error(){return this._error.readonly()}isAbleShowSourceCode(){return this._isAbleShowSourceCode}onRemoveSource(){if(this._source.isUserDeletable()){if((0,kt.isStudy)(this._source)&&this._source.hasChildren()){const e=this._source.getAllChildren().map((e=>e.name(!0)));(0,At.showDeleteStudyTreeConfirm)(e,this._model.removeSource.bind(this._model,this._source,!1))}else this._model.removeSource(this._source,!1);ne("Remove sources")}}async onShowSourceCode(){0}setGlobalVisibility(e){this._globalVisibility.setValue(e)}globalVisibility(){return this._globalVisibility.readonly()}getFullTitle(){return this._titles.value().map((e=>ce(e)?e.items.map((e=>e.title)).join(" "):e.title)).join(" ")}getSource(){return this._source}_updateTitles(){const e=(0,a.ensureNotNull)(this._source.statusView()),t=e.getSplitTitle(),i=[],s=(0,Je.clean)(t[0],!0);if(""!==s){const t=this._getChangeSymbolCallback();i.push({title:s,id:t?8:7,tooltip:t?jt:e.titleTooltip(),onClick:t})}const l=[];(e.getInputsTitles()??[]).forEach((e=>{const t=(0,Je.clean)(e.value,!0);""!==t&&l.push({title:t,tooltip:e.title,id:9})})),
0!==l.length&&i.push({id:9,items:l}),this._titles.setValue(i)}_updateValues(){const e=this._source.legendView();if(null===e)return;if(0===e.items().length)return;const t=this._values.value();if(0===t.length){const t=e.items().map((e=>({value:new r.WatchedValue(e.value()),color:new r.WatchedValue(pe(e.color())),visible:new r.WatchedValue(e.visible()),unimportant:new r.WatchedValue(e.unimportant()),title:new r.WatchedValue(e.title())})));this._values.setValue(t)}else{const i=e.items();for(let e=0;e<i.length;e++){const s=t[e],l=i[e];s.value.setValue(l.value()),s.color.setValue(pe(l.color())),s.visible.setValue(l.visible()),s.title.setValue(l.title())}}}_updateStates(){super._updateStates(),void 0!==this._error&&this._error.setValue(Boolean(this._source.isFailed()))}_getTitleHiddenValue(){const e=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs();return this._isSymbolLikeStudy()?!e.showSeriesTitle.value():!e.showStudyTitles.value()}_getDisabledOnIntervalState(){return!(!(0,kt.isStudy)(this._source)&&!(0,kt.isStudyStub)(this._source))&&!this._source.isActualInterval()}_getValuesHiddenValue(){if(!this._hasValues())return!0;const e=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs();return this._isSymbolLikeStudy()?!e.showSeriesOHLC.value()&&!e.showBarChange.value()&&!e.showLastDayChange.value():!e.showStudyValues.value()}_isSymbolLikeStudy(){return(0,kt.isCompareOrOverlayStudy)(this._source)}_getChangeSymbolCallback(){const e=this._source;if(Yt&&(0,Bt.isSymbolSourceWithQuotesProvider)(e))return void 0===this._changeSymbolCallback&&(this._changeSymbolCallback=()=>{let t=null;const i=t=(0,Ht.loadNewSymbolSearch)().then((async s=>{if(i!==t)return;const l=e.symbol(),a=p.enabled("use_symbol_name_for_header_toolbar")?e.symbolInfo()?.name??(0,Ce.safeShortName)(l):(0,Ce.safeShortName)(l),o="spread"===e.symbolInfo()?.type,n="option"===e.symbolInfo()?.type,r=e.symbolInfo()?.pro_name;let d=o?l:a||l||"";if(p.enabled("symbol_search_option_chain_selector")&&n&&r){const e=await resolveUnderlyingSymbol(r);e&&(d={type:"option",value:r,underlying:e})}const u=(0,Dt.getSymbolSearchCompleteOverrideFunction)();s.showSymbolSearchItemsDialog({onSearchComplete:t=>{u(t[0].symbol,t[0].result).then((t=>{this._model.setSymbol(e,t.symbol)}))},dialogTitle:jt,defaultValue:d,enableOptionsChain:p.enabled("symbol_search_option_chain_selector"),showSpreadActions:p.enabled("show_spread_operators")&&p.enabled("studies_symbol_search_spread_operators")})}))}),this._changeSymbolCallback}async _updateAbleShowSourceCode(){0}_updateVisibilityPineAction(e){null!==this._pineActionVisible&&(this._pineActionVisible.setValue(e),this._isAbleShowSourceCode.setValue(e))}_createActions(){if(!this._options.readOnlyMode){if(this._pineActionVisible=new r.WatchedValue(!1),this._pineAction={icon:new Map([["large",zt],["small",Rt]]),action:(0,ee.wrapHandlerWithPreventEvent)(this.onShowSourceCode.bind(this)),disableAccessibility:!0,visible:this._pineActionVisible.readonly(),
title:new r.WatchedValue(Ut),dataset:{name:"legend-pine-action"}},$t){const e=new r.WatchedValue(!this._getDisabledOnIntervalState()),t={icon:new Map([["large",vt],["small",bt]]),action:(0,ee.wrapHandlerWithPreventEvent)(this.onToggleDisabled.bind(this)),visible:e.readonly(),className:xe.eye,title:new r.WatchedValue(this._getEyeTitle()),dataset:{name:"legend-show-hide-action"}};this._actions.push(t),this._disabled.subscribe((()=>{t.title?.setValue(this._getEyeTitle())}));const i=new r.WatchedValue(this._getDisabledOnIntervalState()),s={icon:new Map([["large",vt],["small",bt]]),action:(0,ee.wrapHandlerWithPreventEvent)(this.onShowSettings.bind(this,ct.TabNames.visibility)),visible:i.readonly(),className:xe.intervalEye,title:new r.WatchedValue(Qt),dataset:{name:"legend-interval-show-hide-action"}};this._actions.push(s),this._disabledOnInterval.subscribe((t=>{i.setValue(t),e.setValue(!t)}))}if(Kt&&qt&&(!(0,kt.isStudy)(this._source)||new Tt.MetaInfoHelper(this._source.metaInfo()).hasUserEditableOptions())){const e=new r.WatchedValue(this._getIsEditable()),t={icon:new Map([["large",It],["small",Pt]]),action:(0,ee.wrapHandlerWithPreventEvent)((()=>this.onShowSettings())),visible:e.readonly(),title:new r.WatchedValue(Ft),dataset:{name:"legend-settings-action"}};this._actions.push(t),this._isEditable.subscribe((t=>{e.setValue(t)}))}if(Xt){const e=new r.WatchedValue(this._getIsEditable()),t={icon:new Map([["large",Ot],["small",Nt]]),action:(0,ee.wrapHandlerWithPreventEvent)(this.onRemoveSource.bind(this)),visible:e.readonly(),title:new r.WatchedValue(Gt),dataset:{name:"legend-delete-action"}};this._actions.push(t),this._isEditable.subscribe((t=>{e.setValue(t)}))}this._actions.push({icon:new Map([["large",St],["small",wt]]),action:this._moreActionHandler.bind(this),visible:this._isEditable.spawn(),title:new r.WatchedValue(Zt),dataset:{name:"legend-more-action"}})}}_updateSymbolLogoModel(){if(this._symbolLogoViewModel.value()?.destroy(),p.enabled("show_symbol_logo_for_compare_studies")&&(0,Bt.isSymbolSourceWithQuotesProvider)(this._source)){const e=this._model.model().properties().childs().paneProperties.childs().legendProperties.childs(),t=ht(new gt(this._source),e);this._symbolLogoViewModel.setValue(t)}else this._symbolLogoViewModel.setValue(null)}}var ei=i(243716),ti=i(574235),ii=i(241075),si=i(514681),li=i(851310),ai=i(958933),oi=i(952285);function ni(e,t,i){e.setProperty(t,!t.value(),i)}
const ri=new oe.TranslatedString("change symbol description visibility",ae.t(null,void 0,i(288167))),di=new oe.TranslatedString("change open market status visibility",ae.t(null,void 0,i(196227))),ui=new oe.TranslatedString("change chart values visibility",ae.t(null,void 0,i(479637))),hi=new oe.TranslatedString("change last day change visibility",ae.t(null,void 0,i(66307))),ci=new oe.TranslatedString("change bar change visibility",ae.t(null,void 0,i(927426))),pi=new oe.TranslatedString("change indicator titles visibility",ae.t(null,void 0,i(463050))),_i=new oe.TranslatedString("change indicator inputs visibility",ae.t(null,void 0,i(775663))),mi=new oe.TranslatedString("change indicator values visibility",ae.t(null,void 0,i(749583))),gi=new oe.TranslatedString("change volume values visibility",ae.t(null,void 0,i(796201))),bi=new oe.TranslatedString("change symbol field visibility",ae.t(null,void 0,i(412050))),vi=ae.t(null,void 0,i(14771)),wi=ae.t(null,void 0,i(825765)),Si=ae.t(null,void 0,i(845639)),yi=ae.t(null,void 0,i(672423)),fi=ae.t(null,void 0,i(810842)),Mi=ae.t(null,void 0,i(937644)),Ci=ae.t(null,void 0,i(407511)),Ei=ae.t(null,void 0,i(233828)),Vi=ae.t(null,void 0,i(151353)),xi=ae.t(null,void 0,i(923079)),Wi=(0,li.appendEllipsis)(ae.t(null,void 0,i(232514))),Li=p.enabled("symbol_info_price_source"),ki=(e,t)=>e?e.dataset[t]?e.dataset[t]:e.parentElement?ki(e.parentElement,t):null:null;i(44258);var Ai=i(260249),Ti=i(253518);class Bi{constructor(e){this._source=e,this._fullSessionScheduleViewModel=new Ai.FullSessionScheduleViewModel(e)}destroy(){this._fullSessionScheduleViewModel.destroy()}renderer(e,t){const i=this._source.marketStatusModel()?.status().value();return"expired"===i||"delisted"===i?null:(0,S.createElement)(Ti.FullSessionScheduleRenderer,{key:e,className:t,showAllDays:void 0,sessionDays:this._fullSessionScheduleViewModel.sessionsDays,now:this._fullSessionScheduleViewModel.currentTimeValue(),timezone:this._fullSessionScheduleViewModel.timezone()})}updateSource(e){this._source=e,this._fullSessionScheduleViewModel.destroy(),this._fullSessionScheduleViewModel=new Ai.FullSessionScheduleViewModel(e)}}var Hi=i(829609),Di=i(871645),Pi=i(15735);class Ii{constructor(e){this.isBlinkingMode=new r.WatchedValue(!1),this._status=new r.WatchedValue(null),this._fullTooltip=new r.WatchedValue(null),this._iconClassNames=new r.WatchedValue(null),this._visible=new r.WatchedValue(!1),this._destroyed=!1,this._tooltip=new r.WatchedValue(null),this._icon=new r.WatchedValue(null),this._className=new r.WatchedValue(null),this._customColor=new r.WatchedValue(null),this._infoMaps=e,this._size=e.size||"small",this._status.subscribe(this._updateByStatus.bind(this),{callWithLast:!0})}destroy(){this._destroyed=!0}turnOffBlinkingMode(){}status(){return this._status}tooltip(){return this._tooltip}icon(){return this._icon}className(){return this._className}visible(){return this._visible}size(){return this._size}fullInfo(){return this._fullTooltip}customColor(){return this._customColor}_getTooltip(e){
return this._infoMaps.tooltipMap?.get(e)??null}_getIcon(e){let t;const i=this._infoMaps.iconMap.get(e);return void 0!==i&&(t=i.get(this._size)),t||null}_getClassName(e){return this._infoMaps.classNameMap.get(e)||null}_getFullTooltipIconClassNames(e){const t=this._getClassName(e);return t?[k.statusItem,t]:[]}_getTitle(e){return this._infoMaps.titleMap?.get(e)??null}_getTitleColor(e){return this._infoMaps.titleColorMap?.get(e)??null}_getAction(e){return this._infoMaps.actionMap?.get(e)??null}_getHTML(e){return this._infoMaps.htmlMap?.get(e)?.map(Di.htmlEscape)??[]}async _updateFullTooltip(){const e=this._status.value();null!==e?this._fullTooltip.setValue([{icon:this._getIcon(e),iconClassName:this._getFullTooltipIconClassNames(e),title:this._getTitle(e),titleColor:this._getTitleColor(e),html:this._getHTML(e),size:this._size,action:this._getAction(e),dataQaId:this._dataQaId()??void 0}]):this._fullTooltip.setValue(null)}_dataQaId(){return null}_updateByStatus(e){if(null===e||this._shouldBeHiddenByStatus(e))return this._icon.setValue(null),this._tooltip.setValue(null),void this._visible.setValue(!1);this._icon.setValue(this._getIcon(e)),this._className.setValue(this._getClassName(e)),this._tooltip.setValue(this._getTooltip(e)),this._visible.setValue(!0),this._updateFullTooltip()}_shouldBeHiddenByStatus(e){return!1}}var Ri=i(512646),zi=i(931233),Ni=i(55593),Oi=i(469410),Fi=i(552828),Ui=i(991665),Gi=i(839379),Zi=i(838373),Qi=i(79304),ji=i(421672),$i=i(492315);const Ki=new Map([["small",Ri],["medium",zi],["large",zi]]),qi=new Map([["small",Ni],["medium",Oi],["large",Oi]]),Xi=new Map([["small",Fi],["medium",Ui],["large",Ui]]),Yi=(new Map([["small",Gi],["medium",Gi],["large",Gi]]),new Map([["small",""],["medium",""],["large",""]]),new Map([["small",""],["medium",""],["large",""]]),new Map([["small",Zi],["medium",Qi],["large",Qi]]),new Map([["small",""],["medium",""],["large",""]]),new Map([["small",ji],["medium",$i],["large",$i]]),new Map([["small",""],["medium",""],["large",""]]),new Map([["small",""],["medium",""],["large",""]]),new Map([["small",""],["medium",""],["large",""]]),Hi.colorsPalette["color-delay-mode"]),Ji=Hi.colorsPalette["color-eod-mode"],es=Hi.colorsPalette["color-notaccurate-mode"];Hi.colorsPalette["color-primary-symbol"],Hi.colorsPalette["color-halal"],Hi.colorsPalette["color-continuous"],Hi.colorsPalette["color-data-problem"],Hi.colorsPalette["color-data-problem"],Hi.colorsPalette["color-market-expired"],Hi.colorsPalette["color-grapes-purple-400"],Hi.colorsPalette["color-ripe-red-600"],Hi.colorsPalette["color-container-fill-primary-neutral-heavy"];var ts=i(650733),is=i(212837),ss=i(748838);const ls="tv.alreadyBlinkedStatuses",as=[];function os(){return ss.getJSON(ls,as)}const ns=new r.WatchedValue(os());function rs(e){const t=ss.getJSON(ls,as);t.includes(e)||(t.push(e),ss.setJSON(ls,t),ns.setValue(os()))}ss.onSync.subscribe(null,(()=>ns.setValue(os())));const ds=ns;var us=i(460916);const hs=(0,
pt.getLogger)("Chart.LegendWidget"),cs=["TFEXDelayForGuest","MILDelayForGuest","NGMDelayForGuest","DEForGuest","ICESGDelayForGuest","TAIFEXDelayForGuest","TURQUOISEDelayForGuest","ADXDelayForGuest","TRADEGATEDelayForGuest","LUXSEDelayForGuest","NSENGDelayForGuest","FINRADelayForGuest","AQUISDelayForGuest"],ps=new Map([["DelayToRealtime",Ki],["DelayNoRealtime",Ki],["TFEXDelayForGuest",Ki],["MILDelayForGuest",Ki],["NGMDelayForGuest",Ki],["ICESGDelayForGuest",Ki],["TAIFEXDelayForGuest",Ki],["TURQUOISEDelayForGuest",Ki],["ADXDelayForGuest",Ki],["TRADEGATEDelayForGuest",Ki],["LUXSEDelayForGuest",Ki],["NSENGDelayForGuest",Ki],["FINRADelayForGuest",Ki],["AQUISDelayForGuest",Ki],["DEForGuest",Ki],["EOD",qi],["TickByTick",Xi],["BATSToRealtime",Xi],["OvernightQuotes",Xi],["DelayWithoutMarketAgreement",Ki]]),_s=new Map([["DelayToRealtime",k.delay],["DelayNoRealtime",k.delay],["TFEXDelayForGuest",k.delay],["MILDelayForGuest",k.delay],["NGMDelayForGuest",k.delay],["ICESGDelayForGuest",k.delay],["TAIFEXDelayForGuest",k.delay],["TURQUOISEDelayForGuest",k.delay],["ADXDelayForGuest",k.delay],["TRADEGATEDelayForGuest",k.delay],["LUXSEDelayForGuest",k.delay],["NSENGDelayForGuest",k.delay],["FINRADelayForGuest",k.delay],["AQUISDelayForGuest",k.delay],["DEForGuest",k.delay],["EOD",k.eod],["TickByTick",k.notAccurate],["BATSToRealtime",k.notAccurate],["OvernightQuotes",k.notAccurate],["DelayWithoutMarketAgreement",k.delay]]),ms=new Map([["DelayToRealtime",Yi],["DelayNoRealtime",Yi],["TFEXDelayForGuest",Yi],["MILDelayForGuest",Yi],["NGMDelayForGuest",Yi],["ICESGDelayForGuest",Yi],["TAIFEXDelayForGuest",Yi],["TURQUOISEDelayForGuest",Yi],["ADXDelayForGuest",Yi],["TRADEGATEDelayForGuest",Yi],["LUXSEDelayForGuest",Yi],["NSENGDelayForGuest",Yi],["FINRADelayForGuest",Yi],["AQUISDelayForGuest",Yi],["DEForGuest",Yi],["EOD",Ji],["TickByTick",es],["BATSToRealtime",es],["OvernightQuotes",es],["DelayWithoutMarketAgreement",Yi]]),gs=(ae.t(null,void 0,i(928214)),ae.t(null,void 0,i(327741)));(0,Di.htmlEscape)(ae.t(null,void 0,i(605447)));var bs;!function(e){e.TooltipSeparator="  "}(bs||(bs={}));class vs extends Ii{constructor(e,t,i){super({iconMap:ps,classNameMap:_s,titleColorMap:ms,size:t}),this._dataUpdatedInfo=new r.WatchedValue(null).spawn(),this._onMarketStatusChanged=()=>{this._updateByStatus(this.status().value())},this._options=i,this._model=e,this._dataModeBlinkingStatuses=ds.spawn(),this._dataModeBlinkingStatuses.subscribe(this._updateBlinkingMode.bind(this)),this._options.marketStatus?.subscribe(this._onMarketStatusChanged),this.turnOffBlinkingMode=this._turnOffBlinking.bind(this),this.setModel(e)}destroy(){this._dataUpdatedInfo.destroy(),this._dataModeBlinkingStatuses.destroy(),this._options.marketStatus?.unsubscribe(this._onMarketStatusChanged),this._options.marketStatus?.release(),super.destroy()}setModel(e){if(this._dataUpdatedInfo.destroy(),null===e)return this._model=e,void(this._dataUpdatedInfo=new r.WatchedValue(null).spawn());this._dataUpdatedInfo=e.status().spawn(),this._dataUpdatedInfo.subscribe(this._updateStatus.bind(this),{
callWithLast:!0})}_shouldBeHiddenByStatus(e){const t=this._options.marketStatus?.value();return"expired"===t||"delisted"===t||(!("BATSToRealtime"!==e||!this._model?.isSpread())||super._shouldBeHiddenByStatus(e))}_getTooltip(){const e=this._getShortTexts();return null===e?null:Object.values(e).join("  ")}async _updateFullTooltip(){const e=this._dataUpdatedInfo.value(),t=this._status.value();if(null===e||null===t)return void this._fullTooltip.setValue(null);const i=this._getShortTexts(),[s,l]=await Promise.all([this._getHtmls(),this._getActions()]);if(e!==this._dataUpdatedInfo.value())return;const a=[];for(const t of e){const e=t.mode;"BATSToRealtime"===e&&this._model?.isSpread()||a.push({icon:this._getIcon(e),iconClassName:this._getFullTooltipIconClassNames(e),title:i&&i[e],titleColor:this._getTitleColor(e),html:s&&s[e],size:this._size,action:l&&l[e]})}this._fullTooltip.setValue(a)}_updateStatus(e){const t=null!==e?e[0].mode:null;this._status.setValue(t??null,!0),this._updateBlinkingMode()}async _getHtmls(){const e=this._dataUpdatedInfo.value();if(null===e||null===this._model)return Promise.resolve(null);const t={},s=this._model.symbolName();let l=null;const a=this._model.listedExchange(),o=this._model.tradedExchange();try{l=await this._model.description()}catch(e){hs.logError(`Can't get exchange description, reason: ${(0,us.errorToString)(e)}`)}for(const n of e){const e=n.mode;if(t[e]=[],["DelayToRealtime","DelayNoRealtime","DelayWithoutMarketAgreement",...cs].includes(e)&&(t[e].push((0,ts.delayHtml)(s,this._model.time())),this._options.subscriptionFullInfo&&null!==l&&"DelayToRealtime"===e&&t[e].push(ts.delayToRealtimeHtml.format({description:`<b>${l}</b>`})),"DelayNoRealtime"===e&&t[e].push(ts.delayNoRealtimeHtml),"DelayWithoutMarketAgreement"===e&&t[e].push(ts.delayWithoutMarketAgreement.format({listedExchange:a})),this._options.subscriptionFullInfo&&cs.includes(e)&&t[e].push(ts.rtFreeForRegisteredUsersHtml.format({listedExchange:a}))),"EOD"===e&&(t[e]=[ts.eodHtml]),"TickByTick"===e){const s=void 0===n.updatePeriod?ts.tickByTickHtml1FullInfo:(0,Di.htmlEscape)(ae.t(null,{count:n.updatePeriod,replace:{amount:(n.updatePeriod??1).toString()},plural:"Data on our Basic plan is updated once every {amount} seconds, even if there are more updates on the market."},i(683978))),l=void 0===n.updatePeriod?ts.tickByTickHtml1:(0,Di.htmlEscape)(ae.t(null,{count:n.updatePeriod,replace:{amount:(n.updatePeriod??1).toString()},plural:"Data is updated once every {amount} seconds, even if there are more updates on the market."},i(851931)));t[e].push(this._options.subscriptionFullInfo?s:l),this._options.subscriptionFullInfo&&t[e].push(ts.tickByTickHtml2)}if(a!==o&&"BATSToRealtime"===e){const i=(0,is.isAmexToCboeMigratedSymbol)(a,this._model.proPerm());is.CRUCIAL_REALTIME_BATS.includes(o)||i?t[e].push(ts.batsToRealtimeCrucialHtml.format({exchange:i?"NYSE Arca":a,originalExchange:o})):t[e].push(ts.batsToRealtimeHtml1.format({symbolName:s,exchange:o}),""!==a?(0,Di.htmlEscape)(ts.batsToRealtimeHtml2WithExchange).format({exchange:a}):(0,
Di.htmlEscape)(ts.batsToRealtimeHtml2WithoutExchange))}"OvernightQuotes"===e&&t[e].push(ts.overnightQuotesText)}return Object.keys(t).length>0?t:null}async _getActions(){if(null===this._dataUpdatedInfo.value()||null===this._model)return null;const e={};return Object.keys(e).length>0?e:null}_showSupportDialogForUpdateMode(e){}_getShortTexts(){const e=this._dataUpdatedInfo.value();if(null===e||null===this._model)return null;const t={};for(const s of e){const e=s.mode;if(["DelayToRealtime","DelayNoRealtime",...cs,"DelayWithoutMarketAgreement"].includes(e)&&(t[e]=ts.delayTooltip),"EOD"===e&&(t[e]=ts.eodTooltip),"TickByTick"===e){const l=void 0===s.updatePeriod?ts.notAccurate1PerSecondTooltip:(0,Di.htmlEscape)(ae.t(null,{plural:"One update every {amount} seconds",count:s.updatePeriod,replace:{amount:(s.updatePeriod??1).toString()}},i(36050)));t[e]=l}if("BATSToRealtime"===e){const i=this._model.tradedExchange(),s=this._model.listedExchange();t[e]=i!==s?ts.exchangeByOriginalExchangeTooltip.format({exchange:s,originalExchange:i}):i}"OvernightQuotes"===e&&(t[e]=ts.overnightQuotesTitle)}return Object.keys(t).length>0?t:null}_updateBlinkingMode(){const e=this._dataUpdatedInfo.value();if(null===e)return;const t=this._dataModeBlinkingStatuses.value();for(const i of e)if(!t.includes(i.mode))return void this.isBlinkingMode.setValue(!0);this.isBlinkingMode.setValue(!1)}_turnOffBlinking(){const e=this._dataUpdatedInfo.value();if(null!==e)for(const t of e)rs(t.mode)}_goProDialogAction(e,t={},s){return{text:gs,onClick:()=>{null!==this._model&&createGoProDialog({forceUpgradeBtn:!0,goOnMarkets:!0,customParams:t,upgradeMessage:s||ae.t(null,void 0,i(570032)),feature:e}).then((()=>{trackEvent("Data Warning","Full description visible",e)}))}}}}const ws=ae.t(null,void 0,i(586158)),Ss=new Map([[!0,new Map([["small",Zi],["medium",Qi],["large",Qi]])],[!1,new Map([["small",""],["medium",""],["large",""]])]]),ys=new Map([[!0,k.dataProblemLow],[!1,null]]),fs=new Map([[!0,ws],[!1,null]]),Ms=new Map([[!0,ws],[!1,null]]),Cs=new Map([[!0,Hi.colorsPalette["color-data-problem"]],[!1,null]]);class Es extends Ii{constructor(e,t,i){super({iconMap:Ss,classNameMap:ys,tooltipMap:fs,titleMap:Ms,titleColorMap:Cs,size:t}),this._dataSourceErrorStatus=new r.WatchedValue(null).spawn(),this._lastError=null,this._options=i,this.setSource(e)}destroy(){this._dataSourceErrorStatus.destroy(),super.destroy()}setSource(e){this._dataSourceErrorStatus.destroy(),this._dataSourceErrorStatus=e.errorStatus().spawn(),this._dataSourceErrorStatus.subscribe(this._updateStatus.bind(this),{callWithLast:!0})}_getTooltip(e){return(e?this._getDataSourceErrorStatusCustomTitle():null)??super._getTooltip(e)}_getTitle(e){return(e?this._getDataSourceErrorStatusCustomTitle():null)??super._getTitle(e)}async _updateFullTooltip(){const e=this._status.value(),t=this._dataSourceErrorStatus.value();null!==e&&null!==t?this._fullTooltip.setValue([{icon:this._getIcon(e),iconClassName:this._getFullTooltipIconClassNames(e),title:this._getTitle(e),titleColor:this._getTitleColor(e),
html:void 0===t.stackTrace?[(0,Pi.formatStudyError)((0,Di.htmlEscape)(t.error))]:null,size:this._size,action:this._getAction(e),solutionId:this._options.errorSolution?this._dataSourceErrorStatus.value()?.solutionId:void 0,dataQaId:this._dataQaId()??void 0}]):this._fullTooltip.setValue(null)}_dataQaId(){return"data-source-error-status"}_getAction(e){return null}_updateStatus(e){const t=this._status.value();null!==e?(this._status.setValue(!0),t&&this._lastError!==e.error&&this._updateByStatus(!0),this._lastError=e.error):(this._status.setValue(null),this._lastError=null)}_getDataSourceErrorStatusCustomTitle(){return this._dataSourceErrorStatus.value()?.title||null}}const Vs=ae.t(null,void 0,i(178992)),xs=new Map([["high",new Map([["small",Zi],["medium",Qi],["large",Qi]])],["low",new Map([["small",Zi],["medium",Qi],["large",Qi]])]]),Ws=new Map([["high",k.dataProblemHigh],["low",k.dataProblemLow]]),Ls=new Map([["high",Vs],["low",Vs]]),ks=new Map([["high",Hi.colorsPalette["color-data-problem"]],["low",Hi.colorsPalette["color-data-problem"]]]);class As extends Ii{constructor(e,t){super({tooltipMap:Ls,iconMap:xs,classNameMap:Ws,titleMap:Ls,titleColorMap:ks,size:t}),this._dataProblems=new r.WatchedValue([]).spawn(),this._isDataProblemCritical=new r.WatchedValue(!1),this.setModel(e)}destroy(){this._dataProblems.destroy(),super.destroy()}isDataProblemCritical(){return this._isDataProblemCritical}setModel(e){this._dataProblems.destroy(),null!==e?(this._dataProblems=e.dataProblems().spawn(),this._dataProblems.subscribe(this._updateStatus.bind(this),{callWithLast:!0})):this._dataProblems=new r.WatchedValue([]).spawn()}async _updateFullTooltip(){const e=this.status().value(),t=this._dataProblems.value();if(null===e||0===t.length)return void this._fullTooltip.setValue(null);const i=t.map(((t,i)=>({icon:this._getIcon(e),iconClassName:this._getFullTooltipIconClassNames(e),title:t.title??(0===i?this._getTitle(e):null),titleColor:this._getTitleColor(e),html:[(0,Di.htmlEscape)(t.text)],size:this._size,action:this._getAction(e)})));this._fullTooltip.setValue(i)}_getTooltip(e){return this._getDataProblemCustomTitle()??super._getTooltip(e)}_getTitle(e){return this._getDataProblemCustomTitle()??super._getTitle(e)}_updateStatus(e){const t=e[0]?.severity??null,i=this._status.value()!==t;this._status.setValue(t),this._isDataProblemCritical.setValue(function(e){return"high"===e}(t)),i||this._updateFullTooltip()}_getDataProblemCustomTitle(){return this._dataProblems.value()?.[0]?.title||null}}class Ts extends Ii{constructor(e,t){super(t),this._booleanStatus=new r.WatchedValue(!1).spawn(),this.updateStatus(e)}destroy(){this._booleanStatus.destroy(),super.destroy()}updateStatus(e){this._booleanStatus.destroy(),this._booleanStatus=e.spawn(),this._booleanStatus.subscribe(this._updateStatus.bind(this),{callWithLast:!0})}_updateStatus(e){e?this._status.setValue(!0):this._status.setValue(null)}}
const Bs=ae.t(null,void 0,i(652969)),Hs=ae.t(null,void 0,i(453272)),Ds=new Map([[!0,new Map([["small",Zi],["medium",Qi],["large",Qi]])],[!1,new Map([["small",""],["medium",""],["large",""]])]]),Ps=new Map([[!0,k.invalidSymbol],[!1,null]]),Is=new Map([[!0,Bs],[!1,null]]),Rs=new Map([[!0,Bs],[!1,null]]),zs=new Map([[!0,Hi.colorsPalette["color-invalid-symbol"]],[!1,null]]),Ns=new Map([[!0,[Hs]],[!1,null]]),Os=new Map([[!0,null],[!1,null]]);class Fs{constructor(e,t){this.isBlinkingMode=new r.WatchedValue(!1),this._status=new r.WatchedValue(null),this._size="small",this._fullInfo=new r.WatchedValue(null),this._className=new r.WatchedValue(k.marketStatusCustom),this._symbolModel=null,this._symbol=null,this._tooltip=new r.WatchedValue(null),this._icon=new r.WatchedValue(null),this._visible=new r.WatchedValue(!1),this._color=new r.WatchedValue(null),this._updateVisibleCallback=this._updateVisible.bind(this),this._updateColorCallback=this._updateColor.bind(this),this._updateIconCallback=this._updateIcon.bind(this),this._updateTooltipCallback=this._updateTooltip.bind(this),this._updateFullInfoCallback=this._updateFullInfo.bind(this),this._model=e,this._size=t}turnOffBlinkingMode(){}destroy(){}setModel(e){this._model=e}setSymbol(e){e!==this._symbol&&(this._unSyncModel(),this._symbol=e,e?(this._symbolModel=this._model.getSymbolCustomStatus(e),this._syncModel()):this._symbolModel=null)}status(){return this._status.spawn()}tooltip(){return this._tooltip.spawn()}icon(){return this._icon.spawn()}className(){return this._className.spawn()}visible(){return this._visible.spawn()}size(){return this._size}fullInfo(){return this._fullInfo.spawn()}customColor(){return this._color.spawn()}_updateFullInfo(e){if(null===e)return void this._fullInfo.setValue(null);const t=e.map((e=>({icon:e.icon??this.icon().value(),iconClassName:[k.marketStatusCustom],title:e.title,titleColor:e.color??this.customColor().value(),html:e.content,size:this.size(),action:this._buildAction(e.action)})));this._fullInfo.setValue(t)}_buildAction(e){return e&&e.onClick?{text:e.text??"",tooltip:e.tooltip,onClick:e.onClick}:null}_unSyncModel(){this._symbolModel&&(this._symbolModel.visible().unsubscribe(this._updateVisibleCallback),this._symbolModel.color().unsubscribe(this._updateColorCallback),this._symbolModel.icon().unsubscribe(this._updateIconCallback),this._symbolModel.tooltip().unsubscribe(this._updateTooltipCallback),this._symbolModel.tooltipContent().unsubscribe(this._updateFullInfoCallback))}_syncModel(){this._visible.setValue(this._symbolModel?.visible().value()??!1),this._color.setValue(this._symbolModel?.color().value()??null),this._icon.setValue(this._symbolModel?.icon().value()??null),this._tooltip.setValue(this._symbolModel?.tooltip().value()??null),this._updateFullInfo(this._symbolModel?.tooltipContent().value()??null),this._symbolModel&&(this._symbolModel.visible().subscribe(this._updateVisibleCallback),this._symbolModel.color().subscribe(this._updateColorCallback),this._symbolModel.icon().subscribe(this._updateIconCallback),
this._symbolModel.tooltip().subscribe(this._updateTooltipCallback),this._symbolModel.tooltipContent().subscribe(this._updateFullInfoCallback))}_updateVisible(e){this._visible.setValue(e)}_updateColor(e){this._color.setValue(e)}_updateIcon(e){this._icon.setValue(e)}_updateTooltip(e){this._tooltip.setValue(e)}}var Us=i(664704),Gs=i(553218),Zs=i(732140),Qs=i(262998),js=i(725230),$s=i(315507),Ks=i(643401),qs=i(85290),Xs=i(212462);const Ys=ae.t(null,void 0,i(241410)),Js=ae.t(null,void 0,i(236018)),el=ae.t(null,void 0,i(673897)),tl=ae.t(null,void 0,i(762464)),il=ae.t(null,void 0,i(987845)),sl=ae.t(null,void 0,i(29938)),ll=ae.t(null,void 0,i(765420)),al=ae.t(null,void 0,i(23302)),ol=ae.t(null,void 0,i(452176)),nl=ae.t(null,void 0,i(741392)),rl=ae.t(null,void 0,i(59938)),dl=ae.t(null,void 0,i(299822)),ul=ae.t(null,void 0,i(266595)),hl=ae.t(null,void 0,i(63975)),cl=ae.t(null,void 0,i(681509)),pl=ae.t(null,void 0,i(758470)),_l=new Map([["market",new Map([["small",Zs],["medium",Qs],["large",Qs]])],["pre_market",new Map([["small",qs],["medium",Xs],["large",Xs]])],["post_market",new Map([["small",$s],["medium",Ks],["large",Ks]])],["out_of_session",new Map([["small",Gs],["medium",Gs],["large",Gs]])],["holiday",new Map([["small",js],["medium",js],["large",js]])]]),ml=new Map([["market",k.marketStatusOpen],["pre_market",k.marketStatusPre],["post_market",k.marketStatusPost],["out_of_session",k.marketStatusClose],["holiday",k.marketStatusHoliday]]),gl=new Map([["market",Ys],["pre_market",Js],["post_market",el],["out_of_session",tl],["holiday",il]]),bl=new Map([["market",Ys],["pre_market",Js],["post_market",el],["out_of_session",tl],["holiday",il]]),vl=new Map([["market",Hi.colorsPalette["color-market-open"]],["pre_market",Hi.colorsPalette["color-pre-market"]],["post_market",Hi.colorsPalette["color-post-market"]],["out_of_session",Hi.colorsPalette["color-market-closed"]],["holiday",Hi.colorsPalette["color-market-holiday"]]]),wl=new Map([["market",sl],["pre_market",ll],["post_market",al],["out_of_session",ol],["holiday",nl]]);const Sl=_l,yl=ml,fl=gl,Ml=bl,Cl=vl,El=wl;function Vl(e){const t=Math.floor(e/86400),s=Math.floor((e-86400*t)/3600),l=Math.floor((e-86400*t-3600*s)/60);if(0===t&&0===s&&0===l)return rl;if(t>0){const e=ae.t(null,{plural:"{number} days",count:t,replace:{number:`${t}`},context:"Market opens in n days and n hours"},i(262218)),l=ae.t(null,{plural:"{number} hours",count:s,replace:{number:`${s}`},context:"Market opens in n days and n hours"},i(165463));return ae.t(null,{replace:{days:e,hours:l}},i(451320))}if(s>0){const e=ae.t(null,{plural:"{number} hours",count:s,replace:{number:`${s}`},context:"Market opens in n hours and n minutes"},i(221730)),t=ae.t(null,{plural:"{number} minutes",count:l,replace:{number:`${l}`},context:"Market opens in n hours and n minutes"},i(782796));return ae.t(null,{replace:{hours:e,minutes:t}},i(283187))}return ae.t(null,{plural:"{number} minutes",count:l,replace:{number:`${l}`,context:"Market opens in n minutes"}},i(532547))}const xl={market:e=>("post_market"===e.status?cl:hl).format({
remainingTime:Vl(e.remainingSeconds)}),pre_market:e=>ul.format({remainingTime:Vl(e.remainingSeconds)}),post_market:e=>hl.format({remainingTime:Vl(e.remainingSeconds)}),out_of_session:e=>("pre_market"===e.status?pl:dl).format({remainingTime:Vl(e.remainingSeconds)}),holiday:e=>("pre_market"===e.status?pl:dl).format({remainingTime:Vl(e.remainingSeconds)}),delisted:e=>"",expired:e=>""},Wl=new Map([["market",null],["pre_market",null],["post_market",null],["out_of_session",null],["holiday",null],["delisted",null]]);class Ll extends Ii{constructor(e,t,i=!1){super({tooltipMap:fl,iconMap:Sl,classNameMap:yl,titleMap:Ml,titleColorMap:Cl,actionMap:Wl,size:t}),this._model=null,this._expiredStatus=null,this._marketStatus=new r.WatchedValue(null).spawn(),this._sessionEdge=new r.WatchedValue(null).spawn(),this._ignoreHideStatusSettings=i,this.setModel(e),si.showMarketOpenStatusProperty.subscribe(this,this._showMarketOpenStatusPropertyChanged)}destroy(){this._marketStatus.destroy(),this._sessionEdge.destroy(),this._model=null,si.showMarketOpenStatusProperty.unsubscribeAll(this),super.destroy()}setModel(e){if(this._marketStatus.destroy(),this._sessionEdge.destroy(),this._expiredStatus?.destroy(),null===e)return this._marketStatus=new r.WatchedValue(null).spawn(),this._sessionEdge=new r.WatchedValue(null).spawn(),void(this._expiredStatus=null);this._model=e;const t=e.futuresContractExpirationTime();t&&(this._expiredStatus=t.expired().spawn(),this._expiredStatus.subscribe((e=>{e&&this._updateByStatus(this._marketStatus.value())}))),this._marketStatus=e.status().spawn(),this._marketStatus.subscribe(this._updateStatus.bind(this),{callWithLast:!0}),this._sessionEdge=e.nextSessionEdge().spawn(),this._sessionEdge.subscribe(this._updateTooltip.bind(this)),this._updateTooltip()}async _updateFullTooltip(){const e=this.status().value();if(null===e)return void this._fullTooltip.setValue(null);const t=[],i=El.get(e);i&&t.push((0,Di.htmlEscape)(i));const s=this._marketStatus.value();if(null!==this._model&&null!==s&&"expired"!==s&&"delisted"!==s){const i=this._model.nextSessionEdge().value();null!==i&&t.push({text:xl[e](i),bold:!0})}this._fullTooltip.setValue([{icon:this._getIcon(e),iconClassName:this._getFullTooltipIconClassNames(e),title:this._getTitle(e),titleColor:this._getTitleColor(e),html:t,size:this._size,action:this._getAction(e)}])}_shouldBeHiddenByStatus(e){return!this._ignoreHideStatusSettings&&!si.showMarketOpenStatusProperty.value()&&"market"===e}_updateStatus(e){this._status.setValue(e)}_updateTooltip(){this._updateFullTooltip()}_showMarketOpenStatusPropertyChanged(){this._updateByStatus(this._status.value())}}var kl;!function(e){e.TooltipSeparator="  "}(kl||(kl={}));class Al{constructor(e){this._size=v.trackingModeIsAvailable?"medium":"small",this._statusViewModelsInfosWV=new Y.WatchedValue([]),this._visibility=new Y.WatchedValue(!1),this._options=e;const t=(0,o.combine)((e=>e.map((e=>(0,
o.combine)(((e,t,i)=>e&&t&&Boolean(i)),e.visible.weakReference(),e.model.visible().weakReference(),e.model.icon().weakReference()).ownership()))),this._statusViewModelsInfosWV.weakReference());this._visibleModels=(0,o.accumulate)(((e,t)=>t?this._statusViewModelsInfosWV.value().filter(((t,i)=>e[i]&&t||null)).filter(d.notNull).slice(0,3):[]),t.ownership(),this._visibility.weakReference(),this._statusViewModelsInfosWV.weakReference()),this._visibleModels.subscribe((()=>this._updateVisibility())),this._tooltip=(0,o.accumulate)((e=>e.filter(d.notNull).join("  ")),(0,o.combine)((e=>e.map((e=>e.model.tooltip().weakReference()))),this._visibleModels.weakReference()).ownership())}destroy(){this._visibility.unsubscribe();for(const e of this._statusViewModelsInfosWV.value()){if(e.additionalWidgets)for(const t of e.additionalWidgets)t.destroy();e.model.destroy(),e.visible.destroy()}this._visibleModels.destroy(),this._tooltip.destroy()}visibility(){return this._visibility.readonly()}visibleModels(){return this._visibleModels}tooltip(){return this._tooltip}_addStatusViewModelsInfos(e){this._statusViewModelsInfosWV.setValue([...this._statusViewModelsInfosWV.value(),e])}}class Tl extends Al{constructor(e,t,i){super(i),this.dataSourceErrorStatusShown=new r.WatchedValue(!1),this.dataUpdatedModeShown=new r.WatchedValue(!1),this.isSymbolInvalidStatusShown=new r.WatchedValue(!1),this._symbolInvalidViewModel=null,this._dataSourceErrorStatusViewModel=null,this._marketStatusViewModel=null,this._dataUpdatedModeViewModel=null,this._dataProblemViewModel=null,this._updateAvailableViewModel=null,this._alertStatusViewModel=null,this._pineEditorStateViewModel=null,this._activeStrategySourceViewModel=null,this._customStatusViewModel=null,this._sessionWidget=null,this._errorWidget=null,this._updateAvailableWidget=null,this._dataSourceHasErrorVisible=null,this._dataSourceErrorCanBeShown=new r.WatchedValue(!1),this._marketStatusCanBeShown=new r.WatchedValue(!1),this._dataUpdatedAvailableVisible=null,this._dataUpdatedModeCanBeShown=new r.WatchedValue(!1),this._dataProblemCanBeShown=new r.WatchedValue(!1),this._updateAvailableCanBeShown=new r.WatchedValue(!1),this._isDataProblemCritical=null,this._updateVisibility=()=>{const e=this._statusProviderHidden.value()&&0===this.visibleModels().value().length;this._visibility.setValue(!e)},this._source=e,this._symbol=e.symbol()?.spawn()??null,this._options=i,this._undoModel=t,this._statusProviderHidden=e.hidden().spawn(),this._statusProviderHidden.subscribe(this._updateVisibility,{callWithLast:!0}),this._createStatusesWidgetStates(),this._addSubscriptionForSymbolInvalid(),null!==this._dataSourceHasErrorVisible&&(this._dataSourceHasErrorVisible.subscribe(this._updateStatusWidgetsVisibilities.bind(this)),this._dataSourceHasErrorVisible.subscribe(this._updateErrorWidgetIsShown.bind(this))),null!==this._dataUpdatedAvailableVisible&&this._dataUpdatedAvailableVisible.subscribe(this._updateDataUpdatedWidgetIsShown.bind(this)),
this._options.dataProblemEnabled&&null!==this._isDataProblemCritical&&this._isDataProblemCritical.subscribe(this._updateStatusWidgetsVisibilities.bind(this)),this._updateErrorWidgetIsShown(),this._updateIsSymbolInvalidStatusShown(),this._updateStatusWidgetsVisibilities()}destroy(){this._statusProviderHidden.destroy(),this._visibility.unsubscribe(),this._symbol?.destroy(),this._isDataProblemCritical?.destroy(),super.destroy()}_updateStatusWidgetsVisibilities(){const e=this._isForceStatusActive();this._dataSourceErrorCanBeShown.setValue(!e),this._marketStatusCanBeShown.setValue(!e),this._dataUpdatedModeCanBeShown.setValue(!e),this._updateAvailableCanBeShown.setValue(!e),this._dataProblemCanBeShown.setValue(!this._isPrimaryWidgetShown())}_isPrimaryWidgetShown(){return this._source.isSymbolInvalid()?.value()??!1}_isForceStatusActive(){return this._isPrimaryWidgetShown()||(this._isDataProblemCritical?.value()??!1)}_createStatusesWidgetStates(){this._options.sourceStatusesEnabled&&this._createSymbolInvalidStatus(),this._options.marketStatusEnabled&&this._createMarketStatus(),this._options.dataUpdateModeEnabled&&this._createDataUpdatedModeStatus(),this._options.dataProblemEnabled&&this._createDataProblemStatus(),this._options.sourceStatusesEnabled&&this._createErrorStatus(),this._options.pineSourceStatusEnabled&&this._createScriptUpdate(),this._options.alertStatusEnabled&&this._createAlertAlertStatus(),this._options.pineSourceStatusEnabled&&this._createActiveStrategyStatus(),this._options.pineSourceStatusEnabled&&this._createPineEditorStatus(),this._createCustomMarketStatus()}_createSymbolInvalidStatus(){const e=this._source.isSymbolInvalid();null!==e&&(this._symbolInvalidViewModel=new Ts(e,{tooltipMap:Is,iconMap:Ds,classNameMap:Ps,titleMap:Rs,titleColorMap:zs,htmlMap:Ns,actionMap:Os,size:this._size}),this._addStatusViewModelsInfos({visible:this._symbolInvalidViewModel.visible().spawn(),model:this._symbolInvalidViewModel}))}_createMarketStatus(){const e=this._source.marketStatusModel();this._marketStatusViewModel=new Ll(e,this._size);const t={visible:(0,o.combine)(((e,t,i)=>e&&t&&!(0,ii.isEconomicSymbol)(i)&&!(0,ii.isSpreadSymbolWithManyLegs)(i)),this._marketStatusCanBeShown.weakReference(),this._marketStatusViewModel.visible().weakReference(),this._source.symbolInfo().weakReference()),model:this._marketStatusViewModel};null!==e&&(this._sessionWidget=new Bi(this._source),t.additionalWidgets=[this._sessionWidget]),this._addStatusViewModelsInfos(t)}_createDataUpdatedModeStatus(){const e=this._source.dataUpdatedModeModel(),t={...this._options.dataUpdateMode,marketStatus:this._source.marketStatusModel()?.status().spawnOwnership()};this._dataUpdatedModeViewModel=new vs(e,this._size,t);const i=(0,o.combine)(((e,t,i)=>e&&t&&!(0,ii.isEconomicSymbol)(i)),this._dataUpdatedModeCanBeShown.weakReference(),this._dataUpdatedModeViewModel.visible().weakReference(),this._source.symbolInfo().weakReference());this._addStatusViewModelsInfos({visible:i,model:this._dataUpdatedModeViewModel})}_createDataProblemStatus(){
const e=this._source.dataProblemModel();this._dataProblemViewModel=new As(e,this._size),this._isDataProblemCritical=this._dataProblemViewModel.isDataProblemCritical().spawn();const t=(0,o.combine)(((e,t)=>e&&t),this._dataProblemCanBeShown.weakReference(),this._dataProblemViewModel.visible().weakReference());this._addStatusViewModelsInfos({visible:t,model:this._dataProblemViewModel})}_createScriptUpdate(){}_createAlertAlertStatus(){}_createErrorStatus(){this._dataSourceErrorStatusViewModel=new Es(this._source,this._size,this._options.sourceStatuses),this._dataSourceHasErrorVisible=(0,o.combine)(((e,t,i)=>e&&t&&!i),this._dataSourceErrorCanBeShown.weakReference(),this._dataSourceErrorStatusViewModel.visible().weakReference(),this._source.hidden().weakReference());this._addStatusViewModelsInfos({visible:this._dataSourceHasErrorVisible,model:this._dataSourceErrorStatusViewModel,additionalWidgets:[]})}_createActiveStrategyStatus(){}_createPineEditorStatus(){}_createCustomMarketStatus(){if(this._source.isMainSeries?.()??!1){const e=Us.CustomStatusModel.getInstance(),t=this._symbol?.value()??null;this._customStatusViewModel=new Fs(e,this._size),this._customStatusViewModel.setSymbol(t);const i=this._customStatusViewModel.visible().spawn();this._addStatusViewModelsInfos({visible:i,model:this._customStatusViewModel})}}_addSubscriptionForSymbolInvalid(){const e=this._source.isSymbolInvalid();this._options.sourceStatusesEnabled&&null!==e&&(e.subscribe(this._updateStatusWidgetsVisibilities.bind(this)),e.subscribe(this._updateIsSymbolInvalidStatusShown.bind(this),{callWithLast:!0}))}_updateErrorWidgetIsShown(){const e=this._dataSourceHasErrorVisible?.value()??!1;this.dataSourceErrorStatusShown.setValue(e)}_updateDataUpdatedWidgetIsShown(){const e=this._dataUpdatedAvailableVisible?.value()??!1;this.dataUpdatedModeShown.setValue(e)}_updateIsSymbolInvalidStatusShown(){const e=this._source.isSymbolInvalid()?.value()??!1;this.isSymbolInvalidStatusShown.setValue(e)}}class Bl extends Tl{constructor(e,t,i){super(e,t,i),this._isInReplay=new Y.WatchedValue(!1).readonly().spawn(),this._isInReplayCanBeShown=null,this._inited=!1,this._halalCanBeShown=new Y.WatchedValue(!1),this._tvCalculatedPairCanBeShown=new Y.WatchedValue(!1),this._hkexCommentCanBeShown=new Y.WatchedValue(!1),this._defaultedBondCanBeShown=new Y.WatchedValue(!1);t.model()}destroy(){super.destroy()}_updateStatusWidgetsVisibilities(){super._updateStatusWidgetsVisibilities()}_isPrimaryWidgetShown(){return super._isPrimaryWidgetShown()||this._inited&&this._isInReplay.value()}_crateHalalStatus(){}_createDefaultedBondStatus(){}_createTVCalculatedPairStatus(){}_createHKEXCommentStatus(){}_createLetItSnowStatus(){}_createHalalTypeReleasable(){return new Y.WatchedValue(null).readonly().ownership()}_createDefaultedBondReleasable(){return new Y.WatchedValue(null).readonly().ownership()}_createTvCalculatedPairReleasable(){return new Y.WatchedValue(null).readonly().ownership()}_createHkexCommentReleasable(){return new Y.WatchedValue(null).readonly().ownership()}}var Hl,Dl=i(538007)
;!function(e){e[e.ForceDisableHiddenStateTimeoutMs=3500]="ForceDisableHiddenStateTimeoutMs"}(Hl||(Hl={}));class Pl{constructor(e,t){this._hidden=new r.WatchedValue(!1),this._symbol=null,this._isSymbolInvalid=null,this._visibilityCombiner=null,this._symbolInfo=new r.WatchedValue(null).spawn(),this._source=e,e.properties().hasChild("symbol")&&(this._symbol=(0,et.createWVFromGetterAndSubscription)((()=>e.properties().symbol.value()),e.properties().symbol.listeners()));const i=[];if((0,Dl.isStudyLineTool)(e))i.push(e.onStatusChanged());else if((0,kt.isStudy)(e)||(0,kt.isStudyStub)(e))i.push(e.onStatusChanged(),e.onIsActualIntervalChange()),this._isSymbolInvalid=(0,et.createWVFromGetterAndSubscriptions)((()=>e.isSymbolInvalid()&&e.isActualInterval()),i),(0,kt.isStudy)(e)?(this._visibilityCombiner=(0,o.combine)(((e,t)=>!e||!t),(0,et.createWVFromGetterAndSubscription)((()=>e.isVisible()),e.properties().childs().visible).ownership(),(0,et.createWVFromGetterAndSubscription)((()=>e.isActualInterval()),e.onIsActualIntervalChange()).ownership()),this._visibilityCombiner.subscribe((e=>this._hidden.setValue(e)),{callWithLast:!0})):this._hidden.setValue(!e.isVisible()||!e.isActualInterval());else{(0,a.assert)(e===t.mainSeries());const s=t.mainSeries();i.push(s.onStatusChanged()),this._isSymbolInvalid=(0,et.createWVFromGetterAndSubscriptions)((()=>s.isSymbolInvalid()),i),this._symbolInfo=(0,et.createWVFromGetterAndSubscription)(s.symbolInfo.bind(s),s.dataEvents().symbolResolved())}this._dataSourceErrorStatus=(0,et.createWVFromGetterAndSubscriptions)((()=>this._source.statusProvider({}).errorStatus()),i)}destroy(){this._symbol?.destroy(),this._isSymbolInvalid?.destroy(),this._dataSourceErrorStatus.destroy(),this._symbolInfo.destroy(),this._visibilityCombiner?.destroy()}entityId(){return this._source.id()}symbol(){return this._symbol}isSymbolInvalid(){return this._isSymbolInvalid}errorStatus(){return this._dataSourceErrorStatus}symbolInfo(){return this._symbolInfo}hidden(){return this._hidden.readonly()}marketStatusModel(){return this._source.marketStatusModel()}dataProblemModel(){return this._source.dataProblemModel()}dataUpdatedModeModel(){return this._source.dataUpdatedModeModel()}async pineSourceCodeModel(){return null}alertSourceModel(){return this._source.alertSourceModel()}isMainSeries(){return this._source.isMainSeries?.()??!1}}class Il extends Pl{constructor(e,t){super(e,t),this._quotesData=new r.WatchedValue(null),this._forceDisableHiddenState=new r.WatchedValue(!0),this._forceDisableHiddenStateTimeout=null,this._series=e,this._marketStatus=e.marketStatusModel().status().spawn(),this._marketStatus.subscribe((e=>{null===e&&(null!==this._forceDisableHiddenStateTimeout&&clearTimeout(this._forceDisableHiddenStateTimeout),this._forceDisableHiddenState.setValue(!1),this._forceDisableHiddenStateTimeout=setTimeout((()=>{this._forceDisableHiddenStateTimeout=null,this._forceDisableHiddenState.setValue(!0)}),3500))}),{callWithLast:!0}),this._dataProblems=this._series.dataProblemModel().dataProblems().spawn(),
this._marketStatus.subscribe(this._updateHiddenValue.bind(this)),this._dataProblems.subscribe(this._updateHiddenValue.bind(this)),this._forceDisableHiddenState.subscribe(this._updateHiddenValue.bind(this)),e.onStatusChanged().subscribe(this,this._updateHiddenValue),this._updateHiddenValue()}quotesData(){return this._quotesData.readonly().spawn()}destroy(){this._marketStatus.destroy(),this._dataProblems.destroy(),this._series.onStatusChanged().unsubscribeAll(this),null!==this._forceDisableHiddenStateTimeout&&clearTimeout(this._forceDisableHiddenStateTimeout),super.destroy()}_updateHiddenValue(){const e=this._series.status(),t=this._forceDisableHiddenState.value()||12===e||4===e||null!==this._marketStatus.value()&&2!==e&&1!==e||this._dataProblems.value().some((e=>"high"===e.severity));this._hidden.setValue(!t)}}const Rl=ae.t(null,void 0,i(610319)),zl=ae.t(null,void 0,i(407681)),Nl=ae.t(null,void 0,i(964730)),Ol=new Map([[!0,new Map([["small",Zi],["medium",Qi],["large",Qi]])],[!1,new Map([["small",""],["medium",""],["large",""]])]]),Fl=new Map([[!0,k.hasError],[!1,null]]),Ul=new Map([[!0,Rl],[!1,null]]),Gl=new Map([[!0,Rl],[!1,null]]),Zl=new Map([[!0,Hi.colorsPalette["color-invalid-symbol"]],[!1,null]]),Ql=new Map([[!0,[zl]],[!1,null]]),jl=new Map([[!0,[Nl]],[!1,null]]);function $l(e){switch(e){case 0:return Ql;case 1:return jl;default:throw new Error("Unknown CombinedStatusWidgetType")}}var Kl=i(302588),ql=i(257979);const Xl=ae.t(null,void 0,i(448758)),Yl=ae.t(null,void 0,i(889181)),Jl=ae.t(null,void 0,i(592663)),ea=new Map([[!0,new Map([["small",Kl],["medium",ql],["large",ql]])],[!1,new Map([["small",""],["medium",""],["large",""]])]]),ta=new Map([[!0,k.updateAvailable],[!1,null]]),ia=new Map([[!0,Xl],[!1,null]]),sa=new Map([[!0,Xl],[!1,null]]),la=new Map([[!0,Hi.colorsPalette["color-deep-blue-a400"]],[!1,null]]),aa=new Map([[!0,[Yl]],[!1,null]]),oa=new Map([[!0,[Jl]],[!1,null]]);function na(e){switch(e){case 0:return aa;case 1:return oa;default:throw new Error("Unknown CombinedStatusWidgetType")}}var ra;!function(e){e[e.Legend=0]="Legend",e[e.Items=1]="Items"}(ra||(ra={}));class da extends Al{constructor(e,t){super(t),this._dataSourceStatusWidgets=[],this._hasErrorStatus=null,this._hasUpdateStatus=null,this._hasErrorViewModel=null,this._hasUpdateViewModel=null,this._updateVisibility=()=>{const e=0===this.visibleModels().value().length;this._visibility.setValue(!e)},this._type=e}destroy(){this._hasErrorViewModel?.destroy(),this._hasUpdateViewModel?.destroy(),super.destroy()}addStatusWidget(e){this._dataSourceStatusWidgets.push(e),this._recreateHasErrorStatus(),this._recreateHasUpdateStatus(),this._createStatusesWidgetStates()}clear(){this._dataSourceStatusWidgets=[],this._hasErrorStatus?.destroy(),this._hasErrorStatus=null,this._hasUpdateStatus?.destroy(),this._hasUpdateStatus=null}async _createStatusesWidgetStates(){const e=this._hasErrorStatus;null!==e&&(null===this._hasErrorViewModel?(this._hasErrorViewModel=new Ts(e,{classNameMap:Fl,htmlMap:$l(this._type),iconMap:Ol,size:this._size,titleColorMap:Zl,titleMap:Gl,
tooltipMap:Ul}),this._addStatusViewModelsInfos({visible:this._hasErrorViewModel.visible().spawn(),model:this._hasErrorViewModel})):this._hasErrorViewModel.updateStatus(e));const t=this._hasUpdateStatus;null!==t&&(null===this._hasUpdateViewModel?(this._hasUpdateViewModel=new Ts(t,{classNameMap:ta,htmlMap:na(this._type),iconMap:ea,size:this._size,titleColorMap:la,titleMap:sa,tooltipMap:ia}),this._addStatusViewModelsInfos({visible:this._hasUpdateViewModel.visible().spawn(),model:this._hasUpdateViewModel})):this._hasUpdateViewModel.updateStatus(t))}_recreateHasErrorStatus(){this._hasErrorStatus?.destroy();const e=(0,o.combine)((e=>this._dataSourceStatusWidgets.map((e=>e.dataSourceErrorStatusShown.weakReference()))),new Y.WatchedValue(this._dataSourceStatusWidgets).weakReference());this._hasErrorStatus=(0,o.accumulate)((e=>e.some((e=>e))),e.ownership())}_recreateHasUpdateStatus(){this._hasUpdateStatus?.destroy();const e=(0,o.combine)((e=>this._dataSourceStatusWidgets.map((e=>e.dataUpdatedModeShown.weakReference()))),new Y.WatchedValue(this._dataSourceStatusWidgets).weakReference());this._hasUpdateStatus=(0,o.accumulate)((e=>e.some((e=>e))),e.ownership())}}var ua=i(103064);const ha={readOnlyMode:!1,contextMenu:{settings:!0,mainSeries:!0,studies:!0,showOpenMarketStatus:!1},symbolMarkerEnabled:!1,showToggleButton:!0,canShowSourceCode:!1,statusesWidgets:{sourceStatusesEnabled:!1,sourceStatuses:{errorSolution:!0},marketStatusEnabled:!1,marketStatus:{preMarketSolution:!0,postMarketSolution:!0},dataUpdateModeEnabled:!1,dataUpdateMode:{subscriptionFullInfo:!0},dataProblemEnabled:!1}};var ca;!function(e){e.TogglerStateSettingsKey="legend.isVisibilityToggled",e[e.TextSourceIsAlwaysTickerMaxSize=132]="TextSourceIsAlwaysTickerMaxSize"}(ca||(ca={}));p.enabled("hide_legend_by_default");const pa=p.enabled("fundamental_widget"),_a=p.enabled("legend_context_menu"),ma=2*parseInt(xe.marginlegendhoriz);class ga{constructor(e,t,i,s,a,u,h,c){this._mainSeriesViewModel=null,this._dataSourceViewModels=[],this._sourcesIds=[],this._visibleDataSourceCount=new r.WatchedValue(0),this._themedColor=new r.WatchedValue(""),this._mainSeriesRowHidden=null,this._dataSourceRowsHidden=[],this._customWidgetsVisibilities=[],this._allLegendHidden=new r.WatchedValue(!1),this._studiesLegendHidden=new r.WatchedValue(!1),this._showCollapserWithOneIndicator=new r.WatchedValue(!1),this._dataSourcesLoadingStatuses=new r.WatchedValue([]),this._customWidgetsHeights=[],this._onLegendVisibilityToggled=null,this._availableHeight=0,this._collapsedDataSourcesCount=new r.WatchedValue(0),this._collapsedDataSourcesTitle=new r.WatchedValue(""),this._mainSeriesStatusesWidgetState=null,this._dataSourceStatusesWidgetStates=[],this._statusProviders=new Map,this._size=null,this._customLegendWidgetsFactoriesMap=new Map,this._customLegendWidgetsMap=new Map,this._margin=0,this._layoutChanged=new n.Delegate,this._model=e,this._paneWidget=t,this._options=(0,d.merge)((0,d.clone)(ha),h),this._callbacks=c,this._mainSeriesViewModelsOptions={readOnlyMode:this._options.readOnlyMode,
symbolMarkerEnabled:this._options.symbolMarkerEnabled},this._dataSourceViewModelsOptions={...this._mainSeriesViewModelsOptions,canShowSourceCode:this._options.canShowSourceCode},this._backgroundThemeName=i;const p=this._showLegendCalculatedProperty();this._isDataSourcesCollapsed=new r.WatchedValue(p.value()),p.subscribe(this,(()=>{this._isDataSourcesCollapsed.setValue(p.value())}));const _=new r.WatchedValue(this._getCustomTextColorValue()),m=this._model.model().properties().childs();m.scalesProperties.childs().textColor.subscribe(this,(()=>{_.setValue(this._getCustomTextColorValue())}));const g=m.paneProperties.childs().legendProperties.childs().showBackground,b=new r.WatchedValue(g.value());g.subscribe(this,(()=>{b.setValue(g.value())}));const v=m.paneProperties.childs().legendProperties.childs().backgroundTransparency,w=new r.WatchedValue(v.value());v.subscribe(this,(()=>{w.setValue(v.value())})),this._hideNotMainSources=s,this._hideNotMainSources.subscribe(this._updateLegendVisibilities.bind(this)),this._hideAllExceptFirstLine=a,this._hideAllExceptFirstLine.subscribe(this._updateCollapsedSourcesMode.bind(this)),this._hideWholeLegend=u,this._hideWholeLegend.subscribe(this._updateLegendVisibilities.bind(this)),this._isPaneMain=new r.WatchedValue(this._getIsPaneMainValue()),this._updateCollapsedSourcesModeThrottle=(0,l.default)(this._updateCollapsedSourcesMode.bind(this),100),this._isPaneMain.subscribe((e=>this._showCollapserWithOneIndicator.setValue(e)),{callWithLast:!0}),this._collapsedStatusesWidgetState=new da(1,this._options.statusesWidgets),this._toggledStatusesWidgetState=new da(0,this._options.statusesWidgets),this._hasLoadingDataSources=(0,o.accumulate)(((e,t)=>{const i=e.some(Boolean);return[i,!!i&&e.includes(!0,-t)]}),this._dataSourcesLoadingStatuses.weakReference(),this._collapsedDataSourcesCount.weakReference()),this._renderer=new Ye({isMultipleLayout:this._model.isMultipleLayout(),withActions:!this._options.readOnlyMode,showToggleButton:this._options.showToggleButton,isStudiesLegendHidden:this._studiesLegendHidden.readonly(),isAllLegendHidden:this._allLegendHidden.readonly(),customTextColor:_.readonly(),themedColor:this._themedColor.readonly(),showBackground:b.readonly(),backgroundTransparency:w.readonly(),collapsedDataSourcesCount:this._collapsedDataSourcesCount.readonly(),collapsedDataSourcesTitle:this._collapsedDataSourcesTitle.readonly(),combinedStatusesWidgetState:this._collapsedStatusesWidgetState,showLegendWidgetContextMenu:this.onShowLegendWidgetContextMenu.bind(this),hideAllExceptFirstLine:this._hideAllExceptFirstLine,onLegendRowFocused:this._callbacks.onLegendRowFocused,onLayoutChanged:this._layoutChanged,hasLoadingDataSources:this._hasLoadingDataSources},{showCollapserWithOneIndicator:this._showCollapserWithOneIndicator.readonly(),visibleDataSourceCount:this._visibleDataSourceCount.readonly(),isDataSourcesCollapsed:this._isDataSourcesCollapsed.readonly(),hasLoadingDataSources:this._hasLoadingDataSources,isMainPane:this._isPaneMain.readonly(),
onCollapseDataSources:this.onCollapseDataSources.bind(this),onShowObjectsTreeDialog:this._callbacks.showObjectsTreeDialog,isPaneCollapsed:this._paneWidget.visuallyCollapsed(),combinedStatusesWidgetState:this._toggledStatusesWidgetState})}destroy(){this._hasLoadingDataSources.destroy(),this._backgroundThemeName.release(),this._hideNotMainSources.release(),this._hideAllExceptFirstLine.release(),this._hideWholeLegend.release(),this._sourcesIds=[],null!==this._mainSeriesViewModel&&this._destroyMainDataSource();for(const[,e]of this._statusProviders)e.destroy();for(const e of this._dataSourceViewModels)e.destroy();this._dataSourceViewModels=[],this._collapsedStatusesWidgetState.destroy(),this._toggledStatusesWidgetState.destroy();for(const e of this._dataSourceStatusesWidgetStates)e.destroy();this._dataSourceStatusesWidgetStates=[],this._clearSubscriptions();for(const e of Array.from(this._customLegendWidgetsMap.keys()))this._destroyCustomWidgetFromLayerBlock(e);this._customLegendWidgetsMap.clear(),this._renderer.destroy(),delete this._renderer,this._showLegendCalculatedProperty().unsubscribeAll(this),this._showLegendOriginalProperty().unsubscribeAll(this);const e=this._model.model().properties().childs();e.scalesProperties.childs().textColor.unsubscribeAll(this),e.paneProperties.childs().legendProperties.childs().showBackground.unsubscribeAll(this),e.paneProperties.childs().legendProperties.childs().backgroundTransparency.unsubscribeAll(this),this._dataSourcesLoadingStatuses.setValue([])}addCustomWidgetToLegend(e,t){const i=this._customLegendWidgetsFactoriesMap.get(t.block)||new Map,s=i.get(t.position)||[];s.push(e),i.set(t.position,s),this._customLegendWidgetsFactoriesMap.set(t.block,i),this.updateLayout(),this._updateCustomWidgetModeBySize()}onShowLegendWidgetContextMenu(e,t){if(this._options.readOnlyMode||!_a)return Promise.resolve();ne("Show legend context menu");const i=new Map;for(const e of Array.from(this._customLegendWidgetsMap.keys())){const t=(0,a.ensureDefined)(this._customLegendWidgetsMap.get(e)),s=new Map;for(const e of Array.from(t.keys())){const i=(0,a.ensureDefined)(t.get(e)),l=s.get(e)||[];for(const e of i)l.push(...e.contextMenuActions());s.set(e,l)}i.set(e,s)}return function(e,t,i,s,l,a){const o=[],n=s.get(0);if(void 0!==n){const e=n.get(1);void 0!==e&&e.length>0&&(o.push(...e),o.push(new ei.Separator))}const r=e.model().properties().childs().paneProperties.childs().legendProperties.childs(),d=Li&&e.model().symbolSources().some((e=>void 0!==e.symbolInfo()?.price_source_id));o.push(new ei.Action({actionId:"Chart.Legend.ToggleSymbolVisibility",options:{checkable:!0,checked:r.showSeriesTitle.value(),label:vi,statName:"Show/Hide Symbol",onExecute:()=>ni(e,r.showSeriesTitle,ri)}})),t.showOpenMarketStatus&&"market"===e.mainSeries().marketStatusModel().status().value()&&!(0,ii.isEconomicSymbol)(e.mainSeries().symbolInfo())&&o.push(new ei.Action({actionId:"Chart.Legend.ToggleOpenMarketStatusVisibility",options:{checkable:!0,checked:si.showMarketOpenStatusProperty.value(),label:wi,
statName:"Show/Hide Open market status",onExecute:()=>ni(e,si.showMarketOpenStatusProperty,di)}})),o.push(new ei.Action({actionId:"Chart.Legend.ToggleOhlcValuesVisibility",options:{checkable:!0,checked:r.showSeriesOHLC.value(),label:Si,statName:"Show/Hide chart values",onExecute:()=>ni(e,r.showSeriesOHLC,ui)}}));const u=e.mainSeries().style(),h=12!==u&&20!==u;if(h&&!ai.alwaysShowLastPriceAndLastDayChange&&o.push(new ei.Action({actionId:"Chart.Legend.ToggleBarChangeValuesVisibility",options:{checkable:!0,checked:r.showBarChange.value(),label:fi,statName:"Show/Hide Bar Change Values",onExecute:()=>ni(e,r.showBarChange,ci)}})),20!==u&&o.push(new ei.Action({actionId:"Chart.Legend.ToggleVolumeVisibility",options:{checkable:!0,checked:r.showVolume.value(),label:Mi,statName:"Show/Hide Volume",onExecute:()=>ni(e,r.showVolume,gi)}})),h&&(ai.lastDayChangeAvailable||ai.alwaysShowLastPriceAndLastDayChange)){const t=ai.alwaysShowLastPriceAndLastDayChange?r.showBarChange:r.showLastDayChange;o.push(new ei.Action({actionId:"Chart.Legend.ToggleLastDayChangeValuesVisibility",options:{checkable:!0,checked:t.value(),label:yi,statName:"Show/Hide Last day change values",onExecute:()=>ni(e,t,hi)}}))}if(d&&o.push(new ei.Action({actionId:"Chart.Legend.TogglePriceSourceVisibility",options:{checkable:!0,checked:r.showPriceSource.value(),label:xi,statName:"Show/Hide Price Source",onExecute:()=>ni(e,r.showPriceSource,bi)}})),o.push(new ei.Separator),void 0!==n){const e=n.get(0);void 0!==e&&e.length>0&&(o.push(...e),o.push(new ei.Separator))}const c=s.get(1);if(void 0!==c){const e=c.get(1);void 0!==e&&e.length>0&&(o.push(...e),o.push(new ei.Separator))}if(e.model().priceDataSources().some((e=>!(0,Bt.isActingAsSymbolSource)(e)&&e.showInObjectTree()))&&(o.push(new ei.Action({actionId:"Chart.Legend.ToggleIndicatorTitlesVisibility",options:{checkable:!0,checked:r.showStudyTitles.value(),label:Ci,statName:"Show/Hide Indicator Titles",onExecute:()=>ni(e,r.showStudyTitles,pi)}})),o.push(new ei.Action({actionId:"Chart.Legend.ToggleIndicatorArgumentsVisibility",options:{checkable:!0,checked:r.showStudyArguments.value(),label:Ei,statName:"Show/Hide Indicator Arguments",onExecute:()=>ni(e,r.showStudyArguments,_i)}})),o.push(new ei.Action({actionId:"Chart.Legend.ToggleIndicatorValuesVisibility",options:{checkable:!0,checked:r.showStudyValues.value(),label:Vi,statName:"Show/Hide Indicator Values",onExecute:()=>ni(e,r.showStudyValues,mi)}}))),void 0!==c){const e=c.get(0);void 0!==e&&e.length>0&&(o.push(...e),o.push(new ei.Separator))}t.settings&&(o[o.length-1]instanceof ei.Separator||o.push(new ei.Separator),o.push(new oi.ActionWithStandardIcon({actionId:"Chart.Dialogs.ShowGeneralSettings.LegendTab",options:{label:Wi,iconId:"Settings",statName:"Settings...",onExecute:()=>i(ct.TabNames.legend)}})));const p=ki(l.target,"entityId"),_={menuName:"LegendPropertiesContextMenu",detail:{type:p?"study":"series",id:p??"_seriesId"}};return ti.ContextMenuManager.showMenu(o,l,{statName:"LegendContextMenu"},_,a)
}(this._model,this._options.contextMenu,this._callbacks.showGeneralChartProperties,i,e,t)}onCollapseDataSources(){const e=this._showLegendOriginalProperty();e.setValue(!e.value())}updateLayout(){const e=this._paneWidget.state().sourcesByGroup().legendViewSources().filter((e=>null!==e.statusView()&&e.isDisplayedInLegend())).reverse(),t=this._sourcesIds,i=this._model.mainSeries(),s=e.indexOf(i);let l;if(-1!==s){if(e.splice(s,1),!pa&&null===this._mainSeriesViewModel){const e=new Lt(this._model,i,this._mainSeriesViewModelsOptions,this._callbacks,this._options.contextMenu);this._mainSeriesViewModel=e;const t=new Bl(this._statusSourceAdapter(i),this._model,this._options.statusesWidgets);this._mainSeriesStatusesWidgetState=t,l={model:e,statusesWidgetState:t}}}else null!==this._mainSeriesViewModel&&(l=null,this._destroyMainDataSource(),this._destroyCustomWidgetFromLayerBlock(0));const o=e.map((e=>e.instanceId()));this._sourcesIds=o;const n=[],r=new Map,d=[],u=[],h=this._dataSourceViewModels,c=this._dataSourceStatusesWidgetStates;let p=t.length-1;for(;p>=0;){const e=t[p],i=o.indexOf(e);if(-1===i){n.push(p),h[p].destroy(),c[p].destroy();const t=this._statusProviders.get(e);t&&(t.destroy(),this._statusProviders.delete(e))}else p!==i&&(r.set(e,{model:h[p],statusesWidgetState:c[p]}),d.push({oldIndex:p,newIndex:i}));p--}const _=[],m=[];for(let i=0;i<o.length;i++){const s=o[i];let l,n;if(r.has(s)){const e=(0,a.ensureDefined)(r.get(s));l=e.model,n=e.statusesWidgetState}else if(t[i]===s)l=h[i],n=c[i];else{const t=e[i];l=new Jt(this._model,t,this._dataSourceViewModelsOptions,this._callbacks,this._options.contextMenu),n=new Tl(this._statusSourceAdapter(t),this._model,this._options.statusesWidgets),u.push({model:l,statusesWidgetState:n,index:i})}_.push(l),m.push(n)}this._dataSourceViewModels=_,this._dataSourceStatusesWidgetStates=m,0===this._dataSourceViewModels.length&&this._destroyCustomWidgetFromLayerBlock(1),this._dataSourceViewModels.length&&this._recalculateLoadingDataSources(),this._recreateSubscriptions(),this._isPaneMain.setValue(this._getIsPaneMainValue()),this.update();const g=n.length||u.length||d.length;if((void 0!==l||g)&&this._layoutChanged.fire({newMainSource:l,removedDataSources:n,addedDataSources:u,movedDataSources:d}),-1!==s&&this._addCustomWidgetForLayerBlock(0),this._dataSourceViewModels.length>0&&this._addCustomWidgetForLayerBlock(1),this._updateWidgetModeBySize(),g){this._updateCollapsedSourcesMode(),this._toggledStatusesWidgetState.clear();for(const e of this._dataSourceStatusesWidgetStates)this._toggledStatusesWidgetState.addStatusWidget(e)}}update(){null!==this._mainSeriesViewModel&&this._mainSeriesViewModel.update();for(const e of this._dataSourceViewModels)e.update()}updateThemedColors(e){null===e&&(e=(0,ua.getStdThemedValue)("chartProperties.paneProperties.background",this._backgroundThemeName.value())),this._themedColor.setValue(e||"")}firstTitle(){return this._renderer.firstTitle()}getElement(){return this._renderer.getElement()}addMargin(e){if(this._margin===e)return;this._margin=e
;this._renderer.getElement().style.maxWidth=0===this._margin?"":`calc(100% - ${this._margin+ma}px)`,this._updateWidgetModeBySize()}updateWidgetModeBySize(e){this._size=e,this._updateWidgetModeBySize()}_statusSourceAdapter(e){const t=e.instanceId();let i=this._statusProviders.get(t);return void 0===i&&(i=e!==this._model.mainSeries()?new Pl(e,this._model.model()):new Il(this._model.mainSeries(),this._model.model()),this._statusProviders.set(t,i)),i}_updateWidgetModeBySize(){this._updateWidgetModeByWidth(),this._updateWidgetModeByHeight(),this._updateCustomWidgetModeBySize()}_updateWidgetModeByWidth(){if(null===this._size)return;const e=this._availableWidth();this._renderer.updateMode(e),this._paneWidget.hasState()&&this._paneWidget.state().containsMainSeries()&&this._model.mainSeries().setTextSourceIsAlwaysTickerRestrictionEnabled(e<=132)}_updateWidgetModeByHeight(){null!==this._size&&(this._availableHeight=.8*this._size.height,this._updateCollapsedSourcesModeThrottle())}_updateCustomWidgetModeBySize(){if(null===this._size)return;const e=(0,s.size)({width:this._availableWidth(),height:this._size.height});for(const t of Array.from(this._customLegendWidgetsMap.values()))for(const i of Array.from(t.values()))for(const t of i)t.updateWidgetModeBySize(e)}_destroyMainDataSource(){(0,a.ensureNotNull)(this._mainSeriesStatusesWidgetState).destroy(),this._mainSeriesStatusesWidgetState=null;(0,a.ensureNotNull)(this._mainSeriesViewModel).destroy(),this._mainSeriesViewModel=null}_updateCollapsedSourcesMode(){const e=this._dataSourceViewModels.length,t=this._hideAllExceptFirstLine.value(),i=null!==this._mainSeriesViewModel;if(this._collapsedStatusesWidgetState.clear(),this._availableHeight>0&&e>2){const s=Number(this._renderer.getMainSourceHeight()),l=this._renderer.getDataSourceHeight(),a=this._getCustomWidgetsHeight();if(null!==l){const o=Math.floor((this._availableHeight-s-a)/l),n=Math.max(o,2)-1;if(e>n+1){let s="";for(let l=0;l<e;l++){const e=l<n;this._dataSourceViewModels[l].setGlobalVisibility(e&&(!t||0===l&&!i)),e||(s+=`${0===s.length?"":", "}${this._dataSourceViewModels[l].getFullTitle()}`,this._collapsedStatusesWidgetState.addStatusWidget(this._dataSourceStatusesWidgetStates[l]))}return this._collapsedDataSourcesTitle.setValue(s),void this._collapsedDataSourcesCount.setValue(e-n)}}}for(let e=0;e<this._dataSourceViewModels.length;++e)this._dataSourceViewModels[e].setGlobalVisibility(!t||0===e&&!i);this._collapsedDataSourcesCount.setValue(0),this._collapsedDataSourcesTitle.setValue("")}_getCustomWidgetsHeight(){let e=0;for(const t of Array.from(this._customLegendWidgetsMap.values()))for(const i of Array.from(t.values()))for(const t of i)e+=t.height().value();return e}_getCustomTextColorValue(){const e=this._model.model().properties().childs().scalesProperties.childs().textColor.value();for(const t of(0,ua.getStdThemeNames)())if((0,ua.isStdThemedDefaultValue)("chartProperties.scalesProperties.textColor",e,t))return null;return e}_clearSubscriptions(){null!==this._mainSeriesRowHidden&&(this._mainSeriesRowHidden.destroy(),
this._mainSeriesRowHidden=null);for(const e of this._dataSourceRowsHidden)e.destroy();this._dataSourceRowsHidden=[];for(const e of this._customWidgetsVisibilities)e.destroy();this._customWidgetsVisibilities=[];for(const e of this._customWidgetsHeights)e.destroy();this._customWidgetsHeights=[]}_recreateSubscriptions(){this._clearSubscriptions(),null!==this._mainSeriesViewModel&&(this._mainSeriesRowHidden=this._mainSeriesViewModel.isRowHidden().spawn(),this._mainSeriesRowHidden.subscribe(this._updateLegendVisibilities.bind(this)));for(const e of this._dataSourceViewModels){const t=e.isRowHidden().spawn();this._dataSourceRowsHidden.push(t),t.subscribe(this._updateVisibleDataSourceCount.bind(this)),t.subscribe(this._updateLegendVisibilities.bind(this))}for(const e of Array.from(this._customLegendWidgetsMap.values()))for(const t of Array.from(e.values()))for(const e of t){const t=e.visibility().spawn();this._customWidgetsVisibilities.push(t),t.subscribe(this._updateLegendVisibilities.bind(this));const i=e.height().spawn();this._customWidgetsHeights.push(i),i.subscribe(this._updateCollapsedSourcesMode.bind(this))}this._updateVisibleDataSourceCount(),this._updateLegendVisibilities()}_recalculateLoadingDataSources(){this._dataSourcesLoadingStatuses.setValue(this._dataSourceViewModels.map((e=>e.loading().weakReference())))}_updateLegendVisibilities(){if(this._hideWholeLegend.value())return void this._allLegendHidden.setValue(!0);const e=0!==this._dataSourceRowsHidden.length&&this._dataSourceRowsHidden.every((e=>e.value())),t=this._hideNotMainSources.value()||e;this._studiesLegendHidden.setValue(t);const i=null===this._mainSeriesRowHidden||this._mainSeriesRowHidden.value(),s=this._customWidgetsVisibilities.some((e=>e.value()));this._allLegendHidden.setValue(e&&i&&!s)}_updateVisibleDataSourceCount(){const e=this._dataSourceRowsHidden.filter((e=>!e.value())).length;this._visibleDataSourceCount.setValue(e)}_setLegendVisibilityToggled(){0}_getIsPaneMainValue(){return this._paneWidget.containsMainSeries()}_showLegendCalculatedProperty(){return this._model.model().showLegend()}_showLegendOriginalProperty(){return this._model.model().properties().childs().paneProperties.childs().legendProperties.childs().showLegend}_addCustomWidgetForLayerBlock(e){const t=this._customLegendWidgetsFactoriesMap.get(e);if(void 0===t)return;const i=this._customLegendWidgetsMap.get(e)||new Map;let s=!1;for(const l of Array.from(t.keys())){const a=i.get(l)||[],o=t.get(l)||[];for(let t=a.length;t<o.length;t++){const i=o[t](this._model.model(),this._backgroundThemeName.spawnOwnership(),this._hideAllExceptFirstLine.weakReference());a.push(i),this._renderer.addCustomWidget(i,{block:e,position:l}),s=!0}s&&i.set(l,a)}s&&this._customLegendWidgetsMap.set(e,i)}_destroyCustomWidgetFromLayerBlock(e){const t=this._customLegendWidgetsMap.get(e);if(void 0!==t){for(const e of Array.from(t.values()))for(const t of e)t.destroy();t.clear(),this._customLegendWidgetsMap.delete(e)}}_availableWidth(){return null===this._size?0:Math.max(0,this._size.width-this._margin-ma)}}},
497560:(e,t,i)=>{"use strict";i.d(t,{reactLoaderRendererCreator:()=>o});var s=i(904237),l=i(50959),a=i(233465);function o(e,t){return(i,o)=>function(e,t,i,o){const n=document.createElement("span"),r=(0,s.createRoot)(n);u(!1);const{className:d}=o??{};return d&&n.classList.add(d),r.render((0,l.createElement)(t,i)),e&&h(e),{toggleVisibility:u,destroy:function(){r.unmount()},mountTo:h};function u(e){n.classList.toggle(a.blockHidden,!e)}function h(e){e.appendChild(n)}}(i,e,t,o)}},903963:(e,t,i)=>{"use strict";i.d(t,{createPointsLoaderRenderer:()=>l});var s=i(234404);const l=(0,i(497560).reactLoaderRendererCreator)(s.Loader,{staticPosition:!0,size:"small"})},973745:(e,t,i)=>{"use strict";i.r(t),i.d(t,{PaneControlsWidget:()=>q});var s,l=i(32133),a=i(609838),o=i(180185),n=i(780284),r=i(603061),d=i(515822),u=i(650151),h=i(724377),c=i(314913),p=i(972535),_=i(175472),m=i(244784),g=i(233465);!function(e){e[e.ContextMenuModeWidthPt=666.65]="ContextMenuModeWidthPt",e[e.VisibleModeMinWidth=356]="VisibleModeMinWidth"}(s||(s={}));class b{constructor(e,t,i){this._parentEl=document.createElement("div"),this._listActionsWrapperEl=null,this._listActionsElements={},this._actionsSpawns={},this._onMouseEnterLeaveEventHandler=null,this._mouseOverWidget=!1,this._wrapEl=e,this._onMouseEnterLeaveEventHandler=this._onMouseEnterLeaveEvent.bind(this),this._wrapEl.addEventListener("mouseenter",this._onMouseEnterLeaveEventHandler),this._wrapEl.addEventListener("mouseleave",this._onMouseEnterLeaveEventHandler),this._actions=t,this._globalVisibility=i.globalVisibility.spawn(),this._globalVisibility.subscribe(this._updatePaneControlsWidgetVisibility.bind(this)),this._visibilityType=i.visibilityType.spawn(),this._visibilityType.subscribe(this._updatePaneControlsWidgetVisibility.bind(this)),this._separatorSelected=i.separatorSelected.spawn(),this._separatorSelected.subscribe(this._updatePaneControlsWidgetVisibility.bind(this)),this._maximized=i.maximized.spawn(),this._maximized.subscribe(this._updatePaneControlsWidgetVisibility.bind(this)),this._doNotSwitchToContextMenuMode=i.doNotSwitchToContextMenuMode,this._themedColor=i.themedColor.spawn(),this._themedColor.subscribe(this._updateThemedColor.bind(this));for(const[e,t]of Object.entries(this._actions)){const i=e;this._actionsSpawns[i]={visible:t.visible.spawn(),title:void 0===t.title?null:t.title.spawn()},this._actionsSpawns[i].visible.subscribe(this._updateActionVisibilities.bind(this,i));const s=this._actionsSpawns[i].title;null!==s&&s.subscribe(this._updateActionTitle.bind(this,i))}this._render(),this._updatePaneControlsWidgetVisibility(),this._updateThemedColor(this._themedColor.value()),this._parentEl.classList.toggle(m.touchMode,_.trackingModeIsAvailable),this._parentEl.addEventListener("contextmenu",(e=>e.preventDefault())),this._parentEl.setAttribute("aria-hidden","true"),this._wrapEl.matches(":hover")&&this._onMouseEnterLeaveEvent({type:"mouseenter"})}destroy(){this._visibilityType.destroy(),this._themedColor.destroy(),this._separatorSelected.destroy()
;for(const e of Object.keys(this._actionsSpawns)){const t=e;this._actionsSpawns[t].visible.destroy();const i=this._actionsSpawns[t].title;null!==i&&i.destroy()}null!==this._onMouseEnterLeaveEventHandler&&(this._wrapEl.removeEventListener("mouseenter",this._onMouseEnterLeaveEventHandler),this._wrapEl.removeEventListener("mouseleave",this._onMouseEnterLeaveEventHandler),this._onMouseEnterLeaveEventHandler=null),this._parentEl.remove(),this._parentEl.innerHTML="",delete this._parentEl}getElement(){return this._parentEl}bottomWithMargin(){const e=this._parentEl.classList.contains(m.touchMode)?Number(m.css_value_pane_controls_button_touch_size):Number(m.css_value_pane_controls_button_size);return 2*Number(m.css_value_pane_controls_margin_top)+e}updateWidgetModeByWidth(e){const t=!this._doNotSwitchToContextMenuMode.value()&&e<356,i=!this._doNotSwitchToContextMenuMode.value()&&e<666.65,s=(0,u.ensureNotNull)(this._listActionsWrapperEl),l=(0,u.ensureNotNull)(this._listActionsElements.more);s.classList.toggle(g.blockHidden,t||i),l.classList.toggle(g.blockHidden,t||!i||!this._actions.more.visible.value())}_render(){this._renderActions(),this._parentEl.classList.add(m.paneControls),this._wrapEl.append(this._parentEl)}_renderActions(){null===this._listActionsWrapperEl&&(this._listActionsWrapperEl=document.createElement("div"),this._listActionsWrapperEl.classList.add(m.buttons),this._parentEl.append(this._listActionsWrapperEl));const e={tag:"div",buttonClassName:m.button,wrapIconClassName:m.buttonIcon,hiddenClassName:g.blockHidden};this._listActionsElements.up=(0,c.createActionElement)(this._actions.up,e),this._listActionsElements.down=(0,c.createActionElement)(this._actions.down,e),this._listActionsElements.collapse=(0,c.createActionElement)(this._actions.collapse,e),this._listActionsElements.restore=(0,c.createActionElement)(this._actions.restore,e),this._listActionsElements.close=(0,c.createActionElement)(this._actions.close,e),this._listActionsElements.maximize=(0,c.createActionElement)(this._actions.maximize,e),this._listActionsElements.minimize=(0,c.createActionElement)(this._actions.minimize,e),this._listActionsElements.restore.classList.add(m.button_activated),this._listActionsElements.minimize.classList.add(m.button_activated),this._listActionsWrapperEl.append(this._listActionsElements.up,this._listActionsElements.down,this._listActionsElements.close,this._listActionsElements.collapse,this._listActionsElements.restore,this._listActionsElements.maximize,this._listActionsElements.minimize),this._listActionsElements.more=(0,c.createActionElement)(this._actions.more,e),this._parentEl.append(this._listActionsElements.more)}_updateActionVisibilities(e,t){(0,u.ensureNotNull)(this._listActionsElements[e]).classList.toggle(g.blockHidden,!t)}_updateActionTitle(e,t){(0,u.ensureNotNull)(this._listActionsElements[e]).setAttribute("title",t)}_onMouseEnterLeaveEvent(e){this._mouseOverWidget="mouseenter"===e.type,"visibleOnMouseOver"===this._visibilityType.value()&&this._updatePaneControlsWidgetVisibility()}
_updatePaneControlsWidgetVisibility(){let e,t=!1;switch(this._visibilityType.value()){case"alwaysOff":e=!1,t=!0;break;case"alwaysOn":e=this._globalVisibility.value();break;case"visibleOnMouseOver":case"visibleOnTapSelection":e=this._globalVisibility.value()&&this._mouseOverWidget}this._separatorSelected.value()&&"visibleOnTapSelection"===this._visibilityType.value()&&(e=!0),this._maximized.value()&&p.mobiletouch&&(e=!0),this._parentEl.classList.toggle(m.paneControls_hidden,!e),this._parentEl.classList.toggle(m.paneControls_forceHidden,!this._globalVisibility.value()||t)}_updateThemedColor(e){if(e.length>0){const[t,i,s]=(0,h.parseRgb)(e);this._parentEl.style.color=(0,h.rgbaToString)([t,i,s,(0,h.normalizeAlphaComponent)(.8)])}else this._parentEl.style.removeProperty("color")}}var v=i(243716),w=i(574235),S=i(430426),y=i(472899),f=i(648344),M=i(99539),C=i(520465),E=i(334763);const V=a.t(null,void 0,i(513930)),x=V,W=(0,o.humanReadableModifiers)(o.Modifiers.Mod)+V;var L=i(963632),k=i(103064),A=i(725784),T=i(37896),B=i(981020),H=i(203515),D=i(279526),P=i(682847),I=i(671402),R=i(142930);const z=a.t(null,void 0,i(866260)),N=a.t(null,void 0,i(407310)),O=a.t(null,void 0,i(274079)),F=a.t(null,void 0,i(90165)),U=a.t(null,void 0,i(512486)),G=a.t(null,void 0,i(565495)),Z=a.t(null,void 0,i(394670)),Q=a.t(null,void 0,i(513930));var j;!function(e){e.PaneCloseButton="pane-button-close",e.PaneUpButton="pane-button-up",e.PaneDownButton="pane-button-down",e.PaneMaximizeButton="pane-button-maximize",e.PaneMinimizeButton="pane-button-minimize",e.PaneCollapseButton="pane-button-collapse",e.PaneRestoreButton="pane-button-restore",e.PaneMoreButton="pane-button-more"}(j||(j={}));const $=(0,A.hotKeySerialize)({keys:[""],text:Q}),K=(0,A.hotKeySerialize)({keys:[(0,o.humanReadableModifiers)(o.Modifiers.Mod,!1)],text:`{0} + ${Q}`});class q{constructor(e,t,i,s){this._actions={},this._moreCMShown=!1,this._themedColor=new L.WatchedValue(""),this._model=e,this._pane=t,this._closeButtonVisibility=new L.WatchedValue(this._getCloseButtonVisibility()),this._upButtonVisibility=new L.WatchedValue(this._getUpButtonVisibility()),this._downButtonVisibility=new L.WatchedValue(this._getDownButtonVisibility()),this._maximizeButtonVisibility=new L.WatchedValue(this._getMaximizeButtonVisibility()),this._minimizeButtonVisibility=new L.WatchedValue(this._getMinimizeButtonVisibility()),this._collapseButtonVisibility=(0,n.combine)(((e,t,i)=>!e&&!t&&i),t.maximized().weakReference(),t.collapsed().weakReference(),t.collapsingAvailable().weakReference()),this._restoreButtonVisibility=(0,n.combine)(((e,t)=>!e&&t),t.maximized().weakReference(),t.collapsed().weakReference()),this._createActions(),this._visibilityTypeProperty=(0,r.actualBehavior)(),this._visibilityTypeProperty.subscribe(this,(e=>{this._visibilityType.setValue(e.value())})),this._visibilityType=new L.WatchedValue(this._visibilityTypeProperty.value()),this._isPaneMaximize=new L.WatchedValue(this._getIsPaneMaximizeValue()),this._isWidgetShow=new L.WatchedValue(this._getIsWidgetShow()),
this._backgroundThemeName=i.backgroundThemeName,this._renderer=new b(s,this._actions,{visibilityType:this._visibilityType.readonly(),globalVisibility:this._isWidgetShow.readonly(),doNotSwitchToContextMenuMode:this._isPaneMaximize.readonly(),themedColor:this._themedColor.readonly(),separatorSelected:i.anySeparatorSelected,maximized:this._isPaneMaximize.readonly()})}destroy(){this._visibilityTypeProperty.unsubscribeAll(this),this._collapseButtonVisibility.destroy(),this._restoreButtonVisibility.destroy(),this._renderer.destroy()}getElement(){return this._renderer.getElement()}bottomWithMargin(){return this._renderer.bottomWithMargin()}action(){return this._actions}update(){this._updateButtonsVisibility(),this._isPaneMaximize.setValue(this._getIsPaneMaximizeValue()),this._isWidgetShow.setValue(this._getIsWidgetShow())}updateWidgetModeByWidth(e){this._renderer.updateWidgetModeByWidth(e)}updateThemedColors(e){null===e&&(e=(0,k.getStdThemedValue)("chartProperties.paneProperties.background",this._backgroundThemeName.value())),this._themedColor.setValue(e||"")}_updateButtonsVisibility(){this._closeButtonVisibility.setValue(this._getCloseButtonVisibility()),this._upButtonVisibility.setValue(this._getUpButtonVisibility()),this._downButtonVisibility.setValue(this._getDownButtonVisibility()),this._maximizeButtonVisibility.setValue(this._getMaximizeButtonVisibility()),this._minimizeButtonVisibility.setValue(this._getMinimizeButtonVisibility())}_createActions(){this._actions.up={icon:B,action:this._onUpDownButton.bind(this,"up"),visible:this._upButtonVisibility,title:new L.WatchedValue(N),className:m.up,dataset:{name:"pane-button-up"}},this._actions.down={icon:H,action:this._onUpDownButton.bind(this,"down"),visible:this._downButtonVisibility,title:new L.WatchedValue(O),className:m.down,dataset:{name:"pane-button-down"}},this._actions.close={icon:T,action:this._onCloseButton.bind(this),visible:this._closeButtonVisibility,title:new L.WatchedValue(z),dataset:{name:"pane-button-close"}},this._actions.maximize={icon:D,action:this._onToggleMaximizeButton.bind(this,"Maximize pane"),visible:this._maximizeButtonVisibility,title:new L.WatchedValue(F),hotKeyTitle:$,className:m.maximize,dataset:{name:"pane-button-maximize"}},this._actions.minimize={icon:D,action:this._onToggleMaximizeButton.bind(this,"Minimize pane"),visible:this._minimizeButtonVisibility,title:new L.WatchedValue(U),hotKeyTitle:$,className:m.minimize,dataset:{name:"pane-button-minimize"}},this._actions.collapse={icon:I,action:this._onToggleCollapseButton.bind(this,"Collapse pane"),visible:this._collapseButtonVisibility,title:new L.WatchedValue(G),hotKeyTitle:K,className:m.collapse,dataset:{name:"pane-button-collapse"}},this._actions.restore={icon:R,action:this._onToggleCollapseButton.bind(this,"Restore pane"),visible:this._restoreButtonVisibility,title:new L.WatchedValue(U),hotKeyTitle:K,className:m.restore,dataset:{name:"pane-button-restore"}},this._actions.more={icon:P,action:this._showButtonsInContextMenu.bind(this),visible:new L.WatchedValue(!0),
title:new L.WatchedValue(Z),dataset:{name:"pane-button-more"}}}_getCloseButtonVisibility(){let e=!1;return this._pane.containsMainSeries()||this._pane.maximized().value()||(e=this._pane.dataSources().some((e=>(0,d.isStudy)(e)))),e}_onCloseButton(){this._trackEvent("Delete pane");const e=this._model.model().panes().indexOf(this._pane);this._model.removePane(e)}_getUpButtonVisibility(){const e=this._pane,t=this._model.model().panes().indexOf(e);return this._model.model().canMovePaneUp(t)}_getDownButtonVisibility(){const e=this._model.model().panes().indexOf(this._pane);return this._model.model().canMovePaneDown(e)}_onUpDownButton(e){this._trackEvent(`Move pane ${e}`);const t=this._model.model().panes().indexOf(this._pane);this._model.rearrangePanes(t,e)}_getMaximizeButtonVisibility(){return this._model.model().panes().length>1&&!this._pane.maximized().value()}_getMinimizeButtonVisibility(){return this._model.model().panes().length>1&&this._pane.maximized().value()}_onToggleMaximizeButton(e){this._trackEvent(e),this._model.toggleMaximizedPane(this._pane)}_onToggleCollapseButton(e){this._trackEvent(e),this._model.toggleCollapsedPane(this._pane)}_showButtonsInContextMenu(e){e.preventDefault(),this._moreCMShown||function(e,t,i){const s=[];if(e.maximize.visible.value()){const t=(0,u.ensure)(e.maximize.title),i=(0,u.ensureNotNull)(e.maximize.action);s.push(new v.Action({actionId:"Chart.PaneControls.MaximizePane",options:{icon:M,label:t.value(),statName:"Maximize Pane",shortcutHint:x,onExecute:()=>i()}}))}else if(e.minimize.visible.value()){const t=(0,u.ensure)(e.minimize.title),i=(0,u.ensureNotNull)(e.minimize.action);s.push(new v.Action({actionId:"Chart.PaneControls.MinimizePane",options:{icon:M,label:t.value(),statName:"Minimize Pane",shortcutHint:x,onExecute:()=>i()}}))}if(e.collapse.visible.value()){const t=(0,u.ensure)(e.collapse.title),i=(0,u.ensureNotNull)(e.collapse.action);s.push(new v.Action({actionId:"Chart.PaneControls.CollapsePane",options:{icon:C,label:t.value(),statName:"Collapse pane",shortcutHint:W,onExecute:()=>i()}}))}if(e.restore.visible.value()){const t=(0,u.ensure)(e.restore.title),i=(0,u.ensureNotNull)(e.restore.action);s.push(new v.Action({actionId:"Chart.PaneControls.RestorePane",options:{icon:E,label:t.value(),statName:"Restore pane",shortcutHint:W,onExecute:()=>i()}}))}if(e.up.visible.value()){const t=(0,u.ensure)(e.up.title),i=(0,u.ensureNotNull)(e.up.action);s.push(new v.Action({actionId:"Chart.PaneControls.MovePaneUp",options:{icon:y,label:t.value(),statName:"Move pane up",onExecute:()=>i()}}))}if(e.down.visible.value()){const t=(0,u.ensure)(e.down.title),i=(0,u.ensureNotNull)(e.down.action);s.push(new v.Action({actionId:"Chart.PaneControls.MovePaneDown",options:{icon:f,label:t.value(),statName:"Move pane down",onExecute:()=>i()}}))}if(e.close.visible.value()){const t=(0,u.ensure)(e.close.title),i=(0,u.ensureNotNull)(e.close.action);s.push(new v.Action({actionId:"Chart.PaneControls.DeletePane",options:{icon:S,label:t.value(),statName:"Delete pane",onExecute:()=>i()}}))}const l=(0,
u.ensureNotNull)(t.currentTarget).getBoundingClientRect();return w.ContextMenuManager.showMenu(s,{clientX:l.right,clientY:l.top+l.height+3,attachToXBy:"right"},void 0,void 0,i)}(this._actions,e,(()=>{this._moreCMShown=!1})).then((()=>{this._moreCMShown=!0}))}_getIsPaneMaximizeValue(){return this._pane.maximized().value()}_getIsWidgetShow(){return this._model.model().panes().length>1}_trackEvent(e){(0,l.trackEvent)("GUI","Pane action",e)}}},314913:(e,t,i)=>{"use strict";i.d(t,{createActionElement:()=>n});var s=i(343888),l=i(650151),a=i(144421),o=i(796966);function n(e,t){const{buttonClassName:i,wrapIconClassName:n,hiddenClassName:r,iconSize:d,blurOnClick:u}=t,h=document.createElement(t.tag);h.className=i,h.classList.toggle(r,!e.visible.value()),Object.assign(h.dataset,e.dataset),void 0!==e.className&&h.classList.add(e.className),void 0!==e.title&&(h.classList.add("apply-common-tooltip"),h.setAttribute("title",e.title.value()),void 0!==e.hotKeyTitle&&(h.dataset.tooltipHotkey=e.hotKeyTitle)),h.addEventListener("touchend",(0,o.wrapHandlerWithPreventEvent)(e.action)),h.addEventListener("mousedown",(t=>{0===t.button&&(e.action(t),u&&h.blur())}));const c=document.createElement("div");let p;return c.classList.add(n),p=(0,s.default)(e.icon)?e.icon.get((0,l.ensureDefined)(d))||"":e.icon,(0,a.isString)(p)?c.innerHTML=p:c.appendChild(p),h.appendChild(c),h}},993200:(e,t,i)=>{"use strict";i.d(t,{isCustomStudy:()=>l});const s={VbPFixed:!0,PivotPointsStandard:!0,VbPVisible:!0,VbPAnchored:!0};function l(e){return e in s}},31015:(e,t,i)=>{"use strict";i.d(t,{MetaInfoHelper:()=>c});var s=i(650151),l=i(671945),a=i(912133),o=i(485834),n=i(144421),r=i(746399);function d(e){return!e.groupId&&!e.isHidden&&e.id!==r.RangeDependentStudyInputNames.FirstBar&&e.id!==r.RangeDependentStudyInputNames.LastBar}var u=i(993200);const h=(0,l.getLogger)("Platform.GUI.PropertyDialog.Indicators.MetaInfo");class c{constructor(e){this._metaInfo=e}hasUserEditableInputs(){return this._metaInfo.inputs.some(d)}getUserEditableInputs(){return this._metaInfo.inputs.filter(d)}hasUserEditableProperties(){return a.StudyMetaInfo.isScriptStrategy(this._metaInfo)}hasUserEditableStyles(){const e=this._metaInfo;return e.plots.length>0||void 0!==e.bands||void 0!==e.filledAreas||(0,u.isCustomStudy)(e.shortId)||a.StudyMetaInfo.isScriptStrategy(this._metaInfo)||Object.values(e.graphics).some((e=>void 0!==e))}getUserEditablePlots(){const e=new Set,t=this._metaInfo;return t.plots.filter((i=>{if((0,o.isColorerPlot)(i)||(0,o.isTextColorerPlot)(i)||(0,o.isDataOffsetPlot)(i)||(0,o.isOhlcColorerPlot)(i)||(0,o.isAlertConditionPlot)(i)||(0,o.isDataPlot)(i))return!1;if((0,o.isOhlcPlot)(i)){const l=i.target;if(e.has(l))return!1;e.add(l);const a=(0,s.ensureDefined)(t.ohlcPlots);return!(0,s.ensureDefined)(a[l]).isHidden}{const e=t.styles?t.styles[i.id]:void 0;return void 0===e||!e.isHidden}}))}hasUserEditableOptions(){return this.hasUserEditableInputs()||this.hasUserEditableProperties()||this.hasUserEditableStyles()}getStrategyProperties(){const e=this._metaInfo,t=e.inputs.filter(_),i={...p
};for(const s of t){const t=s.internalID;i[t]=s,p.hasOwnProperty(t)||h.logWarn(`Unknown strategy input internal id ${t} in ${e.fullId}`)}return(0,n.clone)(i)}}const p={currency:void 0,backtest_fill_limits_assumption:void 0,calc_on_every_tick:void 0,calc_on_order_fills:void 0,commission_value:void 0,commission_type:void 0,initial_capital:void 0,pyramiding:void 0,slippage:void 0,default_qty_type:void 0,default_qty_value:void 0,margin_long:void 0,margin_short:void 0,use_bar_magnifier:void 0,process_orders_on_close:void 0,fill_orders_on_standard_ohlc:void 0};function _(e){return"strategy_props"===e.groupId}},175472:(e,t,i)=>{"use strict";i.d(t,{trackingModeIsAvailable:()=>s});const s=i(601227).CheckMobile.any()},129914:(e,t,i)=>{"use strict";function s(e,t){return l(e,t,t?["&amp;"]:["&"])}function l(e,t,i){const s=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&#039;"],["'","&#39;"]];t&&s.forEach((e=>e.reverse()));let l=e;if(!e||!e.replace)return l;for(const e of s){const[t,s]=e;i&&-1!==i.indexOf(t)||(l=l.replace(new RegExp(t,"g"),s))}return l}i.d(t,{clean:()=>l,cleanButAmpersand:()=>s})},689612:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.83 3.92 12.28 9l-4.45 5.08-1.13-1L10.29 9l-3.6-4.09 1.14-.99Z"/></svg>'},23317:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M14 10H4V8.5h10V10Z"/></svg>'},577576:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M8.25 13.75v-9.5h1.5v9.5h-1.5Z"/><path fill="currentColor" d="M13.75 9.75h-9.5v-1.5h9.5v1.5Z"/></svg>'},691986:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M14.5 8V3.5H10V2h6v6h-1.5Zm-11 2v4.5H8V16H2v-6h1.5Z"/></svg>'},776996:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M11.5 2v4.5H16V8h-6V2h1.5Zm-5 14v-4.5H2V10h6v6H6.5Z"/></svg>'},678529:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.45 3.5 12.48 9l-5.03 5.49 1.1 1.01L14.52 9 8.55 2.49 7.45 3.5Z"/><path fill="currentColor" d="m3.93 5.99 2.58 3-2.58 3.02 1.14.98 3.42-4-3.42-3.98L3.93 6Z"/></svg>'},593724:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M10 6.38V8L6 5.5 10 3v1.85A5.25 5.25 0 1 1 3.75 10a.75.75 0 0 1 1.5 0A3.75 3.75 0 1 0 10 6.38Z"/></svg>'},79304:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M9 2.5c-1.06 0-1.88.93-1.75 1.98l.63 5.03a1.13 1.13 0 0 0 2.25 0l.62-5.03A1.77 1.77 0 0 0 9 2.5zm0 10a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z"/></svg>'},838373:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/></svg>'},931233:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.57 14.8H5.03V3.36c1.62-.05 2.64-.08 3.06-.08 1.66 0 2.98.49 3.96 1.47a5.23 5.23 0 0 1 1.47 3.88c0 4.11-1.99 6.17-5.95 6.17zm-.5-9.66v7.8c.32.04.67.06 1.05.06 1.03 0 1.83-.38 2.41-1.12.58-.75.88-1.79.88-3.13 0-2.44-1.14-3.67-3.42-3.67-.22 0-.53.02-.93.06z"/></svg>'},512646:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.84 13.7H5.78V4.4l2.48-.06c1.35 0 2.42.4 3.22 1.2.8.78 1.19 1.83 1.19 3.15 0 3.34-1.61 5.01-4.83 5.01zm-.41-7.85v6.35c.26.02.55.03.86.03.83 0 1.48-.3 1.95-.9.48-.6.72-1.46.72-2.54 0-2-.93-2.99-2.78-2.99-.18 0-.43.02-.75.05z"/></svg>'},421672:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M14 22a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm5-9H9v2h10v-2Z"/></svg>'},469410:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.65 5.16v2.68h3.78v1.73H7.65V13h5.19v1.8H5.62V3.35h7.3v1.8H7.65z"/></svg>'},55593:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.9 5.87v2.17h3.07v1.4H7.9v2.8h4.22v1.46H6.25V4.4h5.94v1.47H7.9z"/></svg>'},553218:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><rect width="10" height="4" fill="currentColor" rx="2" x="4" y="7"/></svg>'},262998:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><circle fill="currentColor" cx="9" cy="9" r="5"/></svg>'},732140:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18" fill="none"><circle fill="currentColor" cx="9" cy="9" r="4"/></svg>'},725230:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M9.3 9l.9-4.53a1.23 1.23 0 1 0-2.4 0L8.7 9l-.9 4.53a1.23 1.23 0 1 0 2.4 0L9.3 9z"/><path fill="currentColor" d="M9.15 9.26l4.38-1.48a1.23 1.23 0 1 0-1.21-2.09L8.85 8.74l-4.38 1.48a1.23 1.23 0 1 0 1.21 2.09l3.47-3.05z"/><path fill="currentColor" d="M9.15 8.74L5.68 5.69a1.23 1.23 0 1 0-1.2 2.09l4.37 1.48 3.47 3.05a1.23 1.23 0 1 0 1.2-2.09L9.16 8.74z"/></svg>'},643401:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M13.29 4.8h-.09a4.2 4.2 0 1 0 .09 8.4 6 6 0 1 1 0-8.4z"/></svg>'},315507:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M12.57 5.5h-.07a3.5 3.5 0 1 0 .07 7A4.98 4.98 0 0 1 4 9a5 5 0 0 1 8.57-3.5z"/></svg>'},212462:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M12.58 12.1A3.86 3.86 0 0 0 9 6.75a3.87 3.87 0 0 0-3.58 5.33 7.74 7.74 0 0 1 7.16 0zM3.64 9.93l-2.3-.62.37-1.38 2.3.62-.37 1.38zM6.1 6.07L5.07 3.92l1.3-.6 1 2.15-1.29.6zM10.62 5.47l1-2.16 1.3.6-1.01 2.16-1.3-.6zM13.99 8.55l2.3-.62.36 1.38-2.3.62L14 8.55z"/></svg>'},85290:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M12.22 11.78A3.47 3.47 0 0 0 9 6.98a3.48 3.48 0 0 0-3.22 4.8 6.97 6.97 0 0 1 6.44 0zM4.18 9.83L2.1 9.28l.33-1.24 2.07.55-.33 1.24zM6.38 6.36l-.9-1.94 1.16-.54.9 1.94-1.16.54zM10.46 5.82l.9-1.94 1.16.54-.9 1.94-1.16-.54zM13.49 8.6l2.07-.56.33 1.24-2.07.55-.33-1.24z"/></svg>'},991665:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M14.48 5.1c-.52 2.03-1.46 3.04-2.82 3.04-.64 0-1.55-.19-2.74-.56-1.17-.38-1.99-.57-2.46-.57-.69 0-1.22.37-1.58 1.13H3.55A4.3 4.3 0 0 1 4.5 6c.5-.6 1.08-.9 1.74-.9.7 0 1.65.2 2.84.58 1.2.37 2.04.55 2.52.55.8 0 1.32-.37 1.59-1.13h1.29zm0 4.84c-.52 2.02-1.46 3.03-2.82 3.03-.64 0-1.55-.19-2.74-.56-1.17-.38-1.99-.57-2.46-.57-.69 0-1.22.38-1.58 1.13H3.55a4.3 4.3 0 0 1 .95-2.14c.5-.6 1.08-.9 1.74-.9.7 0 1.65.2 2.84.58 1.2.37 2.04.56 2.52.56.8 0 1.32-.38 1.59-1.13h1.29z"/></svg>'},552828:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M13.4 5.9c-.41 1.62-1.16 2.43-2.25 2.43-.52 0-1.25-.15-2.2-.45-.93-.3-1.58-.45-1.96-.45-.55 0-.98.3-1.27.9H4.66c.1-.67.36-1.24.76-1.71.4-.48.86-.72 1.4-.72.56 0 1.31.16 2.27.46.95.3 1.62.45 2.01.45.64 0 1.06-.3 1.27-.9h1.03zm0 3.87c-.41 1.62-1.16 2.43-2.25 2.43-.52 0-1.25-.15-2.2-.45-.93-.3-1.58-.46-1.96-.46-.55 0-.98.3-1.27.9H4.66c.1-.67.36-1.24.76-1.7.4-.48.86-.72 1.4-.72.56 0 1.31.15 2.27.46.95.3 1.62.44 2.01.44.64 0 1.06-.3 1.27-.9h1.03z"/></svg>'},839379:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M4 6.5 6 8l3-3 3 3 2-1.5V10H4V6.5ZM14 13v-2H4v2h10Z"/></svg>'},257979:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M9 3.9a5.13 5.13 0 0 0-4.89 3.63l-1.33-.41A6.53 6.53 0 0 1 9 2.5a6.52 6.52 0 0 1 6.18 4.47l.77-.99 1.1.87-1.7 2.17-.34.43-.5-.21-2.57-1.11.55-1.29 1.36.59A5.13 5.13 0 0 0 9 3.9ZM2.93 8.66l.46.13 2.58.7-.37 1.35-1.52-.41a5.12 5.12 0 0 0 9.8.1l1.35.4a6.52 6.52 0 0 1-12.4.2l-.77 1.06-1.13-.83 1.71-2.31.29-.39Z"/></svg>'},302588:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M9 4.6c-1.94 0-3.6 1.3-4.14 3.08l-1.34-.41a5.75 5.75 0 0 1 10.87-.3l.56-.72 1.1.87L14.58 9l-.34.42-.5-.21-2.23-.96.55-1.29.99.42A4.35 4.35 0 0 0 9 4.6ZM3.7 8.53l.46.12 2.24.61-.37 1.35-1.15-.31a4.34 4.34 0 0 0 8.27-.08l1.34.41a5.74 5.74 0 0 1-10.86.35l-.57.76-1.12-.83 1.48-2 .28-.38Z"/></svg>'},841674:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><g class="normal-eye"><path fill="currentColor" fill-rule="evenodd" d="M12 18c-3.07 0-6.21-1.95-7.92-6C5.78 7.95 8.93 6 12 6c3.08 0 6.22 1.95 7.92 6-1.7 4.05-4.84 6-7.92 6Zm8.93-6.19C19.1 7.31 15.59 5 12 5S4.9 7.32 3.08 11.8L3 12l.08.19C4.89 16.68 8.4 19 12 19c3.6 0 7.11-2.32 8.93-6.81l.07-.2-.07-.18ZM14 12a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm1 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/></g><g class="crossed-eye"><path fill="currentColor" d="M12 19a8.47 8.47 0 0 1-3.87-.95l.75-.75c1 .47 2.07.7 3.12.7 3.08 0 6.22-1.95 7.92-6a11.18 11.18 0 0 0-2.25-3.49l.7-.7a12.28 12.28 0 0 1 2.56 4L21 12l-.07.19C19.1 16.68 15.59 19 12 19Zm-7.92-7c.6 1.42 1.37 2.58 2.26 3.49l-.7.7a12.28 12.28 0 0 1-2.56-4l-.08-.2.08-.18C4.89 7.31 8.4 5 12 5c1.33 0 2.65.32 3.88.94l-.75.75A7.45 7.45 0 0 0 12 6C8.93 6 5.8 7.96 4.08 12ZM12 15a3 3 0 0 1-.73-.09l.92-.92a2 2 0 0 0 1.8-1.8l.92-.92A3 3 0 0 1 12 15Zm-2.91-2.27.92-.91A2 2 0 0 1 11.8 10l.92-.92a3 3 0 0 0-3.64 3.64Zm9.08-7.66-13.1 13.1.77.76 13.09-13.1-.76-.76Z"/></g><g fill="none" class="loading-eye"><path stroke="currentColor" d="M20.46 12c-3.5 8.67-13.42 8.67-16.92 0 3.5-8.67 13.42-8.67 16.92 0Z"/></g><g fill="none" class="animated-loading-eye"><path stroke="currentColor" d="M14.5 12a2.5 2.5 0 1 0-2.5 2.5"/></g></svg>'},754336:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><g class="normal-eye"><path fill="currentColor" fill-rule="evenodd" d="M12 9a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm-1 0a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z"/><path fill="currentColor" d="M16.91 8.8C15.31 4.99 12.18 3 9 3 5.82 3 2.7 4.98 1.08 8.8L1 9l.08.2C2.7 13.02 5.82 15 9 15c3.18 0 6.3-1.97 7.91-5.8L17 9l-.09-.2ZM9 14c-2.69 0-5.42-1.63-6.91-5 1.49-3.37 4.22-5 6.9-5 2.7 0 5.43 1.63 6.92 5-1.5 3.37-4.23 5-6.91 5Z"/></g><g class="crossed-eye"><path fill="currentColor" d="M3.7 15 15 3.7l-.7-.7L3 14.3l.7.7ZM9 3c1.09 0 2.17.23 3.19.7l-.77.76C10.64 4.16 9.82 4 9 4 6.31 4 3.58 5.63 2.08 9a9.35 9.35 0 0 0 1.93 2.87l-.7.7A10.44 10.44 0 0 1 1.08 9.2L1 9l.08-.2C2.69 4.99 5.82 3 9 3Z"/><path fill="currentColor" d="M9 6a3 3 0 0 1 .78.1l-.9.9A2 2 0 0 0 7 8.87l-.9.9A3 3 0 0 1 9 6ZM11.9 8.22l-.9.9A2 2 0 0 1 9.13 11l-.9.9a3 3 0 0 0 3.67-3.68Z"/><path fill="currentColor" d="M9 14c-.82 0-1.64-.15-2.43-.45l-.76.76c1.02.46 2.1.7 3.19.7 3.18 0 6.31-1.98 7.92-5.81L17 9l-.08-.2a10.44 10.44 0 0 0-2.23-3.37l-.7.7c.75.76 1.41 1.71 1.93 2.87-1.5 3.37-4.23 5-6.92 5Z"/></g><g fill="none" class="loading-eye"><path stroke="currentColor" d="M16.45 9c-3.08 7.33-11.82 7.33-14.9 0 3.08-7.33 11.82-7.33 14.9 0Z"/></g><g fill="none" class="animated-loading-eye"><path stroke="currentColor" d="M11.5 9A2.5 2.5 0 1 0 9 11.5"/></g></svg>'},645534:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M5.5 11a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM3 12.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0Zm9.5-1.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10 12.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0Zm9.5-1.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM17 12.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0Z"/></svg>'},387258:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" d="M3 10a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm0 1a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm6-1a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm0 1a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm7-2a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm1 0a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z"/></svg>'},736885:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M8.54.84a.8.8 0 0 1 .92 0l7.5 5.25a.8.8 0 0 1 0 1.32l-7.5 5.25a.8.8 0 0 1-.92 0L1.04 7.4a.8.8 0 0 1 0-1.32L8.54.84zM2.9 6.75L9 11.02l6.1-4.27L9 2.48 2.9 6.75z"/><path fill="currentColor" d="M.84 10.8a.8.8 0 0 1 1.12-.2L9 15.51l7.04-4.93a.8.8 0 0 1 .92 1.32l-7.5 5.25a.8.8 0 0 1-.92 0l-7.5-5.25a.8.8 0 0 1-.2-1.12z"/></svg>'},65300:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M7.23 2.58a.5.5 0 0 1 .54 0l5.5 3.5a.5.5 0 0 1 0 .84l-5.5 3.5a.5.5 0 0 1-.54 0l-5.5-3.5a.5.5 0 0 1 0-.84l5.5-3.5zM2.93 6.5L7.5 9.4l4.57-2.9L7.5 3.6 2.93 6.5z"/><path fill="currentColor" d="M1.58 9.23a.5.5 0 0 1 .69-.15L7.5 12.4l5.23-3.33a.5.5 0 0 1 .54.84l-5.5 3.5a.5.5 0 0 1-.54 0l-5.5-3.5a.5.5 0 0 1-.15-.69z"/></svg>'},337073:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M6 7.5A2.5 2.5 0 0 1 8.5 5H10v1H8.5C7.67 6 7 6.67 7 7.5v1.15a3.5 3.5 0 0 1-1.93 3.13l-.45.22.45.22A3.5 3.5 0 0 1 7 15.35v1.15c0 .83.67 1.5 1.5 1.5H10v1H8.5A2.5 2.5 0 0 1 6 16.5v-1.15a2.5 2.5 0 0 0-1.38-2.23l-1.34-.67a.5.5 0 0 1 0-.9l1.34-.67A2.5 2.5 0 0 0 6 8.65V7.5ZM15.5 6H14V5h1.5A2.5 2.5 0 0 1 18 7.5v1.15c0 .94.54 1.8 1.38 2.23l1.34.67a.5.5 0 0 1 0 .9l-1.34.67A2.5 2.5 0 0 0 18 15.35v1.15a2.5 2.5 0 0 1-2.5 2.5H14v-1h1.5c.83 0 1.5-.67 1.5-1.5v-1.15a3.5 3.5 0 0 1 1.93-3.13l.45-.22-.45-.22A3.5 3.5 0 0 1 17 8.65V7.5c0-.83-.67-1.5-1.5-1.5Z"/></svg>'},34882:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7 14H5.5A1.5 1.5 0 0 1 4 12.5v-1A2.9 2.9 0 0 0 2.66 9l.18-.13A2.9 2.9 0 0 0 4 6.5V5.5C4 4.67 4.67 4 5.5 4H7V3H5.5A2.5 2.5 0 0 0 3 5.5V6.5a1.9 1.9 0 0 1-.77 1.58c-.42.32-.84.43-.85.44C1.3 8.54 1 8.65 1 9s.3.46.38.48c0 0 .43.12.85.44.4.3.77.8.77 1.58v1A2.5 2.5 0 0 0 5.5 15H7v-1Zm4-10h1.5c.83 0 1.5.67 1.5 1.5v1A2.9 2.9 0 0 0 15.34 9l-.18.13A2.9 2.9 0 0 0 14 11.5V12.5c0 .83-.67 1.5-1.5 1.5H11v1h1.5a2.5 2.5 0 0 0 2.5-2.5V11.5c0-.79.38-1.27.77-1.58.42-.32.84-.43.85-.44.08-.02.38-.13.38-.48s-.3-.46-.38-.48c0 0-.43-.12-.85-.44-.4-.3-.77-.8-.77-1.58v-1A2.5 2.5 0 0 0 12.5 3H11v1Z"/></svg>'},236791:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" fill-rule="evenodd" d="m5.12 12 3-6h7.76l3 6-3 6H8.12l-3-6ZM7.5 5h9l3.5 7-3.5 7h-9L4 12l3.5-7Zm6.5 7a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm1 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/></svg>'},583637:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" d="m3.1 9 2.28-5h7.24l2.28 5-2.28 5H5.38L3.1 9Zm1.63-6h8.54L16 9l-2.73 6H4.73L2 9l2.73-6Zm5.77 6a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm1 0a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Z"/></svg>'},591104:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M10.5 6a.5.5 0 0 0-.5.5V7h4v-.5a.5.5 0 0 0-.5-.5h-3ZM15 7h3v1h-1.04l-.88 9.64a1.5 1.5 0 0 1-1.5 1.36H9.42a1.5 1.5 0 0 1-1.5-1.36L7.05 8H6V7h3v-.5c0-.83.67-1.5 1.5-1.5h3c.83 0 1.5.67 1.5 1.5V7ZM8.05 8l.87 9.55a.5.5 0 0 0 .5.45h5.17a.5.5 0 0 0 .5-.45L15.94 8h-7.9Z"/></svg>'},30556:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.5 4a.5.5 0 0 0-.5.5V5h4v-.5a.5.5 0 0 0-.5-.5h-3ZM12 5h3v1h-1.05l-.85 7.67A1.5 1.5 0 0 1 11.6 15H6.4a1.5 1.5 0 0 1-1.5-1.33L4.05 6H3V5h3v-.5C6 3.67 6.67 3 7.5 3h3c.83 0 1.5.67 1.5 1.5V5ZM5.06 6l.84 7.56a.5.5 0 0 0 .5.44h5.2a.5.5 0 0 0 .5-.44L12.94 6H5.06Z"/></svg>'},671402:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="none"><path stroke="currentColor" d="M11 2 7.5 5 4 2" class="bracket-up"/><path stroke="currentColor" d="M4 13l3.5-3 3.5 3" class="bracket-down"/></svg>'},520465:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path stroke="currentColor" d="M20.53 3.73 14 9.33 7.47 3.73M7.47 24.27l6.53 -5.60 6.53 5.60"/></svg>'},648344:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M14 7v12.93l5.18-4.31.64.76-6.32 5.27-6.32-5.27.64-.76L13 19.93V7h1z"/></svg>'},99539:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M19.32 6H8.68A2.68 2.68 0 0 0 6 8.68V11h1V8.68C7 7.75 7.75 7 8.68 7h10.64c.93 0 1.68.75 1.68 1.68V11h1V8.68C22 7.2 20.8 6 19.32 6zM7 19.32c0 .93.75 1.68 1.68 1.68h10.64c.93 0 1.68-.75 1.68-1.68V17h1v2.32C22 20.8 20.8 22 19.32 22H8.68A2.68 2.68 0 0 1 6 19.32V17h1v2.32z"/></svg>'},334763:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path stroke="currentColor" d="m7.47 9.33 6.53 -5.60L20.53 9.33M20.53 18.67l-6.53 5.60L7.47 18.67"/></svg>'},430426:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M18 7h5v1h-2.01l-1.33 14.64a1.5 1.5 0 0 1-1.5 1.36H9.84a1.5 1.5 0 0 1-1.49-1.36L7.01 8H5V7h5V6c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v1Zm-6-2a1 1 0 0 0-1 1v1h6V6a1 1 0 0 0-1-1h-4ZM8.02 8l1.32 14.54a.5.5 0 0 0 .5.46h8.33a.5.5 0 0 0 .5-.46L19.99 8H8.02Z"/></svg>'},472899:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M13.5 6.35l6.32 5.27-.64.76L14 8.07V21h-1V8.07l-5.18 4.31-.64-.76 6.32-5.27z"/></svg>'},682847:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><circle fill="currentColor" cx="12.75" cy="7.5" r="1.25"/><circle fill="currentColor" cx="7.5" cy="7.5" r="1.25"/><circle fill="currentColor" cx="2.25" cy="7.5" r="1.25"/></svg>'},203515:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M11.83 8.88l-.66-.76L8 10.9V3H7v7.9L3.83 8.12l-.66.76 4.33 3.78 4.33-3.78z"/></svg>'},279526:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="none"><path fill="currentColor" d="M4.5 12A1.5 1.5 0 0 1 3 10.5V9H2v1.5A2.5 2.5 0 0 0 4.5 13h6a2.5 2.5 0 0 0 2.5-2.5V9h-1v1.5c0 .83-.67 1.5-1.5 1.5h-6z" class="bracket-up"/><path fill="currentColor" d="M4.5 3C3.67 3 3 3.67 3 4.5V6H2V4.5A2.5 2.5 0 0 1 4.5 2h6A2.5 2.5 0 0 1 13 4.5V6h-1V4.5c0-.83-.67-1.5-1.5-1.5h-6z" class="bracket-down"/></svg>'},142930:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="none"><path stroke="currentColor" d="m4 5 3.5-3L11 5" class="bracket-up"/><path stroke="currentColor" d="M11 10l-3.5 3L4 10" class="bracket-down"/></svg>'},37896:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M6.5 2a.5.5 0 0 0-.5.5V3h3v-.5a.5.5 0 0 0-.5-.5h-2ZM10 3h3v1h-1.05l-.86 8.65A1.5 1.5 0 0 1 9.59 14H5.4a1.5 1.5 0 0 1-1.49-1.35L3.05 4H2V3h3v-.5C5 1.67 5.67 1 6.5 1h2c.83 0 1.5.67 1.5 1.5V3ZM4.05 4l.86 8.55a.5.5 0 0 0 .5.45H9.6a.5.5 0 0 0 .5-.45L10.94 4h-6.9Z"/></svg>'},981020:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M11.83 6.12l-.66.76L8 4.1V12H7V4.1L3.83 6.88l-.66-.76L7.5 2.34l4.33 3.78z"/></svg>'},662920:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path fill="currentColor" d="M2.4 5.46a.8.8 0 0 1 1.14-.05L8 9.42l4.46-4.01a.8.8 0 0 1 1.08 1.18L8 11.58 2.47 6.59a.8.8 0 0 1-.06-1.13z"/></svg>'},947036:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M3.5 5.58c.24-.28.65-.3.92-.07L7.5 8.14l3.08-2.63a.65.65 0 1 1 .84.98L7.5 9.86 3.58 6.49a.65.65 0 0 1-.07-.91z"/></svg>'},542205:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7 7" width="7" height="7"><path fill="currentColor" d="M3.5 7L7 4H4V0H3V4H0L3.5 7Z"/></svg>'},50119:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 7" width="9" height="7"><path fill="currentColor" d="M.5 3.5L4 0v3h5v1H4v3z"/></svg>'},362884:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 7" width="9" height="7"><path fill="currentColor" d="M8.5 3.5L5 0v3H0v1h5v3z"/></svg>'},250662:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 7 7" width="7" height="7"><path fill="currentColor" d="M3.5 0L0 3h3v4h1V3h3L3.5 0z"/></svg>'},586240:e=>{"use strict"
;e.exports=JSON.parse('{"dur":"350ms","dur-fast":"60ms","ease-in-like":"cubic-bezier(0.33, 0, 0.11, 1)","ease-out-like":"cubic-bezier(0.89, 0, 0.67, 1)","size-feed-item-width":"480px","size-feed-hident":"20px","size-feed-vident":"20px","size-base-indent":"4px","size-layout-small-horzpadding":"12px","size-layout-horzpadding":"20px","size-drawings-toolbar-item-height":"38px","size-header-linkindent":"15px","size-header-height":"64px","size-nav-header-height":"58px","size-sticky-symbol-header-height":"64px","size-dialog-fixed-header-height":"72px","size-site-widget-padding":"20px","size-site-widget-padding-tablet":"12px","size-collapse-tabs-height":"56px","size-no-scroll-choicer-height":"56px","size-main-chart-area-indent":"4px","size-main-chart-area-radius":"0","radius-embed-widget-wrapper":"3px","typography-platform-regular-16px-line-height":"24px","typography-platform-regular-18px-line-height":"28px","media-notebook":"all and (max-width: 1530px)","media-tablet":"all and (max-width: 1019px)","media-phone":"all and (max-width: 767px)","media-phone-vertical":"all and (max-width: 479px)","media-extreme-thin":"all and (max-width: 329px)","media-show-drawer":"all and (max-width: 567px)","media-mf-legacy-phone-vertical":"all and (min-width: 330px)","media-mf-legacy-phone":"all and (min-width: 480px)","media-mf-legacy-notebook":"all and (min-width: 1020px)","media-mf-legacy-desktop-medium":"all and (min-width: 1480px)","media-mf-legacy-desktop":"all and (min-width: 1531px)","media-mf-phone-vertical":"all and (min-width: 320px)","media-mf-phone-landscape":"all and (min-width: 568px)","media-mf-tablet-vertical":"all and (min-width: 768px)","media-mf-tablet-landscape":"all and (min-width: 1024px)","media-mf-laptop":"all and (min-width: 1280px)","media-mf-desktop-medium":"all and (min-width: 1440px)","media-mf-desktop-large":"all and (min-width: 1920px)","media-mf-desktop-extra-large":"all and (min-width: 2560px)","container-phone":"(max-width: 767px)","container-phone-vertical":"(max-width: 479px)","container-mf-phone-vertical":"(min-width: 320px)","container-mf-phone-landscape":"(min-width: 568px)","container-mf-tablet-vertical":"(min-width: 768px)","container-mf-tablet-landscape":"(min-width: 1024px)","container-mf-laptop":"(min-width: 1280px)","container-mf-desktop-medium":"(min-width: 1440px)","container-mf-desktop-large":"(min-width: 1920px)","container-mf-desktop-extra-large":"(min-width: 2560px)","media-laptop":"all and (min-width: 1280px) and (max-width: 1439px)","media-laptop-and-desktop-medium":"all and (min-width: 1280px) and (max-width: 1919px)","media-landscape":"all and (min-device-width: 375px) and (max-device-height: 812px) and (orientation: landscape)","media-phone-landscape":"all and (max-height: 440px) and (orientation: landscape)","media-widgetbar-breakpoint":"all and (max-width: 1064px)","z-index-content-page":1,"z-index-chart-legend":6,"z-index-chart-right-corner-controls":7,"z-index-loading-screen":8,"z-index-dropdown":99,"z-index-toolbar-popup-menu":100,"z-index-tooltip":1000,"z-index-user-link-popup":900,"z-index-sticky-search-bar":101,"z-index-resizable-drawer":800,"disabled-state-opacity":0.5}')
}}]);