"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[6602],{76821:(e,t,o)=>{var i;o.d(t,{ToolboxType:()=>i}),function(e){e[e.Delete=0]="Delete"}(i||(i={}))},125119:(e,t,o)=>{o.r(t),o.d(t,{ActionsProvider:()=>ft,createActionCopyPrice:()=>vt,createActionOrder:()=>_t,createActionToggleVisibilityDataSources:()=>Tt,createActionTrade:()=>gt,createChangeIntervalsVisibilitiesAction:()=>yt,createDrawHorizontalLineAction:()=>wt,createLinesAction:()=>bt,createPasteAction:()=>St,createSyncDrawingActions:()=>Ct,createVisualOrderAction:()=>mt});var i=o(650151),n=o(671945),r=o(960521),s=o(144421),l=o(609838),a=o(534934),c=o(243716),d=o(29316),u=o(204162),h=o(515822),p=o(31015),g=(o(148565),o(765296)),_=o(132552),S=o(649008),m=o(718224),y=o(316144),v=o(30724),b=o(180185),C=o(76821),T=o(57086),w=o(492270),f=o(933613),I=o(597024),A=o(219847),B=o(851310),P=o(754617),x=o(363515),k=o(271706),F=o(991543),L=o(872547),W=o(577512),N=o(746399),E=o(894382),M=o(86853),O=o(952285),D=o(254537),V=o(932540),R=o(17076);const U=(0,n.getLogger)("Chart.ActionsProvider"),j=new P.TranslatedString("change visibility",l.t(null,void 0,o(201924))),q=new P.TranslatedString("pin to scale {label}",l.t(null,void 0,o(981566))),H=new P.TranslatedString("pin to right scale",l.t(null,void 0,o(607495))),z=new P.TranslatedString("pin to left scale",l.t(null,void 0,o(778690))),Q=(new P.TranslatedString("change earnings visibility",l.t(null,void 0,o(706819))),new P.TranslatedString("change dividends visibility",l.t(null,void 0,o(753929))),new P.TranslatedString("change splits visibility",l.t(null,void 0,o(347474))),new P.TranslatedString("change continuous contract switch visibility",l.t(null,void 0,o(818867))),new P.TranslatedString("change futures contract expiration visibility",l.t(null,void 0,o(585532))),new P.TranslatedString("change latest news and Minds visibility",l.t(null,void 0,o(350243))),new P.TranslatedString("show all ideas",l.t(null,void 0,o(13336)))),G=new P.TranslatedString("show ideas of followed users",l.t(null,void 0,o(791395))),Y=new P.TranslatedString("show my ideas only",l.t(null,void 0,o(757460))),$=(new P.TranslatedString("change events visibility on chart",l.t(null,void 0,o(906119))),new P.TranslatedString("add this symbol to entire layout",l.t(null,void 0,o(679290)))),J=new P.TranslatedString("add this indicator to entire layout",l.t(null,void 0,o(96677))),Z=(new P.TranslatedString("add this strategy to entire layout",l.t(null,void 0,o(358156))),new P.TranslatedString("add this financial metric to entire layout",l.t(null,void 0,o(267608))),
new P.TranslatedString("lock objects",l.t(null,void 0,o(18942)))),K=new P.TranslatedString("unlock objects",l.t(null,void 0,o(823230))),X=new P.TranslatedString("anchor objects",l.t(null,void 0,o(663869))),ee=new P.TranslatedString("unanchor objects",l.t(null,void 0,o(199234))),te=new P.TranslatedString("change visibility at current interval and above",l.t(null,void 0,o(545800))),oe=new P.TranslatedString("change visibility at current interval and below",l.t(null,void 0,o(175645))),ie=new P.TranslatedString("change visibility at current interval",l.t(null,void 0,o(584331))),ne=new P.TranslatedString("change visibility at all intervals",l.t(null,void 0,o(557916))),re=l.t(null,void 0,o(366823)),se=(0,B.appendEllipsis)(l.t(null,void 0,o(800264))),le=l.t(null,void 0,o(698334)),ae=l.t(null,void 0,o(327298)),ce=l.t(null,void 0,o(703564)),de=l.t(null,void 0,o(794559)),ue=l.t(null,void 0,o(702165)),he=l.t(null,void 0,o(16986)),pe=l.t(null,void 0,o(312645)),ge=l.t(null,void 0,o(544579)),_e=l.t(null,void 0,o(429436)),Se=l.t(null,void 0,o(81054)),me=l.t(null,void 0,o(32538)),ye=l.t(null,void 0,o(172046)),ve=l.t(null,void 0,o(590095)),be=l.t(null,void 0,o(14115)),Ce=l.t(null,void 0,o(233110)),Te=l.t(null,void 0,o(928280)),we=l.t(null,void 0,o(676150)),fe=l.t(null,void 0,o(694210)),Ie=l.t(null,void 0,o(960035)),Ae=l.t(null,void 0,o(210761)),Be=l.t(null,void 0,o(411254)),Pe=l.t(null,void 0,o(635049)),xe=l.t(null,void 0,o(319271)),ke=l.t(null,void 0,o(715512)),Fe=l.t(null,void 0,o(546545)),Le=l.t(null,void 0,o(752160)),We=l.t(null,void 0,o(417293)),Ne=l.t(null,void 0,o(21973)),Ee=l.t(null,void 0,o(55481)),Me=l.t(null,void 0,o(171179)),Oe=l.t(null,void 0,o(804077)),De=l.t(null,void 0,o(754853)),Ve=l.t(null,void 0,o(720177)),Re=l.t(null,void 0,o(700494)),Ue=l.t(null,void 0,o(960668)),je=l.t(null,void 0,o(858026)),qe=l.t(null,void 0,o(156982)),He=((0,B.appendEllipsis)(l.t(null,void 0,o(235088))),(0,B.appendEllipsis)(l.t(null,void 0,o(702439))),(0,B.appendEllipsis)(l.t(null,void 0,o(232514)))),ze=l.t(null,void 0,o(178358)),Qe=(0,B.appendEllipsis)(l.t(null,void 0,o(276266))),Ge=l.t(null,void 0,o(249680)),Ye=l.t(null,void 0,o(712537)),$e=l.t(null,void 0,o(93553)),Je=l.t(null,void 0,o(774975)),Ze=l.t(null,void 0,o(999894)),Ke=l.t(null,void 0,o(205837)),Xe=l.t(null,void 0,o(24185)),et=(l.t(null,void 0,o(537113)),l.t(null,void 0,o(629449)),l.t(null,void 0,o(350849)),l.t(null,void 0,o(833158)),l.t(null,void 0,o(81465)),l.t(null,void 0,o(62986)),l.t(null,void 0,o(555418))),tt=l.t(null,void 0,o(510261)),ot=l.t(null,void 0,o(644020)),it=((0,B.appendEllipsis)(l.t(null,void 0,o(232514))),l.t(null,void 0,o(897878)),l.t(null,void 0,o(239010))),nt=l.t(null,void 0,o(326090)),rt=(l.t(null,void 0,o(995754)),l.t(null,void 0,o(535679)),l.t(null,void 0,o(709140))),st=l.t(null,void 0,o(846607)),lt=(l.t(null,void 0,o(639079)),(0,B.appendEllipsis)(l.t(null,void 0,o(975594)))),at=(0,
B.appendEllipsis)(l.t(null,void 0,o(288853))),ct=l.t(null,void 0,o(735140)),dt=l.t(null,void 0,o(163553)),ut=l.t(null,void 0,o(792957)),ht=l.t(null,void 0,o(858764)),pt=(l.t(null,void 0,o(910996)),l.t(null,void 0,o(903061)),!0);async function gt(e,t,o){if(It(e))return null;const i=e.model().mainSeries();i.symbolInfo();if(i.isConvertedToOtherCurrency()||i.isConvertedToOtherUnit())return null;const n=async()=>{const t=(0,g.tradingService)();if(null===t||0===(await t.brokersMetainfo()).length)return[];const i=e.model().mainSeries();let n;o&&(n=o.localY);try{const e=await(0,_.createTradeContext)({series:i,y:n,isMainChart:!0});return await t.chartContextMenuActions(e,{hideNotExecutableAction:!0})}catch(e){return U.logError(e.message),[]}};if(pt)return n();const r=await n();if(r.length>0){const e=()=>new Promise(((e,t)=>{0!==r.length?e({name:"trade",label:re,subItems:r,statName:"Trading"}):e({label:re,disabled:!0})}));return[new c.Action({actionId:"Trading.TradeFromChart",options:{},optionsLoader:()=>(0,S.makeTimeLimited)(e(),5e3,"Action trade not received")})]}return null}function _t(e){const t=(0,i.ensureNotNull)((0,g.tradingService)());return new O.ActionWithStandardIcon({actionId:"Chart.LineTool.CreateLimitOrderFromState",options:{label:se,statName:"CreateLimitOrder",onExecute:()=>{t.trackEvent("Chart Context Menu","RiskRewardCreateLimitOrder"),(0,i.ensureNotNull)(t.brokerCommandsUI()).placeOrder(e)}}})}function St(e,t){return!t.isEmpty()&&a.enabled("datasource_copypaste")?new O.ActionWithStandardIcon({actionId:"Chart.Clipboard.PasteSource",options:{label:ct.trim(),shortcutHint:(0,b.humanReadableHash)(b.Modifiers.Mod+86),statName:"Paste",onExecute:()=>e.chartWidgetCollection().clipboard.uiRequestPaste(t)}}):null}function mt(e,t){const o=e.model(),i=o.availableZOrderOperations(t),n=[new O.ActionWithStandardIcon({actionId:"Chart.Source.VisualOrder.BringToFront",options:{label:We,statName:"BringToFront",disabled:!i.bringToFrontEnabled,onExecute:()=>o.bringToFront(t)}}),new O.ActionWithStandardIcon({actionId:"Chart.Source.VisualOrder.SendToBack",options:{label:Ne,statName:"SendToBack",disabled:!i.sendToBackEnabled,onExecute:()=>o.sendToBack(t)}}),new O.ActionWithStandardIcon({actionId:"Chart.Source.VisualOrder.BringForward",options:{label:Ee,statName:"BringForward",disabled:!i.bringForwardEnabled,onExecute:()=>o.bringForward(t)}}),new O.ActionWithStandardIcon({actionId:"Chart.Source.VisualOrder.SendBackward",options:{label:Me,statName:"SendBackward",disabled:!i.sendBackwardEnabled,onExecute:()=>o.sendBackward(t)}})];return new O.ActionWithStandardIcon({actionId:"Chart.Source.VisualOrder",options:{label:Oe,iconId:"Chart.VisualOrder",statName:"VisualOrder",subItems:n}})}function yt(e,t){const o=e.model(),i=(e,i)=>{const n=k.Interval.parse(o.mainSeries().interval()),r=(0,L.getIntervalsVisibilitiesForMode)(n,e),s=[],l=[];t.forEach((e=>{const t=e.properties().intervalsVisibilities.childs();s.push(t.ticks),l.push(r.ticks),s.push(t.seconds),l.push(r.seconds),s.push(t.secondsFrom),l.push(r.secondsFrom),s.push(t.secondsTo),
l.push(r.secondsTo),s.push(t.minutes),l.push(r.minutes),s.push(t.minutesFrom),l.push(r.minutesFrom),s.push(t.minutesTo),l.push(r.minutesTo),s.push(t.hours),l.push(r.hours),s.push(t.hoursFrom),l.push(r.hoursFrom),s.push(t.hoursTo),l.push(r.hoursTo),s.push(t.days),l.push(r.days),s.push(t.daysFrom),l.push(r.daysFrom),s.push(t.daysTo),l.push(r.daysTo),s.push(t.weeks),l.push(r.weeks),s.push(t.weeksFrom),l.push(r.weeksFrom),s.push(t.weeksTo),l.push(r.weeksTo),s.push(t.months),l.push(r.months),s.push(t.monthsFrom),l.push(r.monthsFrom),s.push(t.monthsTo),l.push(r.monthsTo),s.push(t.ranges),l.push(r.ranges)})),o.setProperties(s,l,i,(0,M.sourcesAffectState)(t))},n=[new O.ActionWithStandardIcon({actionId:"Chart.Source.IntervalsVisibility.CurrentAndAbove",options:{label:Ve,statName:"currentAndAboveIntervals",onExecute:()=>i(3,te)}}),new O.ActionWithStandardIcon({actionId:"Chart.Source.IntervalsVisibility.CurrentAndBelow",options:{label:Re,statName:"currentAndBelowIntervals",onExecute:()=>i(2,oe)}}),new O.ActionWithStandardIcon({actionId:"Chart.Source.IntervalsVisibility.Current",options:{label:Ue,statName:"currentInterval",onExecute:()=>i(1,ie)}}),new O.ActionWithStandardIcon({actionId:"Chart.Source.IntervalsVisibility.All",options:{label:je,statName:"allIntervals",onExecute:()=>i(0,ne)}})];return new O.ActionWithStandardIcon({actionId:"Chart.Source.IntervalsVisibility",options:{label:De,statName:"IntervalsVisibility",subItems:n}})}function vt(e,t){const o=e.defaultPriceScale(),i=void 0!==t?o.coordinateToPrice(t,e.mainDataSource()?.firstValue()??0):e.model().mainSeries().lastValueData(4,!0,!0).price,n=e.mainDataSource()?.formatter();if(void 0===i||!n)return null;const r=n.format(i),s=n.format(i,{ignoreLocaleNumberFormat:!0,noExponentialForm:!0});return new O.ActionWithStandardIcon({actionId:"Chart.Clipboard.CopyPrice",options:{label:`${dt} ${r}`,statName:"CopyPrice",onExecute:()=>(0,W.getClipboard)().writeText(s)}})}function bt(e){const t=e.actions(),o=[t.showPriceLine];return o.push(t.showSeriesPrevCloseLine),a.enabled("pre_post_market_price_line")&&o.push(t.showPrePostMarketPriceLine),o.push(t.showHighLowPriceLines),a.enabled("show_average_close_price_line_and_label")&&o.push(t.showAverageClosePriceLine),e.model().model().hasCustomSource("bidask")&&o.push(t.showBidAskLines),new O.ActionWithStandardIcon({actionId:"Chart.Lines",options:{label:qe,statName:"Lines",subItems:o}})}function Ct(e,t){const o=[];{if(x.isToolCreatingNow.value())return o;const i=()=>e.chartWidgetCollection().activeChartWidget.value()??e,n=()=>t.some((e=>e.isSynchronizable()));if(a.enabled("support_multicharts")&&e.isMultipleLayout().value()||a.enabled("saveload_separate_drawings_storage")){if(!n())return o;const r=t.every((e=>!!e.linkKey().value())),s=a.enabled("saveload_separate_drawings_storage"),l=e.model();let c=t[0].sharingMode().value();c=t.every((e=>e.sharingMode().value()===c))?c:null,o.push(new O.ActionWithStandardIcon({actionId:"Chart.LineTool.NoSync",options:{label:rt,statName:"NoSyncDrawing",checkable:!0,checked:s?0===c:!r,onExecute:e=>{
s?e.isChecked()&&l.shareLineTools(t,0):e.isChecked()&&i().unlinkSelectedLine()}}}),new O.ActionWithStandardIcon({actionId:"Chart.LineTool.SyncInLayout",options:{label:st,statName:"SyncDrawingInLayout",checkable:!0,checked:s?1===c:r,onExecute:e=>{s?e.isChecked()&&l.shareLineTools(t,1):e.isChecked()&&i().copyLineToOtherCharts()}}}))}}return o}function Tt(e,t){const o=t[0].properties().visible.value(),i=o?ae:le,n=o?"Chart.Hide":"Chart.ShowObject",r=o?"Chart.SelectedObject.Hide":"Chart.SelectedObject.Show";return new O.ActionWithStandardIcon({actionId:r,options:{checkable:!0,statName:"ToggleVisibilitySelectedObject",label:i,iconId:n,onExecute:()=>{const i=e.model();i.withMacro(j,(()=>{t.forEach((e=>{i.setProperty(e.properties().visible,!o,j,F.lineToolsDoNotAffectChartInvalidation&&(0,I.isLineTool)(e))}))}))}}})}function wt(e,t,n){let r;if(n)r=n.price;else{const o=e.crosshairSource();r=e.model().magnet().align(o.price,o.index,t)}const s=(0,i.ensureNotNull)(t.mainDataSource()).formatter().format(r);return new O.ActionWithStandardIcon({actionId:"Chart.Crosshair.PlusButton.DrawHorizontalLine",options:{label:l.t(null,{replace:{price:s}},o(856916)),statName:"DrawHorizontalLineAtPrice",iconId:"Chart.AddHorzLine",shortcutHint:(0,b.humanReadableHash)(b.Modifiers.Alt+72),onExecute:async()=>{await(0,D.ensureLineToolLoaded)("LineToolHorzLine"),e.drawRightThere("LineToolHorzLine",t,n,"ContextMenu")}}})}class ft{constructor(e,t){this._chartWidget=e,this._options=(0,s.merge)((0,s.clone)(V.defaultChartWidgetActionsOptions),t||{})}async contextMenuActionsForSources(e,t,o,n,r){const s=e[0],l=this._options,a=[];if(s===this._chartWidget.model().mainSeries()&&l.mainSeries)a.push(...await this._contextMenuActionsForSeries(s,o));else if((0,h.isStudy)(s)&&l.studies)a.push(...await this._contextMenuActionsForStudy(s,(0,i.ensureDefined)(t),o));else if((s instanceof m.LineToolOrder||s instanceof y.LineToolPosition)&&l.ordersAndPositions)a.push(...this._contextMenuActionsForTradingDrawings(s));else if((0,I.isLineTool)(s)&&l.lineTools){const t=e.filter(I.isLineTool);a.push(...await this._contextMenuActionsForLineTool(t))}else 0;return a.length&&r?.length&&a.push(new c.Separator),a.push(...r??[]),a}async actionForLineTools(e,t){switch(t){case"Chart.SelectedObject.ToggleAnchored":return this._createActionToggleAnchorLineTools(e);case"Chart.SelectedObject.InsertRowTable":{if(1!==e.length)return null;const t=e[0];return((await(t.additionalActions?.(this._chartWidget.model())))?.actions??[]).filter((e=>"action"===e.type&&"Chart.SelectedObject.InsertRowTable"===e.getState().actionId))[0]??null}case"Chart.SelectedObject.InsertColumnTable":{if(1!==e.length)return null;const t=e[0];return((await(t.additionalActions?.(this._chartWidget.model())))?.actions??[]).filter((e=>"action"===e.type&&"Chart.SelectedObject.InsertColumnTable"===e.getState().actionId))[0]??null}}throw new Error(`Unsupported actionId: ${t}`)}_isReadOnly(){return this._chartWidget.readOnly()}_createActionScale(e){const t=(0,
i.ensureNotNull)(e.priceScale()),o=this._chartWidget.model().model(),n=(0,i.ensureNotNull)(o.paneForSource(e)),r=n.priceScalePosition(t),s=("left"===r?n.leftPriceScales():n.rightPriceScales()).indexOf(t),l=o.priceScaleSlotsCount().totallySlots<2?"dontneedname":"needname",a="overlay"===r?"":(0,d.getPriceAxisNameInfo)(r,s).label,c=we.format({label:a}),u={"left-needname":c,"left-dontneedname":Ie,"right-needname":c,"right-dontneedname":Ae,"overlay-needname":fe,"overlay-dontneedname":fe}[r+"-"+l];return new O.ActionWithStandardIcon({actionId:"Chart.Source.ChangePriceScale",options:{label:u,iconId:"Chart.PriceScale",subItems:this._createActionScaleItems(e)}})}_createActionResetInputPoints(e){const t=e.metaInfo(),i=t.inputs.filter(N.isTimeOrPriceNotHiddenInput);return 0===i.length?null:new O.ActionWithStandardIcon({actionId:"Chart.Source.ResetInputPoints",options:{label:at,onExecute:async()=>{let n;try{const r=e.properties().childs().inputs.state();for(const e of Object.keys(r))i.find((t=>t.id===e))||delete r[e];const s=new E.Property({inputs:r}),l=await Promise.all([o.e(5234),o.e(8185),o.e(1681),o.e(3039),o.e(5371),o.e(6612),o.e(8883),o.e(8894),o.e(2937),o.e(8933),o.e(3672),o.e(5563),o.e(3359),o.e(5743),o.e(2647),o.e(1171),o.e(2537),o.e(3425),o.e(8752),o.e(4587),o.e(7833),o.e(8158),o.e(3329),o.e(4391),o.e(1697),o.e(9487),o.e(9117),o.e(6052),o.e(1513),o.e(874),o.e(442),o.e(4943),o.e(445),o.e(1200),o.e(5994),o.e(7702),o.e(3485),o.e(8220),o.e(9965),o.e(9590),o.e(5448),o.e(3361),o.e(115),o.e(4248),o.e(2227),o.e(4952),o.e(4134),o.e(7125),o.e(6333),o.e(9643),o.e(7417),o.e(7195),o.e(3030)]).then(o.bind(o,759393));n=(await l.selectInputValuesOnChart(this._chartWidget,i,s,t.shortDescription,t.inputs)).customSourceId,e.properties().mergeAndFire(s.state())}finally{void 0!==n&&this._chartWidget.model().model().removeCustomSource(n)}}}})}_createActionLayoutChartsSync(){return new LayoutChartsSyncContextMenuAction(this._chartWidget.linkingGroupIndex().readonly(),(e=>this._chartWidget.model().setLinkingGroupIndex(e)))}_createActionScaleDetach(e,t,o,n){const r=this._chartWidget.model().model(),s=(0,i.ensureNotNull)(r.paneForSource(e));if(!s.canCreateNewPriceScale())return null;const l=(0,i.ensureNotNull)(e.priceScale()),a=l.canDetachSource(e),c=s.priceScalePosition(l),u=a||c!==t;if(!u)return null;const h=r.priceScaleSlotsCount(),p={left:{labelled:_e,sided:Ce},right:{labelled:_e,sided:Te}},g="left"===t?s.leftPriceScales().length:s.rightPriceScales().length,_=h[t]>g?"labelled":"sided",S=(0,d.getPriceAxisNameInfo)(t,g).label,m=p[t][_].format({label:S});return new O.ActionWithStandardIcon({actionId:"Chart.Source.ChangePriceScale",options:{checkable:!1,disabled:!u,label:m,statName:n,payload:e,onExecute:o}})}_onDetachLeft(e){const t=e.getPayload(),o=this._chartWidget.model().model(),n=(0,i.ensureNotNull)(o.paneForSource(t));this._chartWidget.model().detachToLeft(t,n)}_onDetachRight(e){const t=e.getPayload(),o=this._chartWidget.model().model(),n=(0,i.ensureNotNull)(o.paneForSource(t));this._chartWidget.model().detachToRight(t,n)}
_createActionScaleDetachLeft(e){return this._createActionScaleDetach(e,"left",this._onDetachLeft.bind(this),"ToggleScaleLeft")}_createActionScaleDetachRight(e){return this._createActionScaleDetach(e,"right",this._onDetachRight.bind(this),"ToggleScaleRight")}_onMoveToScale(e){const t=e.getPayload();if(t.datasource.priceScale()===t.priceScale)return;const o=this._chartWidget.model().model(),n=(0,i.ensureNotNull)(o.paneForSource(t.datasource));this._chartWidget.model().moveToScale(t.datasource,n,t.priceScale,t.undoText)}_createMoveToScaleAction(e,t,o,i){const n=e.priceScale()===t;return new O.ActionWithStandardIcon({actionId:"Chart.Source.MoveToOtherScale",options:{checkable:!0,checked:n,label:o,statName:"ToggleScale",payload:{datasource:e,priceScale:t,undoText:i},onExecute:this._onMoveToScale.bind(this)}})}_onNoScale(e){const t=e.getPayload().datasource,o=this._chartWidget.model().model(),n=(0,i.ensureNotNull)(o.paneForSource(t));n.isOverlay(t)||this._chartWidget.model().detachNoScale(t,n)}_createActionNoScale(e){const t=this._chartWidget.model().model(),o=(0,i.ensureNotNull)(t.paneForSource(e)),n=o.actionNoScaleIsEnabled(e);return new O.ActionWithStandardIcon({actionId:"Chart.Source.MoveToNoScale",options:{checkable:!0,checked:o.isOverlay(e),label:Be,disabled:!n,statName:"ToggleNoScale",payload:{datasource:e},onExecute:this._onNoScale.bind(this)}})}_createActionScaleItems(e){const t=[],o=this._chartWidget.model().model(),n=(0,i.ensureNotNull)(o.paneForSource(e)),r=o.priceScaleSlotsCount().totallySlots>1,s=n.rightPriceScales(),l=n.leftPriceScales(),a=this._createActionScaleDetachRight(e),u=this._createActionScaleDetachLeft(e),h=s.length+l.length+(null===a?0:1)+(null===u?0:1)>2,p={right:{hidden:{checked:{labelled:ce,sided:de},unchecked:{labelled:ue,sided:he}},visible:{checked:{labelled:pe,sided:ge},unchecked:{labelled:_e,sided:Se}}},left:{hidden:{checked:{labelled:ce,sided:me},unchecked:{labelled:ue,sided:ye}},visible:{checked:{labelled:pe,sided:ve},unchecked:{labelled:_e,sided:be}}}},g={right:H,left:z},_={left:n.visibleLeftPriceScales(),right:n.visibleRightPriceScales()},S=(t,o)=>{const i=("right"===o?s:l)[t],n=_[o].includes(i)?"visible":"hidden",a=e.priceScale()===i?"checked":"unchecked",c=r?"labelled":"sided",u=p[o],h=(0,d.getPriceAxisNameInfo)(o,t).label;return{actionText:u[n][a][c].format({label:h}),undoText:r?q.format({label:h}):g[o]}};t.push(...s.map(((t,o)=>{const i=S(o,"right");return this._createMoveToScaleAction(e,t,i.actionText,i.undoText)}))),null!==a&&t.push(a);h&&(s.length>0||null!==a)&&t.push(new c.Separator);t.push(...l.map(((t,o)=>{const i=S(o,"left");return this._createMoveToScaleAction(e,t,i.actionText,i.undoText)}))),null!==u&&t.push(u);h&&(l.length>0||null!==u)&&t.push(new c.Separator);return t.push(this._createActionNoScale(e)),t}_createActionMergeUp(e){const t=this._chartWidget.model();return t.model().isMergeUpAvailableForSource(e)?new O.ActionWithStandardIcon({actionId:"Chart.Source.MergeUp",options:{label:xe,statName:"MergeUp",onExecute:()=>t.mergeSourceUp(e)}}):null}_createActionUnmergeUp(e){
const t=this._chartWidget.model();return t.model().isUnmergeAvailableForSource(e)?new O.ActionWithStandardIcon({actionId:"Chart.Source.UnmergeUp",options:{label:ke,statName:"UnmergeUp",onExecute:()=>t.unmergeSourceUp(e)}}):null}_createActionMergeDown(e){const t=this._chartWidget.model();return t.model().isMergeDownAvailableForSource(e)?new O.ActionWithStandardIcon({actionId:"Chart.Source.MergeDown",options:{label:Fe,statName:"MergeDown",onExecute:()=>t.mergeSourceDown(e)}}):null}_createActionUnmergeDown(e){const t=this._chartWidget.model();return t.model().isUnmergeAvailableForSource(e)?new O.ActionWithStandardIcon({actionId:"Chart.Source.UnmergeDown",options:{label:Le,statName:"UnmergeDown",onExecute:()=>t.unmergeSourceDown(e)}}):null}_mergeContentMenuItems(e){return[this._createActionMergeUp(e),this._createActionUnmergeUp(e),this._createActionMergeDown(e),this._createActionUnmergeDown(e)].filter(s.notNull)}_createActionMove(e){const t=this._mergeContentMenuItems(e);return t.length>0?new O.ActionWithStandardIcon({actionId:"Chart.Source.MoveToPane",options:{label:Pe,iconId:"Chart.Move",subItems:t}}):null}async _createDetailsMetricsAction(e){return null}async _contextMenuActionsForSeries(e,t){const o=[],n=this._chartWidget.model().model(),r=(0,i.ensureNotNull)(n.paneForSource(e)),s=this._chartWidget.actions(),l=t&&"localY"in t?t.localY:void 0;if(this._isReadOnly())o.push(Tt(this._chartWidget,[e])),o.push(new c.Separator),o.push(this._createActionScale(e));else{if(this._options.mainSeriesTrade&&pt){const e=await async function(e,t){if(It(e))return null;const o=e.model().mainSeries();if(o.symbolInfo(),o.isConvertedToOtherCurrency()||o.isConvertedToOtherUnit())return null;const i=(0,g.tradingService)();if(null===i||0===(await i.brokersMetainfo()).length)return[];try{const e=await(0,_.createTradeContext)({series:o,y:t,isMainChart:!0});return[await i.chartSeriesContextMenuAction(e)]}catch(e){return U.logError((0,R.getLoggerMessage)(e)),[]}}(this._chartWidget,l);null!==e&&o.push(...e)}if(this._options.mainSeriesTrade&&!pt){const e=await gt(this._chartWidget);null!==e&&o.push(...e)}o.length>0&&!(o[o.length-1]instanceof c.Separator)&&o.push(new c.Separator),a.enabled("symbol_info")&&o.push(s.showSymbolInfoDialog);const t=await this._createDetailsMetricsAction(e);if(t&&o.push(t),o.length>0&&!(o[o.length-1]instanceof c.Separator)&&o.push(new c.Separator),!r.isEmpty()&&a.enabled("datasource_copypaste")){const e=vt(r,l),t=St(this._chartWidget,r);(e||t)&&(e&&o.push(e),t&&o.push(t),o.push(new c.Separator))}o.push(mt(this._chartWidget,[e]));const i=this._createActionMove(e);null!==i&&o.push(i),o.push(this._createActionScale(e)),o.push(Tt(this._chartWidget,[e])),o.push(new c.Separator),s.addToWatchlist&&(s.addToWatchlist.prepare(),o.push(s.addToWatchlist)),a.enabled("text_notes")&&o.push(s.addToTextNotes),o[o.length-1]instanceof c.Separator||o.push(new c.Separator),a.enabled("show_chart_property_page")&&!this._chartWidget.onWidget()&&o.push(s.mainSeriesPropertiesAction),o[o.length-1]instanceof c.Separator&&o.pop()}return o}
_createActionAddChildStudy(e){throw new Error("unsupported")}_createActionAddFundamentals(e){return null}_createActionShowSymbolInfoDialog(e,t){const o=this._chartWidget.model().model();return new O.ActionWithStandardIcon({actionId:"Chart.Dialogs.ShowSymbolInfo",options:{label:lt,iconId:"Chart.SymbolInfo",checkable:!1,statName:"SymbolInfo",onExecute:()=>{const i={symbolInfo:e.symbolInfo(),unitDescription:e=>e?t.description(e):"",dateFormatter:o.dateFormatter()};(0,w.showSymbolInfoDialog)(i)}}})}_createActionShowProperties(e){return new O.ActionWithStandardIcon({actionId:"Chart.Indicator.ShowSettingsDialog",options:{label:He,iconId:"Settings",statName:"EditSelectedObject",onExecute:()=>this._chartWidget.showSourceProperties(e)}})}async _contextMenuActionsForStudy(e,t,o){const i=t!==this._chartWidget.model().paneForSource(e),n=this._chartWidget.actions(),r=(o&&"localY"in o&&o.localY,[]);if(!e.userEditEnabled())return r;if(this._chartWidget.readOnly())r.push(Tt(this._chartWidget,[e])),r.push(new c.Separator),e.isLinkedToSeries()||r.push(this._createActionScale(e));else{0,a.enabled("study_on_study")&&e.canHaveChildren()&&r.push(this._createActionAddChildStudy(e));const t=this._createApplyToEntireLayoutCommand(e);null!==t&&r.push(t);const o=this._createAddIndicatorToFavoritesCommand(e);if(o&&r.push(o),r.length>0&&!(r[r.length-1]instanceof c.Separator)&&r.push(new c.Separator),a.enabled("symbol_info")&&(0,h.isCompareOrOverlayStudy)(e)&&null!==e.symbolInfo()&&(r.push(this._createActionShowSymbolInfoDialog(e,this._chartWidget.model().model().availableUnits())),r.push(new c.Separator)),i||r.push(mt(this._chartWidget,[e])),r.push(yt(this._chartWidget,[e])),!e.isLinkedToSeries()&&!i){const t=this._createActionMove(e);null!==t&&r.push(t),r.push(this._createActionScale(e))}r.push(new c.Separator);const s=e.metaInfo();if(e.copiable()){const t=new O.ActionWithStandardIcon({actionId:"Chart.Clipboard.CopySource",options:{label:Ge,shortcutHint:(0,b.humanReadableHash)(b.Modifiers.Mod+67),statName:"Copy",onExecute:()=>{this._chartWidget.chartWidgetCollection().clipboard.uiRequestCopy([e])}}});r.push(t)}r.push(Tt(this._chartWidget,[e])),r.push(n.studyRemove);Boolean(window.widgetbar?.widget("watchlist"))&&(0,h.isCompareOrOverlayStudy)(e)&&(0,A.isActingAsSymbolSource)(e)&&r.push(new c.Separator,(0,v.createAddToWatchList)(e.symbol(),{hotkeyHash:void 0}));this._options.objectTree&&n.paneObjectTree&&r.push(new c.Separator,n.paneObjectTree),a.enabled("property_pages")&&new p.MetaInfoHelper(s).hasUserEditableOptions()&&r.push(new c.Separator,this._createActionShowProperties(e)),r[r.length-1]instanceof c.Separator&&r.pop()}return r}_createLineToolTemplateAction(e){if(0===e.length)return null;{if(e.reduce(((e,t)=>e.add(t.toolname)),new Set).size>1)return null;const t=this._chartWidget.model(),i=o=>{t.applyLineToolsTemplate({data:o,sources:e})};return new c.Action({actionId:"Chart.LineTool.Templates",options:{},optionsLoader:async()=>{
const{LinetoolTemplatesList:n}=await Promise.all([o.e(8541),o.e(3054),o.e(6212),o.e(3177)]).then(o.bind(o,591421)),r=new n(e[0].toolname,i),s=[];if(a.enabled("drawing_templates")&&1===e.length){const t=new O.ActionWithStandardIcon({actionId:"Chart.LineTool.Templates.SaveAs",options:{label:Qe,statName:"SaveAs",onExecute:()=>{r.showSaveDialog((t=>{const o=JSON.stringify(e[0].template());r.saveTemplate(t,o)}))}}});s.push(t)}const l=new O.ActionWithStandardIcon({actionId:"Chart.LineTool.Templates.ApplyDefaults",options:{label:ze,statName:"ApplyDefault",onExecute:()=>{t.restoreLineToolsFactoryDefaults(e),window.lineToolPropertiesToolbar.refresh()}}});return s.push(l),new Promise((e=>{r.templatesLoaded().then((()=>{const e=r.getData()??[];e.length>0&&s.push(new c.Separator),e.forEach(((e,t)=>{const o=new O.ActionWithStandardIcon({actionId:"Chart.LineTool.Templates.Apply",options:{label:e,statName:"ApplyTemplate",onExecute:()=>r.loadTemplate(e),toolbox:{type:C.ToolboxType.Delete,action:()=>{r.deleteAction(e)}},showToolboxOnHover:!0}});s.push(o)}))}),(e=>{U.logWarn(e)})).then((()=>{e({label:$e,statName:"Template",subItems:s})}))}))}})}}_createActionToggleLockLineTools(e){const t=e[0].properties().frozen.value(),o=t?Ze:Ke;return new O.ActionWithStandardIcon({actionId:"Chart.SelectedObject.ToggleLocked",options:{label:o,statName:"ToggleLockSelectedObject",checkable:!0,iconId:t?"Chart.UnlockObject":"Chart.LockObject",onExecute:()=>{if(1===e.length)this._chartWidget.toggleLockSelectedObject();else{const o=t?K:Z,i=this._chartWidget.model();i.withMacro(o,(()=>{e.forEach((e=>{i.setProperty(e.properties().frozen,!t,o,F.lineToolsDoNotAffectChartInvalidation)}))}))}}}})}_createActionToggleAnchorLineTools(e){const t=e.filter((e=>e.anchorable()));if(0===t.length)return null;const o=t[0].properties().anchored.value();return new O.ActionWithStandardIcon({actionId:"Chart.SelectedObject.ToggleAnchored",options:{label:Xe,statName:"ToggleAnchoredSelectedObject",checkable:!0,checked:o,onExecute:()=>{const e=o?ee:X,i=this._chartWidget.model();i.withMacro(e,(()=>{t.forEach((t=>{i.setProperty(t.properties().childs().anchored,!o,e,F.lineToolsDoNotAffectChartInvalidation)}))}))}}})}async _contextMenuActionsForLineTool(e){const t=[],o=this._chartWidget.actions(),i=this._chartWidget.model().model(),n=()=>{t.push(mt(this._chartWidget,e))},s=()=>{t.push(yt(this._chartWidget,e))},l=()=>{const o=e.filter((e=>e.cloneable()));if(o.length>0){const e=new O.ActionWithStandardIcon({actionId:"Chart.LineTool.Clone",options:{label:Ye,iconId:"Chart.Clone",shortcutHint:(0,b.humanReadableModifiers)(b.Modifiers.Mod)+"Drag",statName:"Clone",onExecute:()=>this._chartWidget.model().cloneLineTools(o,!1)},id:"Clone"});t.push(e)}return!!o.length},d=()=>{const o=e.filter((e=>e.copiable()));if(o.length>0){const e=new c.Action({actionId:"Chart.Clipboard.CopyLineTools",options:{label:Ge,shortcutHint:(0,b.humanReadableHash)(b.Modifiers.Mod+67),statName:"Copy",onExecute:()=>this._chartWidget.chartWidgetCollection().clipboard.uiRequestCopy(o)},id:"Copy"});t.push(e)}
return!!o.length},h=()=>{const o=Ct(this._chartWidget,e);return t.push(...o),o.length>0},p=async e=>{if(It(this._chartWidget))return;const o=e.getOrderTemplate();if(null===o)return;const n=(0,g.tradingService)();if(null!==n){const e=n.activeBroker();if(e&&1===e.connectionStatus()&&e.metainfo().configFlags.supportLimitOrders){const s=i.mainSeries(),{symbol:l}=await n.getVisibleSymbol(s.proSymbol()),{tradable:a}=await e.isTradable(l);if(a){const{qty:{step:i}}=await e.symbolInfo(l);o.symbol=l,o.qty=function(e,t){return(0,r.Big)(e).div(t).round(void 0,0).mul(t).toNumber()}(o.qty,i),t.push(new c.Separator),t.push(_t(o))}}else 0}},_=e=>{const o=new O.ActionWithStandardIcon({actionId:"Chart.ScrollToLineTool",options:{label:Je.format({lineToolName:e.title(u.TitleDisplayTarget.StatusLine)}),statName:"GoToLineTool",checkable:!1,onExecute:async()=>this._chartWidget.model().scrollToLineTool(e)}});t.push(o)},S=e=>{const t=this._chartWidget.model().model().lineToolsGroupModel(),o=e.map((e=>t.groupForLineTool(e)));return new Set(o).size<=1};if(1===e.length){const i=e[0];let r={actions:[],placement:"CustomAction"};if(i.additionalActions&&(r=await i.additionalActions(this._chartWidget.model())),r.actions.length>0&&"BeforeAll"===r.placement&&(t.push(...r.actions),t.push(new c.Separator)),this._chartWidget.readOnly())t.push(Tt(this._chartWidget,[i]));else if(i.userEditEnabled()){0;{const e=this._createLineToolTemplateAction([i]);null!==e&&t.push(e)}n(),s(),this._options.objectTree&&o.paneObjectTree&&t.push(o.paneObjectTree),await p(i),t.push(new c.Separator);let e=l();e=d()||e,e&&t.push(new c.Separator),e=h(),e&&t.push(new c.Separator),r.actions.length>0&&"CustomAction"===r.placement&&(t.push(...r.actions),t.push(new c.Separator));const u=this._createActionToggleAnchorLineTools([i]);u&&(t.push(u),t.push(new c.Separator)),t.push(this._createActionToggleLockLineTools([i])),t.push(Tt(this._chartWidget,[i])),t.push(o.lineRemove),i.points().length>0&&this._options.gotoLineTool&&(t.push(new c.Separator),_(i));const g=await this._chartWidget.propertiesDefinitionsForSource(i);a.enabled("property_pages")&&null!==g&&(t.push(new c.Separator),t.push(o.format))}}else{const i=this._createLineToolTemplateAction(e);null!==i&&t.push(i),this._options.objectTree&&o.paneObjectTree&&t.push(o.paneObjectTree),S(e)&&n(),s(),t.length>0&&t.push(new c.Separator);let r=l();r=d()||r,r&&t.push(new c.Separator),r=h(),r&&t.push(new c.Separator),t.push(this._createActionToggleLockLineTools(e)),t.push(Tt(this._chartWidget,e)),t.push(o.lineRemove),a.enabled("property_pages")&&(t.push(new c.Separator),t.push(o.format))}return t}_createEarningsShow(){return null}_createDividendsShow(){return null}_createSplitsShow(){return null}_contextMenuActionsForESD(){return[]}_contextMenuActionsForRollDates(){return[]}_contextMenuActionsForFuturesContractExpiration(){return[]}_contextMenuActionsForisLatestUpdates(){return[]}_contextMenuActionsForPublishedTimeline(e){const t=this._chartWidget.actions(),o=[];if(o.push(t.lineHide),window.is_authenticated){
const t=e.properties().childs().filter,i=new c.Action({actionId:"Chart.ShowAllIdeas",options:{checked:t.value()===PublishedChartsFilter.None,checkable:!0,label:et,name:"ToggleAllIdeas",statName:"ToggleAllIdeas",onExecute:()=>this._chartWidget.model().setProperty(t,PublishedChartsFilter.None,Q)}}),n=new c.Action({actionId:"Chart.ShowIdeasOfFollowedUsers",options:{checked:t.value()===PublishedChartsFilter.Following,checkable:!0,label:tt,name:"ToggleIdeasOfPeopleAndUser",statName:"ToggleIdeasOfPeopleAndUser",onExecute:()=>this._chartWidget.model().setProperty(t,PublishedChartsFilter.Following,G)}}),r=new c.Action({actionId:"Chart.ShowMyIdeasOnly",options:{checked:t.value()===PublishedChartsFilter.Private,checkable:!0,label:ot,name:"ToggleUserIdeas",statName:"ToggleUserIdeas",onExecute:()=>this._chartWidget.model().setProperty(t,PublishedChartsFilter.Private,Y)}});o.push(new c.Separator,i,n,r)}return o}_contextMenuActionsForTradingDrawings(e){return e.contextMenuItems()}async _contextMenuActionsForAlertLabel(e,t){return[]}_contextMenuActionsForChartEvents(e){return[]}_createApplyToEntireLayoutCommand(e){if(!this._chartWidget.chartWidgetCollection().applyIndicatorsToAllChartsAvailable())return null;const t=this._chartWidget.model().model();if(e.parentSources().length>0)return null;const o=(0,i.ensureNotNull)(t.paneForSource(e)),n=t.paneForSource(t.mainSeries())===o,r=e instanceof T.StudyCompare&&e.priceScale()===t.mainSeries().priceScale()&&(0,i.ensureNotNull)(e.priceScale()).isPercentage(),s=n?void 0:t.panes().indexOf(o);let l=nt,a=J,d="AddStudyToEntireLayout";return(0,A.isActingAsSymbolSource)(e)&&(l=it,a=$,d="AddSymbolToEntireLayout"),new c.Action({actionId:"Chart.AddIndicatorToAllCharts",options:{label:l,statName:d,onExecute:()=>{const o=(0,i.ensureNotNull)((0,f.clipboardDataForSources)(t.id(),[e])),l=this._chartWidget.chartWidgetCollection(),c={isOnMainPane:n,asCompare:r,paneIndex:s};l.applyIndicatorToAllCharts(this._chartWidget,o,c,a)}},id:"applyStudyToEntireLayout"})}_createAddIndicatorToFavoritesCommand(e){const t=e.metaInfo();let i;if(!a.enabled("items_favoriting")||(0,h.isCompareOrOverlayStudy)(e))return null;{const{description_localized:e,description:n}=t,r=e||l.t(n,{context:"study"},o(783477));i=()=>o.e(9790).then(o.bind(o,181687)).then((({isFavorite:e,toggleFavorite:t})=>({label:e(r)?ht:ut,onExecute:()=>t(r)})))}return new O.ActionWithStandardIcon({actionId:"Chart.Indicator.AddFavorites",id:"addIndicatorToFavorites",optionsLoader:i,options:{statName:"AddIndicatorToFavorites",iconId:"Indicator.AddToFavorites"}})}}function It(e){return!1}},993200:(e,t,o)=>{o.d(t,{isCustomStudy:()=>n});const i={VbPFixed:!0,PivotPointsStandard:!0,VbPVisible:!0,VbPAnchored:!0};function n(e){return e in i}},31015:(e,t,o)=>{o.d(t,{MetaInfoHelper:()=>h});var i=o(650151),n=o(671945),r=o(912133),s=o(485834),l=o(144421),a=o(746399);function c(e){return!e.groupId&&!e.isHidden&&e.id!==a.RangeDependentStudyInputNames.FirstBar&&e.id!==a.RangeDependentStudyInputNames.LastBar}var d=o(993200);const u=(0,
n.getLogger)("Platform.GUI.PropertyDialog.Indicators.MetaInfo");class h{constructor(e){this._metaInfo=e}hasUserEditableInputs(){return this._metaInfo.inputs.some(c)}getUserEditableInputs(){return this._metaInfo.inputs.filter(c)}hasUserEditableProperties(){return r.StudyMetaInfo.isScriptStrategy(this._metaInfo)}hasUserEditableStyles(){const e=this._metaInfo;return e.plots.length>0||void 0!==e.bands||void 0!==e.filledAreas||(0,d.isCustomStudy)(e.shortId)||r.StudyMetaInfo.isScriptStrategy(this._metaInfo)||Object.values(e.graphics).some((e=>void 0!==e))}getUserEditablePlots(){const e=new Set,t=this._metaInfo;return t.plots.filter((o=>{if((0,s.isColorerPlot)(o)||(0,s.isTextColorerPlot)(o)||(0,s.isDataOffsetPlot)(o)||(0,s.isOhlcColorerPlot)(o)||(0,s.isAlertConditionPlot)(o)||(0,s.isDataPlot)(o))return!1;if((0,s.isOhlcPlot)(o)){const n=o.target;if(e.has(n))return!1;e.add(n);const r=(0,i.ensureDefined)(t.ohlcPlots);return!(0,i.ensureDefined)(r[n]).isHidden}{const e=t.styles?t.styles[o.id]:void 0;return void 0===e||!e.isHidden}}))}hasUserEditableOptions(){return this.hasUserEditableInputs()||this.hasUserEditableProperties()||this.hasUserEditableStyles()}getStrategyProperties(){const e=this._metaInfo,t=e.inputs.filter(g),o={...p};for(const i of t){const t=i.internalID;o[t]=i,p.hasOwnProperty(t)||u.logWarn(`Unknown strategy input internal id ${t} in ${e.fullId}`)}return(0,l.clone)(o)}}const p={currency:void 0,backtest_fill_limits_assumption:void 0,calc_on_every_tick:void 0,calc_on_order_fills:void 0,commission_value:void 0,commission_type:void 0,initial_capital:void 0,pyramiding:void 0,slippage:void 0,default_qty_type:void 0,default_qty_value:void 0,margin_long:void 0,margin_short:void 0,use_bar_magnifier:void 0,process_orders_on_close:void 0,fill_orders_on_standard_ohlc:void 0};function g(e){return"strategy_props"===e.groupId}},316144:(e,t,o)=>{var i=o(713709).LineToolTrading,n=o(695698).LineDataSource,r=o(471856).LineToolTradingPriceAxisView,s=o(64278),l=o(262955).DefaultProperty;const a=o(534934),c=o(587060).sourceChangeEvent;var d=o(801515).sortSourcesPreOrdered.LineToolPosition;function u(e){return null==e?e="":e+="",e}class h{constructor(e){this._line=e,this._data={bodyText:"position",quantityText:"0"},this._closeEnabled=!0,this._direction="buy",this._profitState="neutral"}setDirection(e){return this._direction=e,this._line.updateAllViewsAndRedraw(c(this._line.id())),this}setProfitState(e){return this._profitState=e,this._line.updateAllViewsAndRedraw(c(this._line.id())),this}getPrice(){return this._line.points().length>0?this._line.points()[0].price:this._line._timePoint.length>0?this._line._timePoint[0].price:void 0}setPrice(e){if(this._line.points().length>0){var t=this._line.points()[0];t.price=e,this._line.setPoint(0,t),this._line.updateAllViewsAndRedraw(c(this._line.id()))}return this._line._timePoint.length>0&&(this._line._timePoint[0].price=e),this}getText(){return this._data.bodyText}setText(e){return this._data.bodyText=e||"",this._line.updateAllViewsAndRedraw(c(this._line.id())),this}setTooltip(e){
return this._line.properties().tooltip.setValue(u(e)),this}getTooltip(){return this._line.properties().tooltip.value()}setProtectTooltip(e){return this._line.properties().protectTooltip.setValue(u(e)),this}getProtectTooltip(){return this._line.properties().protectTooltip.value()}setCloseTooltip(e){return this._line.properties().closeTooltip.setValue(u(e)),this}getCloseTooltip(){return this._line.properties().closeTooltip.value()}setReverseTooltip(e){return this._line.properties().reverseTooltip.setValue(u(e)),this}getReverseTooltip(){return this._line.properties().reverseTooltip.value()}getQuantity(){return this._data.quantityText}setQuantity(e){return this._data.quantityText=e||"",this._line.updateAllViewsAndRedraw(c(this._line.id())),this}getExtendLeft(){var e=this._line.properties().extendLeft.value();return"inherit"===e?this._line._model.properties().tradingProperties.extendLeft.value():e}setExtendLeft(e){return this._line.properties().extendLeft.setValue(e),this}getLineLength(){var e=this._line.properties().lineLength.value();return"inherit"===e?this._line._model.properties().tradingProperties.lineLength.value():e}getLineLengthUnit(){return this._line.properties().lineLengthUnit.value()}setLineLength(e,t="percentage"){const o=t&&"pixel"===t?e:Math.max(0,Math.min(e,100));return this._line.properties().lineLength.setValue(o),this._line.properties().lineLengthUnit.setValue(t),this}getLineColor(){var e=this._line.properties();return("buy"===this._direction?e.lineBuyColor:e.lineSellColor).value()}setLineColor(e){return"buy"===this._direction?this.setLineBuyColor(e):this.setLineSellColor(e),this}setLineBuyColor(e){return this._line.properties().lineBuyColor.setValue(e),this}setLineSellColor(e){return this._line.properties().lineSellColor.setValue(e),this}getLineStyle(){var e=this._line.properties().lineStyle.value();return"inherit"===e?this._line._model.properties().tradingProperties.lineStyle.value():e}setLineStyle(e){return this._line.properties().lineStyle.setValue(e),this}getLineWidth(){var e=this._line.properties().lineWidth.value();return"inherit"===e?this._line._model.properties().tradingProperties.lineWidth.value():e}setLineWidth(e){return this._line.properties().lineWidth.setValue(e),this}getBodyBorderColor(){var e=this._line.properties();return("buy"===this._direction?e.bodyBorderBuyColor:e.bodyBorderSellColor).value()}setBodyBorderColor(e){return"buy"===this._direction?this.setBodyBorderBuyColor(e):this.setBodyBorderSellColor(e),this}setBodyBorderBuyColor(e){return this._line.properties().bodyBorderBuyColor.setValue(e),this}setBodyBorderSellColor(e){return this._line.properties().bodyBorderSellColor.setValue(e),this}getBodyBackgroundColor(){return s.getColorFromProperties(this._line.properties().bodyBackgroundColor,this._line.properties().bodyBackgroundTransparency)}setBodyBackgroundColor(e){return s.setColorToProperties(e,this._line.properties().bodyBackgroundColor,this._line.properties().bodyBackgroundTransparency),this}getBodyTextColor(){var e=this._line.properties()
;return("positive"===this._profitState?e.bodyTextPositiveColor:"negative"===this._profitState?e.bodyTextNegativeColor:e.bodyTextNeutralColor).value()}setBodyTextColor(e){return"positive"===this._profitState?this.setBodyTextPositiveColor(e):"negative"===this._profitState?this.setBodyTextNegativeColor(e):this.setBodyTextNeutralColor(e),this}setBodyTextPositiveColor(e){return this._line.properties().bodyTextPositiveColor.setValue(e),this}setBodyTextNegativeColor(e){return this._line.properties().bodyTextNegativeColor.setValue(e),this}setBodyTextNeutralColor(e){return this._line.properties().bodyTextNeutralColor.setValue(e),this}getBodyFont(){return s.getFontFromProperties(this._line.properties().bodyFontFamily,this._line.properties().bodyFontSize,this._line.properties().bodyFontBold,this._line.properties().bodyFontItalic)}setBodyFont(e){return s.setFontToProperties(e,this._line.properties().bodyFontFamily,this._line.properties().bodyFontSize,this._line.properties().bodyFontBold,this._line.properties().bodyFontItalic),this}getQuantityBorderColor(){var e=this._line.properties();return("buy"===this._direction?e.quantityBorderBuyColor:e.quantityBorderSellColor).value()}setQuantityBorderColor(e){return"buy"===this._direction?this.setQuantityBorderBuyColor(e):this.setQuantityBorderSellColor(e),this}setQuantityBorderBuyColor(e){return this._line.properties().quantityBorderBuyColor.setValue(e),this}setQuantityBorderSellColor(e){return this._line.properties().quantityBorderSellColor.setValue(e),this}getQuantityBackgroundColor(){var e=this._line.properties();return("buy"===this._direction?e.quantityBackgroundBuyColor:e.quantityBackgroundSellColor).value()}setQuantityBackgroundColor(e){return"buy"===this._direction?this.setQuantityBackgroundBuyColor(e):this.setQuantityBackgroundSellColor(e),this}setQuantityBackgroundBuyColor(e){return this._line.properties().quantityBackgroundBuyColor.setValue(e),this}setQuantityBackgroundSellColor(e){return this._line.properties().quantityBackgroundSellColor.setValue(e),this}getQuantityTextColor(){return s.getColorFromProperties(this._line.properties().quantityTextColor,this._line.properties().quantityTextTransparency)}setQuantityTextColor(e){return s.setColorToProperties(e,this._line.properties().quantityTextColor,this._line.properties().quantityTextTransparency),this}getQuantityFont(){return s.getFontFromProperties(this._line.properties().quantityFontFamily,this._line.properties().quantityFontSize,this._line.properties().quantityFontBold,this._line.properties().quantityFontItalic)}setQuantityFont(e){return s.setFontToProperties(e,this._line.properties().quantityFontFamily,this._line.properties().quantityFontSize,this._line.properties().quantityFontBold,this._line.properties().quantityFontItalic),this}getReverseButtonBorderColor(){var e=this._line.properties();return("buy"===this._direction?e.reverseButtonBorderBuyColor:e.reverseButtonBorderSellColor).value()}setReverseButtonBorderColor(e){
return"buy"===this._direction?this.setReverseButtonBorderBuyColor(e):this.setReverseButtonBorderSellColor(e),this}setReverseButtonBorderBuyColor(e){return this._line.properties().reverseButtonBorderBuyColor.setValue(e),this}setReverseButtonBorderSellColor(e){return this._line.properties().reverseButtonBorderSellColor.setValue(e),this}getReverseButtonBackgroundColor(){return s.getColorFromProperties(this._line.properties().reverseButtonBackgroundColor,this._line.properties().reverseButtonBackgroundTransparency)}setReverseButtonBackgroundColor(e){return s.setColorToProperties(e,this._line.properties().reverseButtonBackgroundColor,this._line.properties().reverseButtonBackgroundTransparency),this}getReverseButtonIconColor(){var e=this._line.properties();return("buy"===this._direction?e.reverseButtonIconBuyColor:e.reverseButtonIconSellColor).value()}setReverseButtonIconColor(e){return"buy"===this._direction?this.setReverseButtonIconBuyColor(e):this.setReverseButtonIconSellColor(e),this}setReverseButtonIconBuyColor(e){return this._line.properties().reverseButtonIconBuyColor.setValue(e),this}setReverseButtonIconSellColor(e){return this._line.properties().reverseButtonIconSellColor.setValue(e),this}getCloseButtonBorderColor(){var e=this._line.properties();return("buy"===this._direction?e.closeButtonBorderBuyColor:e.closeButtonBorderSellColor).value()}setCloseButtonBorderColor(e){return"buy"===this._direction?this.setCloseButtonBorderBuyColor(e):this.setCloseButtonBorderSellColor(e),this}setCloseButtonBorderBuyColor(e){return this._line.properties().closeButtonBorderBuyColor.setValue(e),this}setCloseButtonBorderSellColor(e){return this._line.properties().closeButtonBorderSellColor.setValue(e),this}getCloseButtonBackgroundColor(){return s.getColorFromProperties(this._line.properties().closeButtonBackgroundColor,this._line.properties().closeButtonBackgroundTransparency)}setCloseButtonBackgroundColor(e){return s.setColorToProperties(e,this._line.properties().closeButtonBackgroundColor,this._line.properties().closeButtonBackgroundTransparency),this}getCloseButtonIconColor(){var e=this._line.properties();return("buy"===this._direction?e.closeButtonIconBuyColor:e.closeButtonIconSellColor).value()}setCloseButtonIconColor(e){return"buy"===this._direction?this.setCloseButtonIconBuyColor(e):this.setCloseButtonIconSellColor(e),this}setCloseButtonIconBuyColor(e){return this._line.properties().closeButtonIconBuyColor.setValue(e),this}setCloseButtonIconSellColor(e){return this._line.properties().closeButtonIconSellColor.setValue(e),this}block(){this._blocked=!0,this._line.updateAllViewsAndRedraw(c(this._line.id()))}unblock(){this._blocked=!1,this._line.updateAllViewsAndRedraw(c(this._line.id()))}isFunction(e){return"function"==typeof e}onReverse(e,t){return t?this.isFunction(t)&&(this._onReverseData=e,this._onReverseCallback=t):this.isFunction(e)&&(this._onReverseCallback=e),this}callOnReverse(){this.isFunction(this._onReverseCallback)&&this._onReverseCallback.call(this,this._onReverseData)}isOnReverseCallbackPresent(){
return this.isFunction(this._onReverseCallback)}onClose(e,t){return t?this.isFunction(t)&&(this._onCloseData=e,this._onCloseCallback=t):this.isFunction(e)&&(this._onCloseCallback=e),this}setCloseEnabled(e){return this._closeEnabled===e||(this._closeEnabled=e,this._onCloseCallback&&this._line.updateAllViewsAndRedraw(c(this._line.id()))),this}isCloseEnabled(){return this._closeEnabled}callOnClose(){this.isFunction(this._onCloseCallback)&&this._closeEnabled&&this._onCloseCallback.call(this,this._onCloseData)}isOnCloseCallbackPresent(){return this._closeEnabled&&this.isFunction(this._onCloseCallback)}onModify(e,t){return t?this.isFunction(t)&&(this._onModifyData=e,this._onModifyCallback=t):this.isFunction(e)&&(this._onModifyCallback=e),this}callOnModify(){this.isFunction(this._onModifyCallback)&&this._onModifyCallback.call(this,this._onModifyData)}onContextMenu(e,t){return t?this.isFunction(t)&&(this._onContextMenuData=e,this._onContextMenuCallback=t):this.isFunction(e)&&(this._onContextMenuCallback=e),this}shouldShowContextMenu(){return this.isFunction(this._onContextMenuCallback)}callOnContextMenu(){if(this.isFunction(this._onContextMenuCallback))return this._onContextMenuCallback.call(this,this._onContextMenuData)}remove(){this._line._model.removeSource(this._line),delete this._line}}class p extends i{constructor(e,t){var i=t||p.createProperties(e.backgroundTheme().spawnOwnership());super(e,i),this._adapter=new h(this),Promise.all([o.e(6290),o.e(2735),o.e(789),o.e(1583)]).then(o.t.bind(o,102388,19)).then((({PositionPaneView:e})=>{this._setPaneViews([new e(this,this._model)])}))}adapter(){return this._adapter}zorder(){return d}isSpeciallyZOrderedSource(){return!0}setPoint(e,t){this._points[e]=t,this._normalizePoints()}addPoint(e,t){return this._points.push(e),this._lastPoint=null,this._normalizePoints(),this.createServerPoints(),!0}name(){return"Position"}createPriceAxisView(e){return this._priceAxisView=new r(this,{pointIndex:e,backgroundPropertyGetter:()=>this._adapter.getLineColor()}),this._priceAxisView}paneViews(){return TradingView.printing&&!a.enabled("snapshot_trading_drawings")?null:this._model.properties().tradingProperties.showPositions.value()?n.prototype.paneViews.call(this):null}priceAxisViews(e,t){return TradingView.printing&&!a.enabled("snapshot_trading_drawings")?null:this._model.properties().tradingProperties.showPositions.value()?n.prototype.priceAxisViews.call(this,e,t):null}hasContextMenu(){return this._adapter.shouldShowContextMenu()}contextMenuItems(){return this._adapter.callOnContextMenu()}formatter(){return this._formatter}static createProperties(e,t){var o=new l({defaultName:"linetoolposition",state:t,useUserPreferences:!1,theme:e});return this._configureProperties(o),o}}t.LineToolPosition=p},649008:(e,t,o)=>{function i(e,t,o="promise rejected by time-out"){return new Promise(((i,n)=>{const r=setTimeout((()=>n(o)),t);e.then((e=>{clearTimeout(r),i(e)})),e.catch((e=>{clearTimeout(r),n(e)}))}))}o.d(t,{makeTimeLimited:()=>i})},17076:(e,t,o)=>{o.d(t,{UserFriendlyError:()=>s,getErrorMessage:()=>a,
getLoggerMessage:()=>l,isUserFriendlyError:()=>r});var i=o(609838),n=o(871645);function r(e){return e instanceof s}class s extends Error{constructor({detailedErrorMessage:e,userFriendlyMessage:t,cause:o}){super(t),this.name="UserFriendlyError",this.detailedErrorMessage=e,this.cause=o}}function l(e){return e instanceof s?(0,n.removeTags)(e.detailedErrorMessage):a(e)}function a(e){if(void 0===e)return i.t(null,void 0,o(411768));let t;return t=e instanceof Error?e.message:"object"==typeof e?JSON.stringify(e):e.toString(),(0,n.removeTags)(t)}}}]);